%clear all;
%clc;

function [thdotf ttf tbf vef] = Impact_eqns()

r=0.5; %Radius of Target
w=.2; %Angular velocity of target
tti=[w;0;0;w;0;0]

syms fx0 fy0 tau0 tau1 tau2 tau3 tau4 tau5 tau6  tau11 tau12 tau13 tau14 tau15 tau16

m0=500;m1=10;m2=10;m3=10;m4=10;m11=10; m12=10; m13=10; m14=10;
l0=1;l1=1;l2=1;l3=1;l4=1;l11=1; l12=1; l13=1; l14=1; 
lc0=.5*l0;lc1=.5*l1;lc2=.5*l2;lc3=.5*l3; lc4=.5*l4;lc11=.5*l11;lc12=.5*l12;lc13=.5*l13; lc14=.5*l14; 
Izz0=83.61; Izz1=1.05; Izz2=1.05; Izz3=1.05;Izz4=1.05;Izz11=1.05; Izz12=1.05; Izz13=1.05;Izz14=1.05; 



mt1=10; mt2=10; Itxx1=1;Ityy1=1; Itzz1=1;Itxx2=1;Ityy2=1; Itzz2=1;

rx1=r;ry1=0;rz1=0;
rx2=-r;ry2=0;rz2=0;

%PRE-IMPACT
Ti=0; Tf=30;

TiTf1=Ti:.05:Tf

yy0=[0;0;0; 0.3803; -0.6198; 1.2867; pi/8; pi-0.3803; 0.6198; -1.2867; -pi/8;0;0;0;0;0;0;0;0;0;0;0]; 

%yy0=[0;0;0; 0.698;-1.571; 1.047; 2.444 ;1.571; -1.047;0;0;0;0;0;0;0;0;0];
[T,Y] = ode45(@rigid_1,TiTf1,yy0);

n=length(T)

x0=Y(n,1); y0=Y(n,2); th0=Y(n,3); th1=Y(n,4); th2=Y(n,5); th3=Y(n,6); th4=Y(n,7); th11=Y(n,8); th12=Y(n,9); th13=Y(n,10); th14=Y(n,11);
dx0=Y(n,12); dy0=Y(n,13); dth0=Y(n,14); dth1=Y(n,15); dth2=Y(n,16); dth3=Y(n,17);dth4=Y(n,18); dth11=Y(n,19); dth12=Y(n,20); dth13=Y(n,21); dth14=Y(n,22);

q=[x0;y0;th0;th1;th2;th3;th4; th11; th12; th13; th14];
dq=[dx0; dy0; dth0; dth1; dth2; dth3; dth4; dth11; dth12; dth13; dth14];

thdoti=[dth1; dth2; dth3; dth4; dth11; dth12; dth13; dth14]


%TARGET

%[Mt Jt]= Eqn_matrix_T(rtb,It)
 
Mt =[ Itzz1,     0,   0,   0,   0,   0
     0, mt1,   0,   0,   0,   0
     0,     0, mt1,   0,   0,   0
     0,     0,   0, Itzz2,   0,   0
     0,     0,   0,   0, mt2,   0
     0,     0,   0,   0,   0, mt2];

 
Jt =[    1, 0, 0,    0, 0, 0
  -ry1, 1, 0,    0, 0, 0
 rx1, 0, 1,    0, 0, 0
    0, 0, 0,    1, 0, 0
    0, 0, 0,  -ry2, 1, 0
    0, 0, 0, rx2, 0, 1];
 
%MANIPULATOR


%[JT I F c]= Eqn_matrix_M(x0, y0, th0, th1, th2, th3, th4, th5, th6, dx0, dy0, dth0, dth1, dth2, dth3, dth4, dth5, dth6)

%J=vpa(zeros(1:6,1:11));

M =[                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        m0 + m1 + m11 + m12 + m13 + m14 + m2 + m3 + m4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             lc0*m11*sin(th0) - lc0*m1*sin(th0) + lc0*m12*sin(th0) + lc0*m13*sin(th0) + lc0*m14*sin(th0) - lc0*m2*sin(th0) - lc0*m3*sin(th0) - lc0*m4*sin(th0) - lc14*m14*sin(th0 + th11 + th12 + th13 + th14) - lc4*m4*sin(th0 + th1 + th2 + th3 + th4) - l12*m13*sin(th0 + th11 + th12) - l12*m14*sin(th0 + th11 + th12) - l2*m3*sin(th0 + th1 + th2) - l2*m4*sin(th0 + th1 + th2) - lc12*m12*sin(th0 + th11 + th12) - lc2*m2*sin(th0 + th1 + th2) - l13*m14*sin(th0 + th11 + th12 + th13) - l3*m4*sin(th0 + th1 + th2 + th3) - lc13*m13*sin(th0 + th11 + th12 + th13) - lc3*m3*sin(th0 + th1 + th2 + th3) - l11*m12*sin(th0 + th11) - l11*m13*sin(th0 + th11) - l11*m14*sin(th0 + th11) - l1*m2*sin(th0 + th1) - l1*m3*sin(th0 + th1) - l1*m4*sin(th0 + th1) - lc1*m1*sin(th0 + th1) - lc11*m11*sin(th0 + th11),                                                                                                                                                                                                                                                                                                                                                             - (m4*(2*l3*sin(th0 + th1 + th2 + th3) + 2*l1*sin(th0 + th1) + 2*lc4*sin(th0 + th1 + th2 + th3 + th4) + 2*l2*sin(th0 + th1 + th2)))/2 - (m3*(2*lc3*sin(th0 + th1 + th2 + th3) + 2*l1*sin(th0 + th1) + 2*l2*sin(th0 + th1 + th2)))/2 - (m2*(2*l1*sin(th0 + th1) + 2*lc2*sin(th0 + th1 + th2)))/2 - lc1*m1*sin(th0 + th1),                                                                                                                                                                                                                                                                                                              - (m4*(2*l3*sin(th0 + th1 + th2 + th3) + 2*lc4*sin(th0 + th1 + th2 + th3 + th4) + 2*l2*sin(th0 + th1 + th2)))/2 - (m3*(2*lc3*sin(th0 + th1 + th2 + th3) + 2*l2*sin(th0 + th1 + th2)))/2 - lc2*m2*sin(th0 + th1 + th2),                                                                                                                                                                                                                         - m4*(l3*sin(th0 + th1 + th2 + th3) + lc4*sin(th0 + th1 + th2 + th3 + th4)) - lc3*m3*sin(th0 + th1 + th2 + th3),                                                                                                 -lc4*m4*sin(th0 + th1 + th2 + th3 + th4),                                                                                                                                                                                                                                                                                                                                                                                                                                        - (m14*(2*l13*sin(th0 + th11 + th12 + th13) + 2*l11*sin(th0 + th11) + 2*lc14*sin(th0 + th11 + th12 + th13 + th14) + 2*l12*sin(th0 + th11 + th12)))/2 - (m13*(2*lc13*sin(th0 + th11 + th12 + th13) + 2*l11*sin(th0 + th11) + 2*l12*sin(th0 + th11 + th12)))/2 - (m12*(2*l11*sin(th0 + th11) + 2*lc12*sin(th0 + th11 + th12)))/2 - lc11*m11*sin(th0 + th11),                                                                                                                                                                                                                                                                                                                                                                             - (m14*(2*l13*sin(th0 + th11 + th12 + th13) + 2*lc14*sin(th0 + th11 + th12 + th13 + th14) + 2*l12*sin(th0 + th11 + th12)))/2 - (m13*(2*lc13*sin(th0 + th11 + th12 + th13) + 2*l12*sin(th0 + th11 + th12)))/2 - lc12*m12*sin(th0 + th11 + th12),                                                                                                                                                                                                                                                                   - m14*(l13*sin(th0 + th11 + th12 + th13) + lc14*sin(th0 + th11 + th12 + th13 + th14)) - lc13*m13*sin(th0 + th11 + th12 + th13),                                                                                                                   -lc14*m14*sin(th0 + th11 + th12 + th13 + th14)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        m0 + m1 + m11 + m12 + m13 + m14 + m2 + m3 + m4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             lc0*m1*cos(th0) - lc0*m11*cos(th0) - lc0*m12*cos(th0) - lc0*m13*cos(th0) - lc0*m14*cos(th0) + lc0*m2*cos(th0) + lc0*m3*cos(th0) + lc0*m4*cos(th0) + lc14*m14*cos(th0 + th11 + th12 + th13 + th14) + lc4*m4*cos(th0 + th1 + th2 + th3 + th4) + l12*m13*cos(th0 + th11 + th12) + l12*m14*cos(th0 + th11 + th12) + l2*m3*cos(th0 + th1 + th2) + l2*m4*cos(th0 + th1 + th2) + lc12*m12*cos(th0 + th11 + th12) + lc2*m2*cos(th0 + th1 + th2) + l13*m14*cos(th0 + th11 + th12 + th13) + l3*m4*cos(th0 + th1 + th2 + th3) + lc13*m13*cos(th0 + th11 + th12 + th13) + lc3*m3*cos(th0 + th1 + th2 + th3) + l11*m12*cos(th0 + th11) + l11*m13*cos(th0 + th11) + l11*m14*cos(th0 + th11) + l1*m2*cos(th0 + th1) + l1*m3*cos(th0 + th1) + l1*m4*cos(th0 + th1) + lc1*m1*cos(th0 + th1) + lc11*m11*cos(th0 + th11),                                                                                                                                                                                                                                                                                                                                                               (m2*(2*l1*cos(th0 + th1) + 2*lc2*cos(th0 + th1 + th2)))/2 + (m4*(2*l3*cos(th0 + th1 + th2 + th3) + 2*l1*cos(th0 + th1) + 2*lc4*cos(th0 + th1 + th2 + th3 + th4) + 2*l2*cos(th0 + th1 + th2)))/2 + (m3*(2*lc3*cos(th0 + th1 + th2 + th3) + 2*l1*cos(th0 + th1) + 2*l2*cos(th0 + th1 + th2)))/2 + lc1*m1*cos(th0 + th1),                                                                                                                                                                                                                                                                                                                (m4*(2*l3*cos(th0 + th1 + th2 + th3) + 2*lc4*cos(th0 + th1 + th2 + th3 + th4) + 2*l2*cos(th0 + th1 + th2)))/2 + (m3*(2*lc3*cos(th0 + th1 + th2 + th3) + 2*l2*cos(th0 + th1 + th2)))/2 + lc2*m2*cos(th0 + th1 + th2),                                                                                                                                                                                                                   (m4*(2*l3*cos(th0 + th1 + th2 + th3) + 2*lc4*cos(th0 + th1 + th2 + th3 + th4)))/2 + lc3*m3*cos(th0 + th1 + th2 + th3),                                                                                                  lc4*m4*cos(th0 + th1 + th2 + th3 + th4),                                                                                                                                                                                                                                                                                                                                                                                                                                          (m12*(2*l11*cos(th0 + th11) + 2*lc12*cos(th0 + th11 + th12)))/2 + (m14*(2*l13*cos(th0 + th11 + th12 + th13) + 2*l11*cos(th0 + th11) + 2*lc14*cos(th0 + th11 + th12 + th13 + th14) + 2*l12*cos(th0 + th11 + th12)))/2 + (m13*(2*lc13*cos(th0 + th11 + th12 + th13) + 2*l11*cos(th0 + th11) + 2*l12*cos(th0 + th11 + th12)))/2 + lc11*m11*cos(th0 + th11),                                                                                                                                                                                                                                                                                                                                                                               (m14*(2*l13*cos(th0 + th11 + th12 + th13) + 2*lc14*cos(th0 + th11 + th12 + th13 + th14) + 2*l12*cos(th0 + th11 + th12)))/2 + (m13*(2*lc13*cos(th0 + th11 + th12 + th13) + 2*l12*cos(th0 + th11 + th12)))/2 + lc12*m12*cos(th0 + th11 + th12),                                                                                                                                                                                                                                                             (m14*(2*l13*cos(th0 + th11 + th12 + th13) + 2*lc14*cos(th0 + th11 + th12 + th13 + th14)))/2 + lc13*m13*cos(th0 + th11 + th12 + th13),                                                                                                                    lc14*m14*cos(th0 + th11 + th12 + th13 + th14)
 lc0*m11*sin(th0) - lc0*m1*sin(th0) + lc0*m12*sin(th0) + lc0*m13*sin(th0) + lc0*m14*sin(th0) - lc0*m2*sin(th0) - lc0*m3*sin(th0) - lc0*m4*sin(th0) - lc14*m14*sin(th0 + th11 + th12 + th13 + th14) - lc4*m4*sin(th0 + th1 + th2 + th3 + th4) - l12*m13*sin(th0 + th11 + th12) - l12*m14*sin(th0 + th11 + th12) - l2*m3*sin(th0 + th1 + th2) - l2*m4*sin(th0 + th1 + th2) - lc12*m12*sin(th0 + th11 + th12) - lc2*m2*sin(th0 + th1 + th2) - l13*m14*sin(th0 + th11 + th12 + th13) - l3*m4*sin(th0 + th1 + th2 + th3) - lc13*m13*sin(th0 + th11 + th12 + th13) - lc3*m3*sin(th0 + th1 + th2 + th3) - l11*m12*sin(th0 + th11) - l11*m13*sin(th0 + th11) - l11*m14*sin(th0 + th11) - l1*m2*sin(th0 + th1) - l1*m3*sin(th0 + th1) - l1*m4*sin(th0 + th1) - lc1*m1*sin(th0 + th1) - lc11*m11*sin(th0 + th11), lc0*m1*cos(th0) - lc0*m11*cos(th0) - lc0*m12*cos(th0) - lc0*m13*cos(th0) - lc0*m14*cos(th0) + lc0*m2*cos(th0) + lc0*m3*cos(th0) + lc0*m4*cos(th0) + lc14*m14*cos(th0 + th11 + th12 + th13 + th14) + lc4*m4*cos(th0 + th1 + th2 + th3 + th4) + l12*m13*cos(th0 + th11 + th12) + l12*m14*cos(th0 + th11 + th12) + l2*m3*cos(th0 + th1 + th2) + l2*m4*cos(th0 + th1 + th2) + lc12*m12*cos(th0 + th11 + th12) + lc2*m2*cos(th0 + th1 + th2) + l13*m14*cos(th0 + th11 + th12 + th13) + l3*m4*cos(th0 + th1 + th2 + th3) + lc13*m13*cos(th0 + th11 + th12 + th13) + lc3*m3*cos(th0 + th1 + th2 + th3) + l11*m12*cos(th0 + th11) + l11*m13*cos(th0 + th11) + l11*m14*cos(th0 + th11) + l1*m2*cos(th0 + th1) + l1*m3*cos(th0 + th1) + l1*m4*cos(th0 + th1) + lc1*m1*cos(th0 + th1) + lc11*m11*cos(th0 + th11), Izz0 + Izz1 + Izz2 + Izz3 + Izz4 + Izz11 + Izz12 + Izz13 + Izz14 + l11^2*m12 + l11^2*m13 + l11^2*m14 + l12^2*m13 + l12^2*m14 + l13^2*m14 + l1^2*m2 + l1^2*m3 + l1^2*m4 + l2^2*m3 + l2^2*m4 + l3^2*m4 + lc0^2*m1 + lc1^2*m1 + lc0^2*m11 + lc0^2*m12 + lc11^2*m11 + lc0^2*m13 + lc12^2*m12 + lc0^2*m14 + lc13^2*m13 + lc14^2*m14 + lc0^2*m2 + lc2^2*m2 + lc0^2*m3 + lc3^2*m3 + lc0^2*m4 + lc4^2*m4 - 2*lc0*lc14*m14*cos(th11 + th12 + th13 + th14) + 2*lc0*lc4*m4*cos(th1 + th2 + th3 + th4) + 2*l11*l13*m14*cos(th12 + th13) + 2*l1*l3*m4*cos(th2 + th3) - 2*l12*lc0*m13*cos(th11 + th12) + 2*l11*lc13*m13*cos(th12 + th13) - 2*l12*lc0*m14*cos(th11 + th12) + 2*l12*lc14*m14*cos(th13 + th14) + 2*l1*lc3*m3*cos(th2 + th3) + 2*l2*lc0*m3*cos(th1 + th2) + 2*l2*lc0*m4*cos(th1 + th2) + 2*l2*lc4*m4*cos(th3 + th4) - 2*lc0*lc12*m12*cos(th11 + th12) + 2*lc0*lc2*m2*cos(th1 + th2) + 2*l11*l12*m13*cos(th12) + 2*l11*l12*m14*cos(th12) + 2*l12*l13*m14*cos(th13) + 2*l1*l2*m3*cos(th2) + 2*l1*l2*m4*cos(th2) + 2*l2*l3*m4*cos(th3) - 2*l11*lc0*m12*cos(th11) - 2*l11*lc0*m13*cos(th11) + 2*l11*lc12*m12*cos(th12) - 2*l11*lc0*m14*cos(th11) + 2*l12*lc13*m13*cos(th13) + 2*l13*lc14*m14*cos(th14) + 2*l1*lc0*m2*cos(th1) + 2*l1*lc2*m2*cos(th2) + 2*l1*lc0*m3*cos(th1) + 2*l1*lc0*m4*cos(th1) + 2*l2*lc3*m3*cos(th3) + 2*l3*lc4*m4*cos(th4) + 2*lc0*lc1*m1*cos(th1) - 2*lc0*lc11*m11*cos(th11) + 2*l11*lc14*m14*cos(th12 + th13 + th14) - 2*l13*lc0*m14*cos(th11 + th12 + th13) + 2*l1*lc4*m4*cos(th2 + th3 + th4) + 2*l3*lc0*m4*cos(th1 + th2 + th3) - 2*lc0*lc13*m13*cos(th11 + th12 + th13) + 2*lc0*lc3*m3*cos(th1 + th2 + th3), Izz1 + Izz2 + Izz3 + Izz4 + l1^2*m2 + l1^2*m3 + l1^2*m4 + l2^2*m3 + l2^2*m4 + l3^2*m4 + lc1^2*m1 + lc2^2*m2 + lc3^2*m3 + lc4^2*m4 + lc0*lc4*m4*cos(th1 + th2 + th3 + th4) + 2*l1*l3*m4*cos(th2 + th3) + 2*l1*lc3*m3*cos(th2 + th3) + l2*lc0*m3*cos(th1 + th2) + l2*lc0*m4*cos(th1 + th2) + 2*l2*lc4*m4*cos(th3 + th4) + lc0*lc2*m2*cos(th1 + th2) + 2*l1*l2*m3*cos(th2) + 2*l1*l2*m4*cos(th2) + 2*l2*l3*m4*cos(th3) + l1*lc0*m2*cos(th1) + 2*l1*lc2*m2*cos(th2) + l1*lc0*m3*cos(th1) + l1*lc0*m4*cos(th1) + 2*l2*lc3*m3*cos(th3) + 2*l3*lc4*m4*cos(th4) + lc0*lc1*m1*cos(th1) + 2*l1*lc4*m4*cos(th2 + th3 + th4) + l3*lc0*m4*cos(th1 + th2 + th3) + lc0*lc3*m3*cos(th1 + th2 + th3), Izz2 + Izz3 + Izz4 + l2^2*m3 + l2^2*m4 + l3^2*m4 + lc2^2*m2 + lc3^2*m3 + lc4^2*m4 + lc0*lc4*m4*cos(th1 + th2 + th3 + th4) + l1*l3*m4*cos(th2 + th3) + l1*lc3*m3*cos(th2 + th3) + l2*lc0*m3*cos(th1 + th2) + l2*lc0*m4*cos(th1 + th2) + 2*l2*lc4*m4*cos(th3 + th4) + lc0*lc2*m2*cos(th1 + th2) + l1*l2*m3*cos(th2) + l1*l2*m4*cos(th2) + 2*l2*l3*m4*cos(th3) + l1*lc2*m2*cos(th2) + 2*l2*lc3*m3*cos(th3) + 2*l3*lc4*m4*cos(th4) + l1*lc4*m4*cos(th2 + th3 + th4) + l3*lc0*m4*cos(th1 + th2 + th3) + lc0*lc3*m3*cos(th1 + th2 + th3), Izz3 + Izz4 + l3^2*m4 + lc3^2*m3 + lc4^2*m4 + lc0*lc4*m4*cos(th1 + th2 + th3 + th4) + l1*l3*m4*cos(th2 + th3) + l1*lc3*m3*cos(th2 + th3) + l2*lc4*m4*cos(th3 + th4) + l2*l3*m4*cos(th3) + l2*lc3*m3*cos(th3) + 2*l3*lc4*m4*cos(th4) + l1*lc4*m4*cos(th2 + th3 + th4) + l3*lc0*m4*cos(th1 + th2 + th3) + lc0*lc3*m3*cos(th1 + th2 + th3), Izz4 + lc4^2*m4 + lc0*lc4*m4*cos(th1 + th2 + th3 + th4) + l2*lc4*m4*cos(th3 + th4) + l3*lc4*m4*cos(th4) + l1*lc4*m4*cos(th2 + th3 + th4), Izz11 + Izz12 + Izz13 + Izz14 + l11^2*m12 + l11^2*m13 + l11^2*m14 + l12^2*m13 + l12^2*m14 + l13^2*m14 + lc11^2*m11 + lc12^2*m12 + lc13^2*m13 + lc14^2*m14 - lc0*lc14*m14*cos(th11 + th12 + th13 + th14) + 2*l11*l13*m14*cos(th12 + th13) - l12*lc0*m13*cos(th11 + th12) + 2*l11*lc13*m13*cos(th12 + th13) - l12*lc0*m14*cos(th11 + th12) + 2*l12*lc14*m14*cos(th13 + th14) - lc0*lc12*m12*cos(th11 + th12) + 2*l11*l12*m13*cos(th12) + 2*l11*l12*m14*cos(th12) + 2*l12*l13*m14*cos(th13) - l11*lc0*m12*cos(th11) - l11*lc0*m13*cos(th11) + 2*l11*lc12*m12*cos(th12) - l11*lc0*m14*cos(th11) + 2*l12*lc13*m13*cos(th13) + 2*l13*lc14*m14*cos(th14) - lc0*lc11*m11*cos(th11) + 2*l11*lc14*m14*cos(th12 + th13 + th14) - l13*lc0*m14*cos(th11 + th12 + th13) - lc0*lc13*m13*cos(th11 + th12 + th13), Izz12 + Izz13 + Izz14 + l12^2*m13 + l12^2*m14 + l13^2*m14 + lc12^2*m12 + lc13^2*m13 + lc14^2*m14 - lc0*lc14*m14*cos(th11 + th12 + th13 + th14) + l11*l13*m14*cos(th12 + th13) - l12*lc0*m13*cos(th11 + th12) + l11*lc13*m13*cos(th12 + th13) - l12*lc0*m14*cos(th11 + th12) + 2*l12*lc14*m14*cos(th13 + th14) - lc0*lc12*m12*cos(th11 + th12) + l11*l12*m13*cos(th12) + l11*l12*m14*cos(th12) + 2*l12*l13*m14*cos(th13) + l11*lc12*m12*cos(th12) + 2*l12*lc13*m13*cos(th13) + 2*l13*lc14*m14*cos(th14) + l11*lc14*m14*cos(th12 + th13 + th14) - l13*lc0*m14*cos(th11 + th12 + th13) - lc0*lc13*m13*cos(th11 + th12 + th13), Izz13 + Izz14 + l13^2*m14 + lc13^2*m13 + lc14^2*m14 - lc0*lc14*m14*cos(th11 + th12 + th13 + th14) + l11*l13*m14*cos(th12 + th13) + l11*lc13*m13*cos(th12 + th13) + l12*lc14*m14*cos(th13 + th14) + l12*l13*m14*cos(th13) + l12*lc13*m13*cos(th13) + 2*l13*lc14*m14*cos(th14) + l11*lc14*m14*cos(th12 + th13 + th14) - l13*lc0*m14*cos(th11 + th12 + th13) - lc0*lc13*m13*cos(th11 + th12 + th13), Izz14 + lc14^2*m14 - lc0*lc14*m14*cos(th11 + th12 + th13 + th14) + l12*lc14*m14*cos(th13 + th14) + l13*lc14*m14*cos(th14) + l11*lc14*m14*cos(th12 + th13 + th14)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             - m4*(l3*sin(th0 + th1 + th2 + th3) + l1*sin(th0 + th1) + lc4*sin(th0 + th1 + th2 + th3 + th4) + l2*sin(th0 + th1 + th2)) - m3*(lc3*sin(th0 + th1 + th2 + th3) + l1*sin(th0 + th1) + l2*sin(th0 + th1 + th2)) - m2*(l1*sin(th0 + th1) + lc2*sin(th0 + th1 + th2)) - lc1*m1*sin(th0 + th1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               m2*(l1*cos(th0 + th1) + lc2*cos(th0 + th1 + th2)) + m4*(l3*cos(th0 + th1 + th2 + th3) + l1*cos(th0 + th1) + lc4*cos(th0 + th1 + th2 + th3 + th4) + l2*cos(th0 + th1 + th2)) + m3*(lc3*cos(th0 + th1 + th2 + th3) + l1*cos(th0 + th1) + l2*cos(th0 + th1 + th2)) + lc1*m1*cos(th0 + th1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Izz1 + Izz2 + Izz3 + Izz4 + l1^2*m2 + l1^2*m3 + l1^2*m4 + l2^2*m3 + l2^2*m4 + l3^2*m4 + lc1^2*m1 + lc2^2*m2 + lc3^2*m3 + lc4^2*m4 + lc0*lc4*m4*cos(th1 + th2 + th3 + th4) + 2*l1*l3*m4*cos(th2 + th3) + 2*l1*lc3*m3*cos(th2 + th3) + l2*lc0*m3*cos(th1 + th2) + l2*lc0*m4*cos(th1 + th2) + 2*l2*lc4*m4*cos(th3 + th4) + lc0*lc2*m2*cos(th1 + th2) + 2*l1*l2*m3*cos(th2) + 2*l1*l2*m4*cos(th2) + 2*l2*l3*m4*cos(th3) + l1*lc0*m2*cos(th1) + 2*l1*lc2*m2*cos(th2) + l1*lc0*m3*cos(th1) + l1*lc0*m4*cos(th1) + 2*l2*lc3*m3*cos(th3) + 2*l3*lc4*m4*cos(th4) + lc0*lc1*m1*cos(th1) + 2*l1*lc4*m4*cos(th2 + th3 + th4) + l3*lc0*m4*cos(th1 + th2 + th3) + lc0*lc3*m3*cos(th1 + th2 + th3),                                                                                                                                                                                                                                                                                   Izz1 + Izz2 + Izz3 + Izz4 + l1^2*m2 + l1^2*m3 + l1^2*m4 + l2^2*m3 + l2^2*m4 + l3^2*m4 + lc1^2*m1 + lc2^2*m2 + lc3^2*m3 + lc4^2*m4 + 2*l1*l3*m4*cos(th2 + th3) + 2*l1*lc3*m3*cos(th2 + th3) + 2*l2*lc4*m4*cos(th3 + th4) + 2*l1*l2*m3*cos(th2) + 2*l1*l2*m4*cos(th2) + 2*l2*l3*m4*cos(th3) + 2*l1*lc2*m2*cos(th2) + 2*l2*lc3*m3*cos(th3) + 2*l3*lc4*m4*cos(th4) + 2*l1*lc4*m4*cos(th2 + th3 + th4),                                                                                                                                                                                              Izz2 + Izz3 + Izz4 + l2^2*m3 + l2^2*m4 + l3^2*m4 + lc2^2*m2 + lc3^2*m3 + lc4^2*m4 + l1*l3*m4*cos(th2 + th3) + l1*lc3*m3*cos(th2 + th3) + 2*l2*lc4*m4*cos(th3 + th4) + l1*l2*m3*cos(th2) + l1*l2*m4*cos(th2) + 2*l2*l3*m4*cos(th3) + l1*lc2*m2*cos(th2) + 2*l2*lc3*m3*cos(th3) + 2*l3*lc4*m4*cos(th4) + l1*lc4*m4*cos(th2 + th3 + th4),                                                                                                            Izz3 + Izz4 + l3^2*m4 + lc3^2*m3 + lc4^2*m4 + l1*l3*m4*cos(th2 + th3) + l1*lc3*m3*cos(th2 + th3) + l2*lc4*m4*cos(th3 + th4) + l2*l3*m4*cos(th3) + l2*lc3*m3*cos(th3) + 2*l3*lc4*m4*cos(th4) + l1*lc4*m4*cos(th2 + th3 + th4),                                         Izz4 + lc4^2*m4 + l2*lc4*m4*cos(th3 + th4) + l3*lc4*m4*cos(th4) + l1*lc4*m4*cos(th2 + th3 + th4),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                                                                0,                                                                                                                                                                0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   - m4*(l3*sin(th0 + th1 + th2 + th3) + lc4*sin(th0 + th1 + th2 + th3 + th4) + l2*sin(th0 + th1 + th2)) - m3*(lc3*sin(th0 + th1 + th2 + th3) + l2*sin(th0 + th1 + th2)) - lc2*m2*sin(th0 + th1 + th2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     m4*(l3*cos(th0 + th1 + th2 + th3) + lc4*cos(th0 + th1 + th2 + th3 + th4) + l2*cos(th0 + th1 + th2)) + m3*(lc3*cos(th0 + th1 + th2 + th3) + l2*cos(th0 + th1 + th2)) + lc2*m2*cos(th0 + th1 + th2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Izz2 + Izz3 + Izz4 + l2^2*m3 + l2^2*m4 + l3^2*m4 + lc2^2*m2 + lc3^2*m3 + lc4^2*m4 + lc0*lc4*m4*cos(th1 + th2 + th3 + th4) + l1*l3*m4*cos(th2 + th3) + l1*lc3*m3*cos(th2 + th3) + l2*lc0*m3*cos(th1 + th2) + l2*lc0*m4*cos(th1 + th2) + 2*l2*lc4*m4*cos(th3 + th4) + lc0*lc2*m2*cos(th1 + th2) + l1*l2*m3*cos(th2) + l1*l2*m4*cos(th2) + 2*l2*l3*m4*cos(th3) + l1*lc2*m2*cos(th2) + 2*l2*lc3*m3*cos(th3) + 2*l3*lc4*m4*cos(th4) + l1*lc4*m4*cos(th2 + th3 + th4) + l3*lc0*m4*cos(th1 + th2 + th3) + lc0*lc3*m3*cos(th1 + th2 + th3),                                                                                                                                                                                                                                                                                                                                               Izz2 + Izz3 + Izz4 + l2^2*m3 + l2^2*m4 + l3^2*m4 + lc2^2*m2 + lc3^2*m3 + lc4^2*m4 + l1*l3*m4*cos(th2 + th3) + l1*lc3*m3*cos(th2 + th3) + 2*l2*lc4*m4*cos(th3 + th4) + l1*l2*m3*cos(th2) + l1*l2*m4*cos(th2) + 2*l2*l3*m4*cos(th3) + l1*lc2*m2*cos(th2) + 2*l2*lc3*m3*cos(th3) + 2*l3*lc4*m4*cos(th4) + l1*lc4*m4*cos(th2 + th3 + th4),                                                                                                                                                                                                                                                                                                                                                 Izz2 + Izz3 + Izz4 + l2^2*m3 + l2^2*m4 + l3^2*m4 + lc2^2*m2 + lc3^2*m3 + lc4^2*m4 + 2*l2*lc4*m4*cos(th3 + th4) + 2*l2*l3*m4*cos(th3) + 2*l2*lc3*m3*cos(th3) + 2*l3*lc4*m4*cos(th4),                                                                                                                                                                                                  m4*l3^2 + 2*m4*cos(th4)*l3*lc4 + l2*m4*cos(th3)*l3 + m3*lc3^2 + l2*m3*cos(th3)*lc3 + m4*lc4^2 + l2*m4*cos(th3 + th4)*lc4 + Izz3 + Izz4,                                                                          Izz4 + lc4^2*m4 + l2*lc4*m4*cos(th3 + th4) + l3*lc4*m4*cos(th4),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                                                                0,                                                                                                                                                                0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       - m4*(l3*sin(th0 + th1 + th2 + th3) + lc4*sin(th0 + th1 + th2 + th3 + th4)) - lc3*m3*sin(th0 + th1 + th2 + th3),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         m4*(l3*cos(th0 + th1 + th2 + th3) + lc4*cos(th0 + th1 + th2 + th3 + th4)) + lc3*m3*cos(th0 + th1 + th2 + th3),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Izz3 + Izz4 + l3^2*m4 + lc3^2*m3 + lc4^2*m4 + lc0*lc4*m4*cos(th1 + th2 + th3 + th4) + l1*l3*m4*cos(th2 + th3) + l1*lc3*m3*cos(th2 + th3) + l2*lc4*m4*cos(th3 + th4) + l2*l3*m4*cos(th3) + l2*lc3*m3*cos(th3) + 2*l3*lc4*m4*cos(th4) + l1*lc4*m4*cos(th2 + th3 + th4) + l3*lc0*m4*cos(th1 + th2 + th3) + lc0*lc3*m3*cos(th1 + th2 + th3),                                                                                                                                                                                                                                                                                                                                                                                                                                                        Izz3 + Izz4 + l3^2*m4 + lc3^2*m3 + lc4^2*m4 + l1*l3*m4*cos(th2 + th3) + l1*lc3*m3*cos(th2 + th3) + l2*lc4*m4*cos(th3 + th4) + l2*l3*m4*cos(th3) + l2*lc3*m3*cos(th3) + 2*l3*lc4*m4*cos(th4) + l1*lc4*m4*cos(th2 + th3 + th4),                                                                                                                                                                                                                                                                                                                                                                                             m4*l3^2 + 2*m4*cos(th4)*l3*lc4 + l2*m4*cos(th3)*l3 + m3*lc3^2 + l2*m3*cos(th3)*lc3 + m4*lc4^2 + l2*m4*cos(th3 + th4)*lc4 + Izz3 + Izz4,                                                                                                                                                                                                                                                                      m4*l3^2 + 2*m4*cos(th4)*l3*lc4 + m3*lc3^2 + m4*lc4^2 + Izz3 + Izz4,                                                                                                     m4*lc4^2 + l3*m4*cos(th4)*lc4 + Izz4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                                                                0,                                                                                                                                                                0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              -lc4*m4*sin(th0 + th1 + th2 + th3 + th4),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               lc4*m4*cos(th0 + th1 + th2 + th3 + th4),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          Izz4 + lc4^2*m4 + lc0*lc4*m4*cos(th1 + th2 + th3 + th4) + l2*lc4*m4*cos(th3 + th4) + l3*lc4*m4*cos(th4) + l1*lc4*m4*cos(th2 + th3 + th4),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Izz4 + lc4^2*m4 + l2*lc4*m4*cos(th3 + th4) + l3*lc4*m4*cos(th4) + l1*lc4*m4*cos(th2 + th3 + th4),                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Izz4 + lc4^2*m4 + l2*lc4*m4*cos(th3 + th4) + l3*lc4*m4*cos(th4),                                                                                                                                                                                                                                                                                                    m4*lc4^2 + l3*m4*cos(th4)*lc4 + Izz4,                                                                                                                          m4*lc4^2 + Izz4,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          0,                                                                                                                                                                                                                                                                                                                                                                                                0,                                                                                                                                                                0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                           - m14*(l13*sin(th0 + th11 + th12 + th13) + l11*sin(th0 + th11) + lc14*sin(th0 + th11 + th12 + th13 + th14) + l12*sin(th0 + th11 + th12)) - m13*(lc13*sin(th0 + th11 + th12 + th13) + l11*sin(th0 + th11) + l12*sin(th0 + th11 + th12)) - m12*(l11*sin(th0 + th11) + lc12*sin(th0 + th11 + th12)) - lc11*m11*sin(th0 + th11),                                                                                                                                                                                                                                                                                                                                                                                                                                                                             m12*(l11*cos(th0 + th11) + lc12*cos(th0 + th11 + th12)) + m14*(l13*cos(th0 + th11 + th12 + th13) + l11*cos(th0 + th11) + lc14*cos(th0 + th11 + th12 + th13 + th14) + l12*cos(th0 + th11 + th12)) + m13*(lc13*cos(th0 + th11 + th12 + th13) + l11*cos(th0 + th11) + l12*cos(th0 + th11 + th12)) + lc11*m11*cos(th0 + th11),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Izz11 + Izz12 + Izz13 + Izz14 + l11^2*m12 + l11^2*m13 + l11^2*m14 + l12^2*m13 + l12^2*m14 + l13^2*m14 + lc11^2*m11 + lc12^2*m12 + lc13^2*m13 + lc14^2*m14 - lc0*lc14*m14*cos(th11 + th12 + th13 + th14) + 2*l11*l13*m14*cos(th12 + th13) - l12*lc0*m13*cos(th11 + th12) + 2*l11*lc13*m13*cos(th12 + th13) - l12*lc0*m14*cos(th11 + th12) + 2*l12*lc14*m14*cos(th13 + th14) - lc0*lc12*m12*cos(th11 + th12) + 2*l11*l12*m13*cos(th12) + 2*l11*l12*m14*cos(th12) + 2*l12*l13*m14*cos(th13) - l11*lc0*m12*cos(th11) - l11*lc0*m13*cos(th11) + 2*l11*lc12*m12*cos(th12) - l11*lc0*m14*cos(th11) + 2*l12*lc13*m13*cos(th13) + 2*l13*lc14*m14*cos(th14) - lc0*lc11*m11*cos(th11) + 2*l11*lc14*m14*cos(th12 + th13 + th14) - l13*lc0*m14*cos(th11 + th12 + th13) - lc0*lc13*m13*cos(th11 + th12 + th13),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                       0,                                                                                                                                        0,                                                                                                                                                                                                                                                                                                                           Izz11 + Izz12 + Izz13 + Izz14 + l11^2*m12 + l11^2*m13 + l11^2*m14 + l12^2*m13 + l12^2*m14 + l13^2*m14 + lc11^2*m11 + lc12^2*m12 + lc13^2*m13 + lc14^2*m14 + 2*l11*l13*m14*cos(th12 + th13) + 2*l11*lc13*m13*cos(th12 + th13) + 2*l12*lc14*m14*cos(th13 + th14) + 2*l11*l12*m13*cos(th12) + 2*l11*l12*m14*cos(th12) + 2*l12*l13*m14*cos(th13) + 2*l11*lc12*m12*cos(th12) + 2*l12*lc13*m13*cos(th13) + 2*l13*lc14*m14*cos(th14) + 2*l11*lc14*m14*cos(th12 + th13 + th14),                                                                                                                                                                                                                          Izz12 + Izz13 + Izz14 + l12^2*m13 + l12^2*m14 + l13^2*m14 + lc12^2*m12 + lc13^2*m13 + lc14^2*m14 + l11*l13*m14*cos(th12 + th13) + l11*lc13*m13*cos(th12 + th13) + 2*l12*lc14*m14*cos(th13 + th14) + l11*l12*m13*cos(th12) + l11*l12*m14*cos(th12) + 2*l12*l13*m14*cos(th13) + l11*lc12*m12*cos(th12) + 2*l12*lc13*m13*cos(th13) + 2*l13*lc14*m14*cos(th14) + l11*lc14*m14*cos(th12 + th13 + th14),                                                                                                                            Izz13 + Izz14 + l13^2*m14 + lc13^2*m13 + lc14^2*m14 + l11*l13*m14*cos(th12 + th13) + l11*lc13*m13*cos(th12 + th13) + l12*lc14*m14*cos(th13 + th14) + l12*l13*m14*cos(th13) + l12*lc13*m13*cos(th13) + 2*l13*lc14*m14*cos(th14) + l11*lc14*m14*cos(th12 + th13 + th14),                                               Izz14 + lc14^2*m14 + l12*lc14*m14*cos(th13 + th14) + l13*lc14*m14*cos(th14) + l11*lc14*m14*cos(th12 + th13 + th14)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          - m14*(l13*sin(th0 + th11 + th12 + th13) + lc14*sin(th0 + th11 + th12 + th13 + th14) + l12*sin(th0 + th11 + th12)) - m13*(lc13*sin(th0 + th11 + th12 + th13) + l12*sin(th0 + th11 + th12)) - lc12*m12*sin(th0 + th11 + th12),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            m14*(l13*cos(th0 + th11 + th12 + th13) + lc14*cos(th0 + th11 + th12 + th13 + th14) + l12*cos(th0 + th11 + th12)) + m13*(lc13*cos(th0 + th11 + th12 + th13) + l12*cos(th0 + th11 + th12)) + lc12*m12*cos(th0 + th11 + th12),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        Izz12 + Izz13 + Izz14 + l12^2*m13 + l12^2*m14 + l13^2*m14 + lc12^2*m12 + lc13^2*m13 + lc14^2*m14 - lc0*lc14*m14*cos(th11 + th12 + th13 + th14) + l11*l13*m14*cos(th12 + th13) - l12*lc0*m13*cos(th11 + th12) + l11*lc13*m13*cos(th12 + th13) - l12*lc0*m14*cos(th11 + th12) + 2*l12*lc14*m14*cos(th13 + th14) - lc0*lc12*m12*cos(th11 + th12) + l11*l12*m13*cos(th12) + l11*l12*m14*cos(th12) + 2*l12*l13*m14*cos(th13) + l11*lc12*m12*cos(th12) + 2*l12*lc13*m13*cos(th13) + 2*l13*lc14*m14*cos(th14) + l11*lc14*m14*cos(th12 + th13 + th14) - l13*lc0*m14*cos(th11 + th12 + th13) - lc0*lc13*m13*cos(th11 + th12 + th13),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                       0,                                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                                                Izz12 + Izz13 + Izz14 + l12^2*m13 + l12^2*m14 + l13^2*m14 + lc12^2*m12 + lc13^2*m13 + lc14^2*m14 + l11*l13*m14*cos(th12 + th13) + l11*lc13*m13*cos(th12 + th13) + 2*l12*lc14*m14*cos(th13 + th14) + l11*l12*m13*cos(th12) + l11*l12*m14*cos(th12) + 2*l12*l13*m14*cos(th13) + l11*lc12*m12*cos(th12) + 2*l12*lc13*m13*cos(th13) + 2*l13*lc14*m14*cos(th14) + l11*lc14*m14*cos(th12 + th13 + th14),                                                                                                                                                                                                                                                                                                                                                                                                         Izz12 + Izz13 + Izz14 + l12^2*m13 + l12^2*m14 + l13^2*m14 + lc12^2*m12 + lc13^2*m13 + lc14^2*m14 + 2*l12*lc14*m14*cos(th13 + th14) + 2*l12*l13*m14*cos(th13) + 2*l12*lc13*m13*cos(th13) + 2*l13*lc14*m14*cos(th14),                                                                                                                                                                                                                                  m14*l13^2 + 2*m14*cos(th14)*l13*lc14 + l12*m14*cos(th13)*l13 + m13*lc13^2 + l12*m13*cos(th13)*lc13 + m14*lc14^2 + l12*m14*cos(th13 + th14)*lc14 + Izz13 + Izz14,                                                                                      Izz14 + lc14^2*m14 + l12*lc14*m14*cos(th13 + th14) + l13*lc14*m14*cos(th14)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        - m14*(l13*sin(th0 + th11 + th12 + th13) + lc14*sin(th0 + th11 + th12 + th13 + th14)) - lc13*m13*sin(th0 + th11 + th12 + th13),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          m14*(l13*cos(th0 + th11 + th12 + th13) + lc14*cos(th0 + th11 + th12 + th13 + th14)) + lc13*m13*cos(th0 + th11 + th12 + th13),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Izz13 + Izz14 + l13^2*m14 + lc13^2*m13 + lc14^2*m14 - lc0*lc14*m14*cos(th11 + th12 + th13 + th14) + l11*l13*m14*cos(th12 + th13) + l11*lc13*m13*cos(th12 + th13) + l12*lc14*m14*cos(th13 + th14) + l12*l13*m14*cos(th13) + l12*lc13*m13*cos(th13) + 2*l13*lc14*m14*cos(th14) + l11*lc14*m14*cos(th12 + th13 + th14) - l13*lc0*m14*cos(th11 + th12 + th13) - lc0*lc13*m13*cos(th11 + th12 + th13),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                       0,                                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            Izz13 + Izz14 + l13^2*m14 + lc13^2*m13 + lc14^2*m14 + l11*l13*m14*cos(th12 + th13) + l11*lc13*m13*cos(th12 + th13) + l12*lc14*m14*cos(th13 + th14) + l12*l13*m14*cos(th13) + l12*lc13*m13*cos(th13) + 2*l13*lc14*m14*cos(th14) + l11*lc14*m14*cos(th12 + th13 + th14),                                                                                                                                                                                                                                                                                                                                                                                                                                                            m14*l13^2 + 2*m14*cos(th14)*l13*lc14 + l12*m14*cos(th13)*l13 + m13*lc13^2 + l12*m13*cos(th13)*lc13 + m14*lc14^2 + l12*m14*cos(th13 + th14)*lc14 + Izz13 + Izz14,                                                                                                                                                                                                                                                                                                                   m14*l13^2 + 2*m14*cos(th14)*l13*lc14 + m13*lc13^2 + m14*lc14^2 + Izz13 + Izz14,                                                                                                                      m14*lc14^2 + l13*m14*cos(th14)*lc14 + Izz14
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        -lc14*m14*sin(th0 + th11 + th12 + th13 + th14),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         lc14*m14*cos(th0 + th11 + th12 + th13 + th14),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  Izz14 + lc14^2*m14 - lc0*lc14*m14*cos(th11 + th12 + th13 + th14) + l12*lc14*m14*cos(th13 + th14) + l13*lc14*m14*cos(th14) + l11*lc14*m14*cos(th12 + th13 + th14),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                       0,                                                                                                                                        0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Izz14 + lc14^2*m14 + l12*lc14*m14*cos(th13 + th14) + l13*lc14*m14*cos(th14) + l11*lc14*m14*cos(th12 + th13 + th14),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                Izz14 + lc14^2*m14 + l12*lc14*m14*cos(th13 + th14) + l13*lc14*m14*cos(th14),                                                                                                                                                                                                                                                                                                                                                      m14*lc14^2 + l13*m14*cos(th14)*lc14 + Izz14,                                                                                                                                               m14*lc14^2 + Izz14]
 
Ib=M(1:3,1:3);
Ibm=M(1:3,4:11);
Im=M(4:11,4:11);

C =[                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              dth0^2*lc0*m11*cos(th0) - dth11^2*lc14*m14*cos(th0 + th11 + th12 + th13 + th14) - dth12^2*lc14*m14*cos(th0 + th11 + th12 + th13 + th14) - dth13^2*lc14*m14*cos(th0 + th11 + th12 + th13 + th14) - dth14^2*lc14*m14*cos(th0 + th11 + th12 + th13 + th14) - dth0^2*lc4*m4*cos(th0 + th1 + th2 + th3 + th4) - dth1^2*lc4*m4*cos(th0 + th1 + th2 + th3 + th4) - dth2^2*lc4*m4*cos(th0 + th1 + th2 + th3 + th4) - dth3^2*lc4*m4*cos(th0 + th1 + th2 + th3 + th4) - dth4^2*lc4*m4*cos(th0 + th1 + th2 + th3 + th4) - dth0^2*l12*m13*cos(th0 + th11 + th12) - dth11^2*l12*m13*cos(th0 + th11 + th12) - dth12^2*l12*m13*cos(th0 + th11 + th12) - dth0^2*l12*m14*cos(th0 + th11 + th12) - dth11^2*l12*m14*cos(th0 + th11 + th12) - dth12^2*l12*m14*cos(th0 + th11 + th12) - dth0^2*l2*m3*cos(th0 + th1 + th2) - dth1^2*l2*m3*cos(th0 + th1 + th2) - dth2^2*l2*m3*cos(th0 + th1 + th2) - dth0^2*l2*m4*cos(th0 + th1 + th2) - dth1^2*l2*m4*cos(th0 + th1 + th2) - dth2^2*l2*m4*cos(th0 + th1 + th2) - dth0^2*lc12*m12*cos(th0 + th11 + th12) - dth11^2*lc12*m12*cos(th0 + th11 + th12) - dth12^2*lc12*m12*cos(th0 + th11 + th12) - dth0^2*lc2*m2*cos(th0 + th1 + th2) - dth1^2*lc2*m2*cos(th0 + th1 + th2) - dth2^2*lc2*m2*cos(th0 + th1 + th2) - dth0^2*l13*m14*cos(th0 + th11 + th12 + th13) - dth11^2*l13*m14*cos(th0 + th11 + th12 + th13) - dth12^2*l13*m14*cos(th0 + th11 + th12 + th13) - dth13^2*l13*m14*cos(th0 + th11 + th12 + th13) - dth0^2*l3*m4*cos(th0 + th1 + th2 + th3) - dth1^2*l3*m4*cos(th0 + th1 + th2 + th3) - dth2^2*l3*m4*cos(th0 + th1 + th2 + th3) - dth3^2*l3*m4*cos(th0 + th1 + th2 + th3) - dth0^2*lc13*m13*cos(th0 + th11 + th12 + th13) - dth11^2*lc13*m13*cos(th0 + th11 + th12 + th13) - dth12^2*lc13*m13*cos(th0 + th11 + th12 + th13) - dth13^2*lc13*m13*cos(th0 + th11 + th12 + th13) - dth0^2*lc3*m3*cos(th0 + th1 + th2 + th3) - dth1^2*lc3*m3*cos(th0 + th1 + th2 + th3) - dth2^2*lc3*m3*cos(th0 + th1 + th2 + th3) - dth3^2*lc3*m3*cos(th0 + th1 + th2 + th3) - dth0^2*l11*m12*cos(th0 + th11) - dth11^2*l11*m12*cos(th0 + th11) - dth0^2*l11*m13*cos(th0 + th11) - dth11^2*l11*m13*cos(th0 + th11) - dth0^2*l11*m14*cos(th0 + th11) - dth11^2*l11*m14*cos(th0 + th11) - dth0^2*l1*m2*cos(th0 + th1) - dth1^2*l1*m2*cos(th0 + th1) - dth0^2*l1*m3*cos(th0 + th1) - dth1^2*l1*m3*cos(th0 + th1) - dth0^2*l1*m4*cos(th0 + th1) - dth1^2*l1*m4*cos(th0 + th1) - dth0^2*lc1*m1*cos(th0 + th1) - dth1^2*lc1*m1*cos(th0 + th1) - dth0^2*lc11*m11*cos(th0 + th11) - dth11^2*lc11*m11*cos(th0 + th11) - dth0^2*lc0*m1*cos(th0) - dth0^2*lc14*m14*cos(th0 + th11 + th12 + th13 + th14) + dth0^2*lc0*m12*cos(th0) + dth0^2*lc0*m13*cos(th0) + dth0^2*lc0*m14*cos(th0) - dth0^2*lc0*m2*cos(th0) - dth0^2*lc0*m3*cos(th0) - dth0^2*lc0*m4*cos(th0) - 2*dth0*dth11*lc14*m14*cos(th0 + th11 + th12 + th13 + th14) - 2*dth0*dth12*lc14*m14*cos(th0 + th11 + th12 + th13 + th14) - 2*dth0*dth13*lc14*m14*cos(th0 + th11 + th12 + th13 + th14) - 2*dth0*dth14*lc14*m14*cos(th0 + th11 + th12 + th13 + th14) - 2*dth11*dth12*lc14*m14*cos(th0 + th11 + th12 + th13 + th14) - 2*dth11*dth13*lc14*m14*cos(th0 + th11 + th12 + th13 + th14) - 2*dth11*dth14*lc14*m14*cos(th0 + th11 + th12 + th13 + th14) - 2*dth12*dth13*lc14*m14*cos(th0 + th11 + th12 + th13 + th14) - 2*dth12*dth14*lc14*m14*cos(th0 + th11 + th12 + th13 + th14) - 2*dth13*dth14*lc14*m14*cos(th0 + th11 + th12 + th13 + th14) - 2*dth0*dth1*lc4*m4*cos(th0 + th1 + th2 + th3 + th4) - 2*dth0*dth2*lc4*m4*cos(th0 + th1 + th2 + th3 + th4) - 2*dth0*dth3*lc4*m4*cos(th0 + th1 + th2 + th3 + th4) - 2*dth1*dth2*lc4*m4*cos(th0 + th1 + th2 + th3 + th4) - 2*dth0*dth4*lc4*m4*cos(th0 + th1 + th2 + th3 + th4) - 2*dth1*dth3*lc4*m4*cos(th0 + th1 + th2 + th3 + th4) - 2*dth1*dth4*lc4*m4*cos(th0 + th1 + th2 + th3 + th4) - 2*dth2*dth3*lc4*m4*cos(th0 + th1 + th2 + th3 + th4) - 2*dth2*dth4*lc4*m4*cos(th0 + th1 + th2 + th3 + th4) - 2*dth3*dth4*lc4*m4*cos(th0 + th1 + th2 + th3 + th4) - 2*dth0*dth11*l12*m13*cos(th0 + th11 + th12) - 2*dth0*dth12*l12*m13*cos(th0 + th11 + th12) - 2*dth11*dth12*l12*m13*cos(th0 + th11 + th12) - 2*dth0*dth11*l12*m14*cos(th0 + th11 + th12) - 2*dth0*dth12*l12*m14*cos(th0 + th11 + th12) - 2*dth11*dth12*l12*m14*cos(th0 + th11 + th12) - 2*dth0*dth1*l2*m3*cos(th0 + th1 + th2) - 2*dth0*dth2*l2*m3*cos(th0 + th1 + th2) - 2*dth1*dth2*l2*m3*cos(th0 + th1 + th2) - 2*dth0*dth1*l2*m4*cos(th0 + th1 + th2) - 2*dth0*dth2*l2*m4*cos(th0 + th1 + th2) - 2*dth1*dth2*l2*m4*cos(th0 + th1 + th2) - 2*dth0*dth11*lc12*m12*cos(th0 + th11 + th12) - 2*dth0*dth12*lc12*m12*cos(th0 + th11 + th12) - 2*dth11*dth12*lc12*m12*cos(th0 + th11 + th12) - 2*dth0*dth1*lc2*m2*cos(th0 + th1 + th2) - 2*dth0*dth2*lc2*m2*cos(th0 + th1 + th2) - 2*dth1*dth2*lc2*m2*cos(th0 + th1 + th2) - 2*dth0*dth11*l13*m14*cos(th0 + th11 + th12 + th13) - 2*dth0*dth12*l13*m14*cos(th0 + th11 + th12 + th13) - 2*dth0*dth13*l13*m14*cos(th0 + th11 + th12 + th13) - 2*dth11*dth12*l13*m14*cos(th0 + th11 + th12 + th13) - 2*dth11*dth13*l13*m14*cos(th0 + th11 + th12 + th13) - 2*dth12*dth13*l13*m14*cos(th0 + th11 + th12 + th13) - 2*dth0*dth1*l3*m4*cos(th0 + th1 + th2 + th3) - 2*dth0*dth2*l3*m4*cos(th0 + th1 + th2 + th3) - 2*dth0*dth3*l3*m4*cos(th0 + th1 + th2 + th3) - 2*dth1*dth2*l3*m4*cos(th0 + th1 + th2 + th3) - 2*dth1*dth3*l3*m4*cos(th0 + th1 + th2 + th3) - 2*dth2*dth3*l3*m4*cos(th0 + th1 + th2 + th3) - 2*dth0*dth11*lc13*m13*cos(th0 + th11 + th12 + th13) - 2*dth0*dth12*lc13*m13*cos(th0 + th11 + th12 + th13) - 2*dth0*dth13*lc13*m13*cos(th0 + th11 + th12 + th13) - 2*dth11*dth12*lc13*m13*cos(th0 + th11 + th12 + th13) - 2*dth11*dth13*lc13*m13*cos(th0 + th11 + th12 + th13) - 2*dth12*dth13*lc13*m13*cos(th0 + th11 + th12 + th13) - 2*dth0*dth1*lc3*m3*cos(th0 + th1 + th2 + th3) - 2*dth0*dth2*lc3*m3*cos(th0 + th1 + th2 + th3) - 2*dth0*dth3*lc3*m3*cos(th0 + th1 + th2 + th3) - 2*dth1*dth2*lc3*m3*cos(th0 + th1 + th2 + th3) - 2*dth1*dth3*lc3*m3*cos(th0 + th1 + th2 + th3) - 2*dth2*dth3*lc3*m3*cos(th0 + th1 + th2 + th3) - 2*dth0*dth11*l11*m12*cos(th0 + th11) - 2*dth0*dth11*l11*m13*cos(th0 + th11) - 2*dth0*dth11*l11*m14*cos(th0 + th11) - 2*dth0*dth1*l1*m2*cos(th0 + th1) - 2*dth0*dth1*l1*m3*cos(th0 + th1) - 2*dth0*dth1*l1*m4*cos(th0 + th1) - 2*dth0*dth1*lc1*m1*cos(th0 + th1) - 2*dth0*dth11*lc11*m11*cos(th0 + th11)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              dth0^2*lc0*m11*sin(th0) - dth11^2*lc14*m14*sin(th0 + th11 + th12 + th13 + th14) - dth12^2*lc14*m14*sin(th0 + th11 + th12 + th13 + th14) - dth13^2*lc14*m14*sin(th0 + th11 + th12 + th13 + th14) - dth14^2*lc14*m14*sin(th0 + th11 + th12 + th13 + th14) - dth0^2*lc4*m4*sin(th0 + th1 + th2 + th3 + th4) - dth1^2*lc4*m4*sin(th0 + th1 + th2 + th3 + th4) - dth2^2*lc4*m4*sin(th0 + th1 + th2 + th3 + th4) - dth3^2*lc4*m4*sin(th0 + th1 + th2 + th3 + th4) - dth4^2*lc4*m4*sin(th0 + th1 + th2 + th3 + th4) - dth0^2*l12*m13*sin(th0 + th11 + th12) - dth11^2*l12*m13*sin(th0 + th11 + th12) - dth12^2*l12*m13*sin(th0 + th11 + th12) - dth0^2*l12*m14*sin(th0 + th11 + th12) - dth11^2*l12*m14*sin(th0 + th11 + th12) - dth12^2*l12*m14*sin(th0 + th11 + th12) - dth0^2*l2*m3*sin(th0 + th1 + th2) - dth1^2*l2*m3*sin(th0 + th1 + th2) - dth2^2*l2*m3*sin(th0 + th1 + th2) - dth0^2*l2*m4*sin(th0 + th1 + th2) - dth1^2*l2*m4*sin(th0 + th1 + th2) - dth2^2*l2*m4*sin(th0 + th1 + th2) - dth0^2*lc12*m12*sin(th0 + th11 + th12) - dth11^2*lc12*m12*sin(th0 + th11 + th12) - dth12^2*lc12*m12*sin(th0 + th11 + th12) - dth0^2*lc2*m2*sin(th0 + th1 + th2) - dth1^2*lc2*m2*sin(th0 + th1 + th2) - dth2^2*lc2*m2*sin(th0 + th1 + th2) - dth0^2*l13*m14*sin(th0 + th11 + th12 + th13) - dth11^2*l13*m14*sin(th0 + th11 + th12 + th13) - dth12^2*l13*m14*sin(th0 + th11 + th12 + th13) - dth13^2*l13*m14*sin(th0 + th11 + th12 + th13) - dth0^2*l3*m4*sin(th0 + th1 + th2 + th3) - dth1^2*l3*m4*sin(th0 + th1 + th2 + th3) - dth2^2*l3*m4*sin(th0 + th1 + th2 + th3) - dth3^2*l3*m4*sin(th0 + th1 + th2 + th3) - dth0^2*lc13*m13*sin(th0 + th11 + th12 + th13) - dth11^2*lc13*m13*sin(th0 + th11 + th12 + th13) - dth12^2*lc13*m13*sin(th0 + th11 + th12 + th13) - dth13^2*lc13*m13*sin(th0 + th11 + th12 + th13) - dth0^2*lc3*m3*sin(th0 + th1 + th2 + th3) - dth1^2*lc3*m3*sin(th0 + th1 + th2 + th3) - dth2^2*lc3*m3*sin(th0 + th1 + th2 + th3) - dth3^2*lc3*m3*sin(th0 + th1 + th2 + th3) - dth0^2*l11*m12*sin(th0 + th11) - dth11^2*l11*m12*sin(th0 + th11) - dth0^2*l11*m13*sin(th0 + th11) - dth11^2*l11*m13*sin(th0 + th11) - dth0^2*l11*m14*sin(th0 + th11) - dth11^2*l11*m14*sin(th0 + th11) - dth0^2*l1*m2*sin(th0 + th1) - dth1^2*l1*m2*sin(th0 + th1) - dth0^2*l1*m3*sin(th0 + th1) - dth1^2*l1*m3*sin(th0 + th1) - dth0^2*l1*m4*sin(th0 + th1) - dth1^2*l1*m4*sin(th0 + th1) - dth0^2*lc1*m1*sin(th0 + th1) - dth1^2*lc1*m1*sin(th0 + th1) - dth0^2*lc11*m11*sin(th0 + th11) - dth11^2*lc11*m11*sin(th0 + th11) - dth0^2*lc0*m1*sin(th0) - dth0^2*lc14*m14*sin(th0 + th11 + th12 + th13 + th14) + dth0^2*lc0*m12*sin(th0) + dth0^2*lc0*m13*sin(th0) + dth0^2*lc0*m14*sin(th0) - dth0^2*lc0*m2*sin(th0) - dth0^2*lc0*m3*sin(th0) - dth0^2*lc0*m4*sin(th0) - 2*dth0*dth11*lc14*m14*sin(th0 + th11 + th12 + th13 + th14) - 2*dth0*dth12*lc14*m14*sin(th0 + th11 + th12 + th13 + th14) - 2*dth0*dth13*lc14*m14*sin(th0 + th11 + th12 + th13 + th14) - 2*dth0*dth14*lc14*m14*sin(th0 + th11 + th12 + th13 + th14) - 2*dth11*dth12*lc14*m14*sin(th0 + th11 + th12 + th13 + th14) - 2*dth11*dth13*lc14*m14*sin(th0 + th11 + th12 + th13 + th14) - 2*dth11*dth14*lc14*m14*sin(th0 + th11 + th12 + th13 + th14) - 2*dth12*dth13*lc14*m14*sin(th0 + th11 + th12 + th13 + th14) - 2*dth12*dth14*lc14*m14*sin(th0 + th11 + th12 + th13 + th14) - 2*dth13*dth14*lc14*m14*sin(th0 + th11 + th12 + th13 + th14) - 2*dth0*dth1*lc4*m4*sin(th0 + th1 + th2 + th3 + th4) - 2*dth0*dth2*lc4*m4*sin(th0 + th1 + th2 + th3 + th4) - 2*dth0*dth3*lc4*m4*sin(th0 + th1 + th2 + th3 + th4) - 2*dth1*dth2*lc4*m4*sin(th0 + th1 + th2 + th3 + th4) - 2*dth0*dth4*lc4*m4*sin(th0 + th1 + th2 + th3 + th4) - 2*dth1*dth3*lc4*m4*sin(th0 + th1 + th2 + th3 + th4) - 2*dth1*dth4*lc4*m4*sin(th0 + th1 + th2 + th3 + th4) - 2*dth2*dth3*lc4*m4*sin(th0 + th1 + th2 + th3 + th4) - 2*dth2*dth4*lc4*m4*sin(th0 + th1 + th2 + th3 + th4) - 2*dth3*dth4*lc4*m4*sin(th0 + th1 + th2 + th3 + th4) - 2*dth0*dth11*l12*m13*sin(th0 + th11 + th12) - 2*dth0*dth12*l12*m13*sin(th0 + th11 + th12) - 2*dth11*dth12*l12*m13*sin(th0 + th11 + th12) - 2*dth0*dth11*l12*m14*sin(th0 + th11 + th12) - 2*dth0*dth12*l12*m14*sin(th0 + th11 + th12) - 2*dth11*dth12*l12*m14*sin(th0 + th11 + th12) - 2*dth0*dth1*l2*m3*sin(th0 + th1 + th2) - 2*dth0*dth2*l2*m3*sin(th0 + th1 + th2) - 2*dth1*dth2*l2*m3*sin(th0 + th1 + th2) - 2*dth0*dth1*l2*m4*sin(th0 + th1 + th2) - 2*dth0*dth2*l2*m4*sin(th0 + th1 + th2) - 2*dth1*dth2*l2*m4*sin(th0 + th1 + th2) - 2*dth0*dth11*lc12*m12*sin(th0 + th11 + th12) - 2*dth0*dth12*lc12*m12*sin(th0 + th11 + th12) - 2*dth11*dth12*lc12*m12*sin(th0 + th11 + th12) - 2*dth0*dth1*lc2*m2*sin(th0 + th1 + th2) - 2*dth0*dth2*lc2*m2*sin(th0 + th1 + th2) - 2*dth1*dth2*lc2*m2*sin(th0 + th1 + th2) - 2*dth0*dth11*l13*m14*sin(th0 + th11 + th12 + th13) - 2*dth0*dth12*l13*m14*sin(th0 + th11 + th12 + th13) - 2*dth0*dth13*l13*m14*sin(th0 + th11 + th12 + th13) - 2*dth11*dth12*l13*m14*sin(th0 + th11 + th12 + th13) - 2*dth11*dth13*l13*m14*sin(th0 + th11 + th12 + th13) - 2*dth12*dth13*l13*m14*sin(th0 + th11 + th12 + th13) - 2*dth0*dth1*l3*m4*sin(th0 + th1 + th2 + th3) - 2*dth0*dth2*l3*m4*sin(th0 + th1 + th2 + th3) - 2*dth0*dth3*l3*m4*sin(th0 + th1 + th2 + th3) - 2*dth1*dth2*l3*m4*sin(th0 + th1 + th2 + th3) - 2*dth1*dth3*l3*m4*sin(th0 + th1 + th2 + th3) - 2*dth2*dth3*l3*m4*sin(th0 + th1 + th2 + th3) - 2*dth0*dth11*lc13*m13*sin(th0 + th11 + th12 + th13) - 2*dth0*dth12*lc13*m13*sin(th0 + th11 + th12 + th13) - 2*dth0*dth13*lc13*m13*sin(th0 + th11 + th12 + th13) - 2*dth11*dth12*lc13*m13*sin(th0 + th11 + th12 + th13) - 2*dth11*dth13*lc13*m13*sin(th0 + th11 + th12 + th13) - 2*dth12*dth13*lc13*m13*sin(th0 + th11 + th12 + th13) - 2*dth0*dth1*lc3*m3*sin(th0 + th1 + th2 + th3) - 2*dth0*dth2*lc3*m3*sin(th0 + th1 + th2 + th3) - 2*dth0*dth3*lc3*m3*sin(th0 + th1 + th2 + th3) - 2*dth1*dth2*lc3*m3*sin(th0 + th1 + th2 + th3) - 2*dth1*dth3*lc3*m3*sin(th0 + th1 + th2 + th3) - 2*dth2*dth3*lc3*m3*sin(th0 + th1 + th2 + th3) - 2*dth0*dth11*l11*m12*sin(th0 + th11) - 2*dth0*dth11*l11*m13*sin(th0 + th11) - 2*dth0*dth11*l11*m14*sin(th0 + th11) - 2*dth0*dth1*l1*m2*sin(th0 + th1) - 2*dth0*dth1*l1*m3*sin(th0 + th1) - 2*dth0*dth1*l1*m4*sin(th0 + th1) - 2*dth0*dth1*lc1*m1*sin(th0 + th1) - 2*dth0*dth11*lc11*m11*sin(th0 + th11)
 dth11^2*lc0*lc14*m14*sin(th11 + th12 + th13 + th14) + dth12^2*lc0*lc14*m14*sin(th11 + th12 + th13 + th14) + dth13^2*lc0*lc14*m14*sin(th11 + th12 + th13 + th14) + dth14^2*lc0*lc14*m14*sin(th11 + th12 + th13 + th14) - dth1^2*lc0*lc4*m4*sin(th1 + th2 + th3 + th4) - dth2^2*lc0*lc4*m4*sin(th1 + th2 + th3 + th4) - dth3^2*lc0*lc4*m4*sin(th1 + th2 + th3 + th4) - dth4^2*lc0*lc4*m4*sin(th1 + th2 + th3 + th4) - dth12^2*l11*l13*m14*sin(th12 + th13) - dth13^2*l11*l13*m14*sin(th12 + th13) - dth2^2*l1*l3*m4*sin(th2 + th3) - dth3^2*l1*l3*m4*sin(th2 + th3) + dth11^2*l12*lc0*m13*sin(th11 + th12) + dth12^2*l12*lc0*m13*sin(th11 + th12) - dth12^2*l11*lc13*m13*sin(th12 + th13) - dth13^2*l11*lc13*m13*sin(th12 + th13) + dth11^2*l12*lc0*m14*sin(th11 + th12) + dth12^2*l12*lc0*m14*sin(th11 + th12) - dth13^2*l12*lc14*m14*sin(th13 + th14) - dth14^2*l12*lc14*m14*sin(th13 + th14) - dth2^2*l1*lc3*m3*sin(th2 + th3) - dth3^2*l1*lc3*m3*sin(th2 + th3) - dth1^2*l2*lc0*m3*sin(th1 + th2) - dth2^2*l2*lc0*m3*sin(th1 + th2) - dth1^2*l2*lc0*m4*sin(th1 + th2) - dth2^2*l2*lc0*m4*sin(th1 + th2) - dth3^2*l2*lc4*m4*sin(th3 + th4) - dth4^2*l2*lc4*m4*sin(th3 + th4) + dth11^2*lc0*lc12*m12*sin(th11 + th12) + dth12^2*lc0*lc12*m12*sin(th11 + th12) - dth1^2*lc0*lc2*m2*sin(th1 + th2) - dth2^2*lc0*lc2*m2*sin(th1 + th2) - dth12^2*l11*l12*m13*sin(th12) - dth12^2*l11*l12*m14*sin(th12) - dth13^2*l12*l13*m14*sin(th13) - dth2^2*l1*l2*m3*sin(th2) - dth2^2*l1*l2*m4*sin(th2) - dth3^2*l2*l3*m4*sin(th3) + dth11^2*l11*lc0*m12*sin(th11) + dth11^2*l11*lc0*m13*sin(th11) - dth12^2*l11*lc12*m12*sin(th12) + dth11^2*l11*lc0*m14*sin(th11) - dth13^2*l12*lc13*m13*sin(th13) - dth14^2*l13*lc14*m14*sin(th14) - dth1^2*l1*lc0*m2*sin(th1) - dth2^2*l1*lc2*m2*sin(th2) - dth1^2*l1*lc0*m3*sin(th1) - dth1^2*l1*lc0*m4*sin(th1) - dth3^2*l2*lc3*m3*sin(th3) - dth4^2*l3*lc4*m4*sin(th4) - dth1^2*lc0*lc1*m1*sin(th1) + dth11^2*lc0*lc11*m11*sin(th11) - dth12^2*l11*lc14*m14*sin(th12 + th13 + th14) - dth13^2*l11*lc14*m14*sin(th12 + th13 + th14) - dth14^2*l11*lc14*m14*sin(th12 + th13 + th14) + dth11^2*l13*lc0*m14*sin(th11 + th12 + th13) + dth12^2*l13*lc0*m14*sin(th11 + th12 + th13) + dth13^2*l13*lc0*m14*sin(th11 + th12 + th13) - dth2^2*l1*lc4*m4*sin(th2 + th3 + th4) - dth3^2*l1*lc4*m4*sin(th2 + th3 + th4) - dth4^2*l1*lc4*m4*sin(th2 + th3 + th4) - dth1^2*l3*lc0*m4*sin(th1 + th2 + th3) - dth2^2*l3*lc0*m4*sin(th1 + th2 + th3) - dth3^2*l3*lc0*m4*sin(th1 + th2 + th3) + dth11^2*lc0*lc13*m13*sin(th11 + th12 + th13) + dth12^2*lc0*lc13*m13*sin(th11 + th12 + th13) + dth13^2*lc0*lc13*m13*sin(th11 + th12 + th13) - dth1^2*lc0*lc3*m3*sin(th1 + th2 + th3) - dth2^2*lc0*lc3*m3*sin(th1 + th2 + th3) - dth3^2*lc0*lc3*m3*sin(th1 + th2 + th3) + 2*dth0*dth11*lc0*lc14*m14*sin(th11 + th12 + th13 + th14) + 2*dth0*dth12*lc0*lc14*m14*sin(th11 + th12 + th13 + th14) + 2*dth0*dth13*lc0*lc14*m14*sin(th11 + th12 + th13 + th14) + 2*dth0*dth14*lc0*lc14*m14*sin(th11 + th12 + th13 + th14) + 2*dth11*dth12*lc0*lc14*m14*sin(th11 + th12 + th13 + th14) + 2*dth11*dth13*lc0*lc14*m14*sin(th11 + th12 + th13 + th14) + 2*dth11*dth14*lc0*lc14*m14*sin(th11 + th12 + th13 + th14) + 2*dth12*dth13*lc0*lc14*m14*sin(th11 + th12 + th13 + th14) + 2*dth12*dth14*lc0*lc14*m14*sin(th11 + th12 + th13 + th14) + 2*dth13*dth14*lc0*lc14*m14*sin(th11 + th12 + th13 + th14) - 2*dth0*dth1*lc0*lc4*m4*sin(th1 + th2 + th3 + th4) - 2*dth0*dth2*lc0*lc4*m4*sin(th1 + th2 + th3 + th4) - 2*dth0*dth3*lc0*lc4*m4*sin(th1 + th2 + th3 + th4) - 2*dth1*dth2*lc0*lc4*m4*sin(th1 + th2 + th3 + th4) - 2*dth0*dth4*lc0*lc4*m4*sin(th1 + th2 + th3 + th4) - 2*dth1*dth3*lc0*lc4*m4*sin(th1 + th2 + th3 + th4) - 2*dth1*dth4*lc0*lc4*m4*sin(th1 + th2 + th3 + th4) - 2*dth2*dth3*lc0*lc4*m4*sin(th1 + th2 + th3 + th4) - 2*dth2*dth4*lc0*lc4*m4*sin(th1 + th2 + th3 + th4) - 2*dth3*dth4*lc0*lc4*m4*sin(th1 + th2 + th3 + th4) - 2*dth0*dth12*l11*l13*m14*sin(th12 + th13) - 2*dth0*dth13*l11*l13*m14*sin(th12 + th13) - 2*dth11*dth12*l11*l13*m14*sin(th12 + th13) - 2*dth11*dth13*l11*l13*m14*sin(th12 + th13) - 2*dth12*dth13*l11*l13*m14*sin(th12 + th13) - 2*dth0*dth2*l1*l3*m4*sin(th2 + th3) - 2*dth0*dth3*l1*l3*m4*sin(th2 + th3) - 2*dth1*dth2*l1*l3*m4*sin(th2 + th3) - 2*dth1*dth3*l1*l3*m4*sin(th2 + th3) - 2*dth2*dth3*l1*l3*m4*sin(th2 + th3) + 2*dth0*dth11*l12*lc0*m13*sin(th11 + th12) + 2*dth0*dth12*l12*lc0*m13*sin(th11 + th12) + 2*dth11*dth12*l12*lc0*m13*sin(th11 + th12) - 2*dth0*dth12*l11*lc13*m13*sin(th12 + th13) - 2*dth0*dth13*l11*lc13*m13*sin(th12 + th13) - 2*dth11*dth12*l11*lc13*m13*sin(th12 + th13) - 2*dth11*dth13*l11*lc13*m13*sin(th12 + th13) - 2*dth12*dth13*l11*lc13*m13*sin(th12 + th13) + 2*dth0*dth11*l12*lc0*m14*sin(th11 + th12) + 2*dth0*dth12*l12*lc0*m14*sin(th11 + th12) + 2*dth11*dth12*l12*lc0*m14*sin(th11 + th12) - 2*dth0*dth13*l12*lc14*m14*sin(th13 + th14) - 2*dth0*dth14*l12*lc14*m14*sin(th13 + th14) - 2*dth11*dth13*l12*lc14*m14*sin(th13 + th14) - 2*dth11*dth14*l12*lc14*m14*sin(th13 + th14) - 2*dth12*dth13*l12*lc14*m14*sin(th13 + th14) - 2*dth12*dth14*l12*lc14*m14*sin(th13 + th14) - 2*dth13*dth14*l12*lc14*m14*sin(th13 + th14) - 2*dth0*dth2*l1*lc3*m3*sin(th2 + th3) - 2*dth0*dth3*l1*lc3*m3*sin(th2 + th3) - 2*dth1*dth2*l1*lc3*m3*sin(th2 + th3) - 2*dth1*dth3*l1*lc3*m3*sin(th2 + th3) - 2*dth2*dth3*l1*lc3*m3*sin(th2 + th3) - 2*dth0*dth1*l2*lc0*m3*sin(th1 + th2) - 2*dth0*dth2*l2*lc0*m3*sin(th1 + th2) - 2*dth1*dth2*l2*lc0*m3*sin(th1 + th2) - 2*dth0*dth1*l2*lc0*m4*sin(th1 + th2) - 2*dth0*dth2*l2*lc0*m4*sin(th1 + th2) - 2*dth1*dth2*l2*lc0*m4*sin(th1 + th2) - 2*dth0*dth3*l2*lc4*m4*sin(th3 + th4) - 2*dth0*dth4*l2*lc4*m4*sin(th3 + th4) - 2*dth1*dth3*l2*lc4*m4*sin(th3 + th4) - 2*dth1*dth4*l2*lc4*m4*sin(th3 + th4) - 2*dth2*dth3*l2*lc4*m4*sin(th3 + th4) - 2*dth2*dth4*l2*lc4*m4*sin(th3 + th4) - 2*dth3*dth4*l2*lc4*m4*sin(th3 + th4) + 2*dth0*dth11*lc0*lc12*m12*sin(th11 + th12) + 2*dth0*dth12*lc0*lc12*m12*sin(th11 + th12) + 2*dth11*dth12*lc0*lc12*m12*sin(th11 + th12) - 2*dth0*dth1*lc0*lc2*m2*sin(th1 + th2) - 2*dth0*dth2*lc0*lc2*m2*sin(th1 + th2) - 2*dth1*dth2*lc0*lc2*m2*sin(th1 + th2) - 2*dth0*dth12*l11*l12*m13*sin(th12) - 2*dth11*dth12*l11*l12*m13*sin(th12) - 2*dth0*dth12*l11*l12*m14*sin(th12) - 2*dth11*dth12*l11*l12*m14*sin(th12) - 2*dth0*dth13*l12*l13*m14*sin(th13) - 2*dth11*dth13*l12*l13*m14*sin(th13) - 2*dth12*dth13*l12*l13*m14*sin(th13) - 2*dth0*dth2*l1*l2*m3*sin(th2) - 2*dth1*dth2*l1*l2*m3*sin(th2) - 2*dth0*dth2*l1*l2*m4*sin(th2) - 2*dth1*dth2*l1*l2*m4*sin(th2) - 2*dth0*dth3*l2*l3*m4*sin(th3) - 2*dth1*dth3*l2*l3*m4*sin(th3) - 2*dth2*dth3*l2*l3*m4*sin(th3) + 2*dth0*dth11*l11*lc0*m12*sin(th11) + 2*dth0*dth11*l11*lc0*m13*sin(th11) - 2*dth0*dth12*l11*lc12*m12*sin(th12) - 2*dth11*dth12*l11*lc12*m12*sin(th12) + 2*dth0*dth11*l11*lc0*m14*sin(th11) - 2*dth0*dth13*l12*lc13*m13*sin(th13) - 2*dth11*dth13*l12*lc13*m13*sin(th13) - 2*dth12*dth13*l12*lc13*m13*sin(th13) - 2*dth0*dth14*l13*lc14*m14*sin(th14) - 2*dth11*dth14*l13*lc14*m14*sin(th14) - 2*dth12*dth14*l13*lc14*m14*sin(th14) - 2*dth13*dth14*l13*lc14*m14*sin(th14) - 2*dth0*dth1*l1*lc0*m2*sin(th1) - 2*dth0*dth2*l1*lc2*m2*sin(th2) - 2*dth1*dth2*l1*lc2*m2*sin(th2) - 2*dth0*dth1*l1*lc0*m3*sin(th1) - 2*dth0*dth1*l1*lc0*m4*sin(th1) - 2*dth0*dth3*l2*lc3*m3*sin(th3) - 2*dth1*dth3*l2*lc3*m3*sin(th3) - 2*dth2*dth3*l2*lc3*m3*sin(th3) - 2*dth0*dth4*l3*lc4*m4*sin(th4) - 2*dth1*dth4*l3*lc4*m4*sin(th4) - 2*dth2*dth4*l3*lc4*m4*sin(th4) - 2*dth3*dth4*l3*lc4*m4*sin(th4) - 2*dth0*dth1*lc0*lc1*m1*sin(th1) + 2*dth0*dth11*lc0*lc11*m11*sin(th11) - 2*dth0*dth12*l11*lc14*m14*sin(th12 + th13 + th14) - 2*dth0*dth13*l11*lc14*m14*sin(th12 + th13 + th14) - 2*dth0*dth14*l11*lc14*m14*sin(th12 + th13 + th14) - 2*dth11*dth12*l11*lc14*m14*sin(th12 + th13 + th14) - 2*dth11*dth13*l11*lc14*m14*sin(th12 + th13 + th14) - 2*dth11*dth14*l11*lc14*m14*sin(th12 + th13 + th14) - 2*dth12*dth13*l11*lc14*m14*sin(th12 + th13 + th14) - 2*dth12*dth14*l11*lc14*m14*sin(th12 + th13 + th14) - 2*dth13*dth14*l11*lc14*m14*sin(th12 + th13 + th14) + 2*dth0*dth11*l13*lc0*m14*sin(th11 + th12 + th13) + 2*dth0*dth12*l13*lc0*m14*sin(th11 + th12 + th13) + 2*dth0*dth13*l13*lc0*m14*sin(th11 + th12 + th13) + 2*dth11*dth12*l13*lc0*m14*sin(th11 + th12 + th13) + 2*dth11*dth13*l13*lc0*m14*sin(th11 + th12 + th13) + 2*dth12*dth13*l13*lc0*m14*sin(th11 + th12 + th13) - 2*dth0*dth2*l1*lc4*m4*sin(th2 + th3 + th4) - 2*dth0*dth3*l1*lc4*m4*sin(th2 + th3 + th4) - 2*dth1*dth2*l1*lc4*m4*sin(th2 + th3 + th4) - 2*dth0*dth4*l1*lc4*m4*sin(th2 + th3 + th4) - 2*dth1*dth3*l1*lc4*m4*sin(th2 + th3 + th4) - 2*dth1*dth4*l1*lc4*m4*sin(th2 + th3 + th4) - 2*dth2*dth3*l1*lc4*m4*sin(th2 + th3 + th4) - 2*dth2*dth4*l1*lc4*m4*sin(th2 + th3 + th4) - 2*dth3*dth4*l1*lc4*m4*sin(th2 + th3 + th4) - 2*dth0*dth1*l3*lc0*m4*sin(th1 + th2 + th3) - 2*dth0*dth2*l3*lc0*m4*sin(th1 + th2 + th3) - 2*dth0*dth3*l3*lc0*m4*sin(th1 + th2 + th3) - 2*dth1*dth2*l3*lc0*m4*sin(th1 + th2 + th3) - 2*dth1*dth3*l3*lc0*m4*sin(th1 + th2 + th3) - 2*dth2*dth3*l3*lc0*m4*sin(th1 + th2 + th3) + 2*dth0*dth11*lc0*lc13*m13*sin(th11 + th12 + th13) + 2*dth0*dth12*lc0*lc13*m13*sin(th11 + th12 + th13) + 2*dth0*dth13*lc0*lc13*m13*sin(th11 + th12 + th13) + 2*dth11*dth12*lc0*lc13*m13*sin(th11 + th12 + th13) + 2*dth11*dth13*lc0*lc13*m13*sin(th11 + th12 + th13) + 2*dth12*dth13*lc0*lc13*m13*sin(th11 + th12 + th13) - 2*dth0*dth1*lc0*lc3*m3*sin(th1 + th2 + th3) - 2*dth0*dth2*lc0*lc3*m3*sin(th1 + th2 + th3) - 2*dth0*dth3*lc0*lc3*m3*sin(th1 + th2 + th3) - 2*dth1*dth2*lc0*lc3*m3*sin(th1 + th2 + th3) - 2*dth1*dth3*lc0*lc3*m3*sin(th1 + th2 + th3) - 2*dth2*dth3*lc0*lc3*m3*sin(th1 + th2 + th3)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             dth0^2*lc0*lc4*m4*sin(th1 + th2 + th3 + th4) - dth2^2*l1*l3*m4*sin(th2 + th3) - dth3^2*l1*l3*m4*sin(th2 + th3) - dth2^2*l1*lc3*m3*sin(th2 + th3) - dth3^2*l1*lc3*m3*sin(th2 + th3) + dth0^2*l2*lc0*m3*sin(th1 + th2) + dth0^2*l2*lc0*m4*sin(th1 + th2) - dth3^2*l2*lc4*m4*sin(th3 + th4) - dth4^2*l2*lc4*m4*sin(th3 + th4) + dth0^2*lc0*lc2*m2*sin(th1 + th2) - dth2^2*l1*l2*m3*sin(th2) - dth2^2*l1*l2*m4*sin(th2) - dth3^2*l2*l3*m4*sin(th3) + dth0^2*l1*lc0*m2*sin(th1) - dth2^2*l1*lc2*m2*sin(th2) + dth0^2*l1*lc0*m3*sin(th1) + dth0^2*l1*lc0*m4*sin(th1) - dth3^2*l2*lc3*m3*sin(th3) - dth4^2*l3*lc4*m4*sin(th4) + dth0^2*lc0*lc1*m1*sin(th1) - dth2^2*l1*lc4*m4*sin(th2 + th3 + th4) - dth3^2*l1*lc4*m4*sin(th2 + th3 + th4) - dth4^2*l1*lc4*m4*sin(th2 + th3 + th4) + dth0^2*l3*lc0*m4*sin(th1 + th2 + th3) + dth0^2*lc0*lc3*m3*sin(th1 + th2 + th3) - 2*dth0*dth2*l1*l3*m4*sin(th2 + th3) - 2*dth0*dth3*l1*l3*m4*sin(th2 + th3) - 2*dth1*dth2*l1*l3*m4*sin(th2 + th3) - 2*dth1*dth3*l1*l3*m4*sin(th2 + th3) - 2*dth2*dth3*l1*l3*m4*sin(th2 + th3) - 2*dth0*dth2*l1*lc3*m3*sin(th2 + th3) - 2*dth0*dth3*l1*lc3*m3*sin(th2 + th3) - 2*dth1*dth2*l1*lc3*m3*sin(th2 + th3) - 2*dth1*dth3*l1*lc3*m3*sin(th2 + th3) - 2*dth2*dth3*l1*lc3*m3*sin(th2 + th3) - 2*dth0*dth3*l2*lc4*m4*sin(th3 + th4) - 2*dth0*dth4*l2*lc4*m4*sin(th3 + th4) - 2*dth1*dth3*l2*lc4*m4*sin(th3 + th4) - 2*dth1*dth4*l2*lc4*m4*sin(th3 + th4) - 2*dth2*dth3*l2*lc4*m4*sin(th3 + th4) - 2*dth2*dth4*l2*lc4*m4*sin(th3 + th4) - 2*dth3*dth4*l2*lc4*m4*sin(th3 + th4) - 2*dth0*dth2*l1*l2*m3*sin(th2) - 2*dth1*dth2*l1*l2*m3*sin(th2) - 2*dth0*dth2*l1*l2*m4*sin(th2) - 2*dth1*dth2*l1*l2*m4*sin(th2) - 2*dth0*dth3*l2*l3*m4*sin(th3) - 2*dth1*dth3*l2*l3*m4*sin(th3) - 2*dth2*dth3*l2*l3*m4*sin(th3) - 2*dth0*dth2*l1*lc2*m2*sin(th2) - 2*dth1*dth2*l1*lc2*m2*sin(th2) - 2*dth0*dth3*l2*lc3*m3*sin(th3) - 2*dth1*dth3*l2*lc3*m3*sin(th3) - 2*dth2*dth3*l2*lc3*m3*sin(th3) - 2*dth0*dth4*l3*lc4*m4*sin(th4) - 2*dth1*dth4*l3*lc4*m4*sin(th4) - 2*dth2*dth4*l3*lc4*m4*sin(th4) - 2*dth3*dth4*l3*lc4*m4*sin(th4) - 2*dth0*dth2*l1*lc4*m4*sin(th2 + th3 + th4) - 2*dth0*dth3*l1*lc4*m4*sin(th2 + th3 + th4) - 2*dth1*dth2*l1*lc4*m4*sin(th2 + th3 + th4) - 2*dth0*dth4*l1*lc4*m4*sin(th2 + th3 + th4) - 2*dth1*dth3*l1*lc4*m4*sin(th2 + th3 + th4) - 2*dth1*dth4*l1*lc4*m4*sin(th2 + th3 + th4) - 2*dth2*dth3*l1*lc4*m4*sin(th2 + th3 + th4) - 2*dth2*dth4*l1*lc4*m4*sin(th2 + th3 + th4) - 2*dth3*dth4*l1*lc4*m4*sin(th2 + th3 + th4)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 dth0^2*lc0*lc4*m4*sin(th1 + th2 + th3 + th4) + dth0^2*l1*l3*m4*sin(th2 + th3) + dth1^2*l1*l3*m4*sin(th2 + th3) + dth0^2*l1*lc3*m3*sin(th2 + th3) + dth1^2*l1*lc3*m3*sin(th2 + th3) + dth0^2*l2*lc0*m3*sin(th1 + th2) + dth0^2*l2*lc0*m4*sin(th1 + th2) - dth3^2*l2*lc4*m4*sin(th3 + th4) - dth4^2*l2*lc4*m4*sin(th3 + th4) + dth0^2*lc0*lc2*m2*sin(th1 + th2) + dth0^2*l1*l2*m3*sin(th2) + dth1^2*l1*l2*m3*sin(th2) + dth0^2*l1*l2*m4*sin(th2) + dth1^2*l1*l2*m4*sin(th2) - dth3^2*l2*l3*m4*sin(th3) + dth0^2*l1*lc2*m2*sin(th2) + dth1^2*l1*lc2*m2*sin(th2) - dth3^2*l2*lc3*m3*sin(th3) - dth4^2*l3*lc4*m4*sin(th4) + dth0^2*l1*lc4*m4*sin(th2 + th3 + th4) + dth1^2*l1*lc4*m4*sin(th2 + th3 + th4) + dth0^2*l3*lc0*m4*sin(th1 + th2 + th3) + dth0^2*lc0*lc3*m3*sin(th1 + th2 + th3) + 2*dth0*dth1*l1*l3*m4*sin(th2 + th3) + 2*dth0*dth1*l1*lc3*m3*sin(th2 + th3) - 2*dth0*dth3*l2*lc4*m4*sin(th3 + th4) - 2*dth0*dth4*l2*lc4*m4*sin(th3 + th4) - 2*dth1*dth3*l2*lc4*m4*sin(th3 + th4) - 2*dth1*dth4*l2*lc4*m4*sin(th3 + th4) - 2*dth2*dth3*l2*lc4*m4*sin(th3 + th4) - 2*dth2*dth4*l2*lc4*m4*sin(th3 + th4) - 2*dth3*dth4*l2*lc4*m4*sin(th3 + th4) + 2*dth0*dth1*l1*l2*m3*sin(th2) + 2*dth0*dth1*l1*l2*m4*sin(th2) - 2*dth0*dth3*l2*l3*m4*sin(th3) - 2*dth1*dth3*l2*l3*m4*sin(th3) - 2*dth2*dth3*l2*l3*m4*sin(th3) + 2*dth0*dth1*l1*lc2*m2*sin(th2) - 2*dth0*dth3*l2*lc3*m3*sin(th3) - 2*dth1*dth3*l2*lc3*m3*sin(th3) - 2*dth2*dth3*l2*lc3*m3*sin(th3) - 2*dth0*dth4*l3*lc4*m4*sin(th4) - 2*dth1*dth4*l3*lc4*m4*sin(th4) - 2*dth2*dth4*l3*lc4*m4*sin(th4) - 2*dth3*dth4*l3*lc4*m4*sin(th4) + 2*dth0*dth1*l1*lc4*m4*sin(th2 + th3 + th4)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         dth0^2*lc0*lc4*m4*sin(th1 + th2 + th3 + th4) + dth0^2*l1*l3*m4*sin(th2 + th3) + dth1^2*l1*l3*m4*sin(th2 + th3) + dth0^2*l1*lc3*m3*sin(th2 + th3) + dth1^2*l1*lc3*m3*sin(th2 + th3) + dth0^2*l2*lc4*m4*sin(th3 + th4) + dth1^2*l2*lc4*m4*sin(th3 + th4) + dth2^2*l2*lc4*m4*sin(th3 + th4) + dth0^2*l2*l3*m4*sin(th3) + dth1^2*l2*l3*m4*sin(th3) + dth2^2*l2*l3*m4*sin(th3) + dth0^2*l2*lc3*m3*sin(th3) + dth1^2*l2*lc3*m3*sin(th3) + dth2^2*l2*lc3*m3*sin(th3) - dth4^2*l3*lc4*m4*sin(th4) + dth0^2*l1*lc4*m4*sin(th2 + th3 + th4) + dth1^2*l1*lc4*m4*sin(th2 + th3 + th4) + dth0^2*l3*lc0*m4*sin(th1 + th2 + th3) + dth0^2*lc0*lc3*m3*sin(th1 + th2 + th3) + 2*dth0*dth1*l1*l3*m4*sin(th2 + th3) + 2*dth0*dth1*l1*lc3*m3*sin(th2 + th3) + 2*dth0*dth1*l2*lc4*m4*sin(th3 + th4) + 2*dth0*dth2*l2*lc4*m4*sin(th3 + th4) + 2*dth1*dth2*l2*lc4*m4*sin(th3 + th4) + 2*dth0*dth1*l2*l3*m4*sin(th3) + 2*dth0*dth2*l2*l3*m4*sin(th3) + 2*dth1*dth2*l2*l3*m4*sin(th3) + 2*dth0*dth1*l2*lc3*m3*sin(th3) + 2*dth0*dth2*l2*lc3*m3*sin(th3) + 2*dth1*dth2*l2*lc3*m3*sin(th3) - 2*dth0*dth4*l3*lc4*m4*sin(th4) - 2*dth1*dth4*l3*lc4*m4*sin(th4) - 2*dth2*dth4*l3*lc4*m4*sin(th4) - 2*dth3*dth4*l3*lc4*m4*sin(th4) + 2*dth0*dth1*l1*lc4*m4*sin(th2 + th3 + th4)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  lc4*m4*(dth0^2*lc0*sin(th1 + th2 + th3 + th4) + dth0^2*l2*sin(th3 + th4) + dth1^2*l2*sin(th3 + th4) + dth2^2*l2*sin(th3 + th4) + dth0^2*l3*sin(th4) + dth1^2*l3*sin(th4) + dth2^2*l3*sin(th4) + dth3^2*l3*sin(th4) + dth0^2*l1*sin(th2 + th3 + th4) + dth1^2*l1*sin(th2 + th3 + th4) + 2*dth0*dth1*l2*sin(th3 + th4) + 2*dth0*dth2*l2*sin(th3 + th4) + 2*dth1*dth2*l2*sin(th3 + th4) + 2*dth0*dth1*l3*sin(th4) + 2*dth0*dth2*l3*sin(th4) + 2*dth0*dth3*l3*sin(th4) + 2*dth1*dth2*l3*sin(th4) + 2*dth1*dth3*l3*sin(th4) + 2*dth2*dth3*l3*sin(th4) + 2*dth0*dth1*l1*sin(th2 + th3 + th4))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            - dth0^2*lc0*lc14*m14*sin(th11 + th12 + th13 + th14) - dth12^2*l11*l13*m14*sin(th12 + th13) - dth13^2*l11*l13*m14*sin(th12 + th13) - dth0^2*l12*lc0*m13*sin(th11 + th12) - dth12^2*l11*lc13*m13*sin(th12 + th13) - dth13^2*l11*lc13*m13*sin(th12 + th13) - dth0^2*l12*lc0*m14*sin(th11 + th12) - dth13^2*l12*lc14*m14*sin(th13 + th14) - dth14^2*l12*lc14*m14*sin(th13 + th14) - dth0^2*lc0*lc12*m12*sin(th11 + th12) - dth12^2*l11*l12*m13*sin(th12) - dth12^2*l11*l12*m14*sin(th12) - dth13^2*l12*l13*m14*sin(th13) - dth0^2*l11*lc0*m12*sin(th11) - dth0^2*l11*lc0*m13*sin(th11) - dth12^2*l11*lc12*m12*sin(th12) - dth0^2*l11*lc0*m14*sin(th11) - dth13^2*l12*lc13*m13*sin(th13) - dth14^2*l13*lc14*m14*sin(th14) - dth0^2*lc0*lc11*m11*sin(th11) - dth12^2*l11*lc14*m14*sin(th12 + th13 + th14) - dth13^2*l11*lc14*m14*sin(th12 + th13 + th14) - dth14^2*l11*lc14*m14*sin(th12 + th13 + th14) - dth0^2*l13*lc0*m14*sin(th11 + th12 + th13) - dth0^2*lc0*lc13*m13*sin(th11 + th12 + th13) - 2*dth0*dth12*l11*l13*m14*sin(th12 + th13) - 2*dth0*dth13*l11*l13*m14*sin(th12 + th13) - 2*dth11*dth12*l11*l13*m14*sin(th12 + th13) - 2*dth11*dth13*l11*l13*m14*sin(th12 + th13) - 2*dth12*dth13*l11*l13*m14*sin(th12 + th13) - 2*dth0*dth12*l11*lc13*m13*sin(th12 + th13) - 2*dth0*dth13*l11*lc13*m13*sin(th12 + th13) - 2*dth11*dth12*l11*lc13*m13*sin(th12 + th13) - 2*dth11*dth13*l11*lc13*m13*sin(th12 + th13) - 2*dth12*dth13*l11*lc13*m13*sin(th12 + th13) - 2*dth0*dth13*l12*lc14*m14*sin(th13 + th14) - 2*dth0*dth14*l12*lc14*m14*sin(th13 + th14) - 2*dth11*dth13*l12*lc14*m14*sin(th13 + th14) - 2*dth11*dth14*l12*lc14*m14*sin(th13 + th14) - 2*dth12*dth13*l12*lc14*m14*sin(th13 + th14) - 2*dth12*dth14*l12*lc14*m14*sin(th13 + th14) - 2*dth13*dth14*l12*lc14*m14*sin(th13 + th14) - 2*dth0*dth12*l11*l12*m13*sin(th12) - 2*dth11*dth12*l11*l12*m13*sin(th12) - 2*dth0*dth12*l11*l12*m14*sin(th12) - 2*dth11*dth12*l11*l12*m14*sin(th12) - 2*dth0*dth13*l12*l13*m14*sin(th13) - 2*dth11*dth13*l12*l13*m14*sin(th13) - 2*dth12*dth13*l12*l13*m14*sin(th13) - 2*dth0*dth12*l11*lc12*m12*sin(th12) - 2*dth11*dth12*l11*lc12*m12*sin(th12) - 2*dth0*dth13*l12*lc13*m13*sin(th13) - 2*dth11*dth13*l12*lc13*m13*sin(th13) - 2*dth12*dth13*l12*lc13*m13*sin(th13) - 2*dth0*dth14*l13*lc14*m14*sin(th14) - 2*dth11*dth14*l13*lc14*m14*sin(th14) - 2*dth12*dth14*l13*lc14*m14*sin(th14) - 2*dth13*dth14*l13*lc14*m14*sin(th14) - 2*dth0*dth12*l11*lc14*m14*sin(th12 + th13 + th14) - 2*dth0*dth13*l11*lc14*m14*sin(th12 + th13 + th14) - 2*dth0*dth14*l11*lc14*m14*sin(th12 + th13 + th14) - 2*dth11*dth12*l11*lc14*m14*sin(th12 + th13 + th14) - 2*dth11*dth13*l11*lc14*m14*sin(th12 + th13 + th14) - 2*dth11*dth14*l11*lc14*m14*sin(th12 + th13 + th14) - 2*dth12*dth13*l11*lc14*m14*sin(th12 + th13 + th14) - 2*dth12*dth14*l11*lc14*m14*sin(th12 + th13 + th14) - 2*dth13*dth14*l11*lc14*m14*sin(th12 + th13 + th14)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  dth0^2*l11*l13*m14*sin(th12 + th13) - dth0^2*lc0*lc14*m14*sin(th11 + th12 + th13 + th14) + dth11^2*l11*l13*m14*sin(th12 + th13) - dth0^2*l12*lc0*m13*sin(th11 + th12) + dth0^2*l11*lc13*m13*sin(th12 + th13) + dth11^2*l11*lc13*m13*sin(th12 + th13) - dth0^2*l12*lc0*m14*sin(th11 + th12) - dth13^2*l12*lc14*m14*sin(th13 + th14) - dth14^2*l12*lc14*m14*sin(th13 + th14) - dth0^2*lc0*lc12*m12*sin(th11 + th12) + dth0^2*l11*l12*m13*sin(th12) + dth11^2*l11*l12*m13*sin(th12) + dth0^2*l11*l12*m14*sin(th12) + dth11^2*l11*l12*m14*sin(th12) - dth13^2*l12*l13*m14*sin(th13) + dth0^2*l11*lc12*m12*sin(th12) + dth11^2*l11*lc12*m12*sin(th12) - dth13^2*l12*lc13*m13*sin(th13) - dth14^2*l13*lc14*m14*sin(th14) + dth0^2*l11*lc14*m14*sin(th12 + th13 + th14) + dth11^2*l11*lc14*m14*sin(th12 + th13 + th14) - dth0^2*l13*lc0*m14*sin(th11 + th12 + th13) - dth0^2*lc0*lc13*m13*sin(th11 + th12 + th13) + 2*dth0*dth11*l11*l13*m14*sin(th12 + th13) + 2*dth0*dth11*l11*lc13*m13*sin(th12 + th13) - 2*dth0*dth13*l12*lc14*m14*sin(th13 + th14) - 2*dth0*dth14*l12*lc14*m14*sin(th13 + th14) - 2*dth11*dth13*l12*lc14*m14*sin(th13 + th14) - 2*dth11*dth14*l12*lc14*m14*sin(th13 + th14) - 2*dth12*dth13*l12*lc14*m14*sin(th13 + th14) - 2*dth12*dth14*l12*lc14*m14*sin(th13 + th14) - 2*dth13*dth14*l12*lc14*m14*sin(th13 + th14) + 2*dth0*dth11*l11*l12*m13*sin(th12) + 2*dth0*dth11*l11*l12*m14*sin(th12) - 2*dth0*dth13*l12*l13*m14*sin(th13) - 2*dth11*dth13*l12*l13*m14*sin(th13) - 2*dth12*dth13*l12*l13*m14*sin(th13) + 2*dth0*dth11*l11*lc12*m12*sin(th12) - 2*dth0*dth13*l12*lc13*m13*sin(th13) - 2*dth11*dth13*l12*lc13*m13*sin(th13) - 2*dth12*dth13*l12*lc13*m13*sin(th13) - 2*dth0*dth14*l13*lc14*m14*sin(th14) - 2*dth11*dth14*l13*lc14*m14*sin(th14) - 2*dth12*dth14*l13*lc14*m14*sin(th14) - 2*dth13*dth14*l13*lc14*m14*sin(th14) + 2*dth0*dth11*l11*lc14*m14*sin(th12 + th13 + th14)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       dth0^2*l11*l13*m14*sin(th12 + th13) - dth0^2*lc0*lc14*m14*sin(th11 + th12 + th13 + th14) + dth11^2*l11*l13*m14*sin(th12 + th13) + dth0^2*l11*lc13*m13*sin(th12 + th13) + dth11^2*l11*lc13*m13*sin(th12 + th13) + dth0^2*l12*lc14*m14*sin(th13 + th14) + dth11^2*l12*lc14*m14*sin(th13 + th14) + dth12^2*l12*lc14*m14*sin(th13 + th14) + dth0^2*l12*l13*m14*sin(th13) + dth11^2*l12*l13*m14*sin(th13) + dth12^2*l12*l13*m14*sin(th13) + dth0^2*l12*lc13*m13*sin(th13) + dth11^2*l12*lc13*m13*sin(th13) + dth12^2*l12*lc13*m13*sin(th13) - dth14^2*l13*lc14*m14*sin(th14) + dth0^2*l11*lc14*m14*sin(th12 + th13 + th14) + dth11^2*l11*lc14*m14*sin(th12 + th13 + th14) - dth0^2*l13*lc0*m14*sin(th11 + th12 + th13) - dth0^2*lc0*lc13*m13*sin(th11 + th12 + th13) + 2*dth0*dth11*l11*l13*m14*sin(th12 + th13) + 2*dth0*dth11*l11*lc13*m13*sin(th12 + th13) + 2*dth0*dth11*l12*lc14*m14*sin(th13 + th14) + 2*dth0*dth12*l12*lc14*m14*sin(th13 + th14) + 2*dth11*dth12*l12*lc14*m14*sin(th13 + th14) + 2*dth0*dth11*l12*l13*m14*sin(th13) + 2*dth0*dth12*l12*l13*m14*sin(th13) + 2*dth11*dth12*l12*l13*m14*sin(th13) + 2*dth0*dth11*l12*lc13*m13*sin(th13) + 2*dth0*dth12*l12*lc13*m13*sin(th13) + 2*dth11*dth12*l12*lc13*m13*sin(th13) - 2*dth0*dth14*l13*lc14*m14*sin(th14) - 2*dth11*dth14*l13*lc14*m14*sin(th14) - 2*dth12*dth14*l13*lc14*m14*sin(th14) - 2*dth13*dth14*l13*lc14*m14*sin(th14) + 2*dth0*dth11*l11*lc14*m14*sin(th12 + th13 + th14)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      lc14*m14*(dth0^2*l12*sin(th13 + th14) - dth0^2*lc0*sin(th11 + th12 + th13 + th14) + dth11^2*l12*sin(th13 + th14) + dth12^2*l12*sin(th13 + th14) + dth0^2*l13*sin(th14) + dth11^2*l13*sin(th14) + dth12^2*l13*sin(th14) + dth13^2*l13*sin(th14) + dth0^2*l11*sin(th12 + th13 + th14) + dth11^2*l11*sin(th12 + th13 + th14) + 2*dth0*dth11*l12*sin(th13 + th14) + 2*dth0*dth12*l12*sin(th13 + th14) + 2*dth11*dth12*l12*sin(th13 + th14) + 2*dth0*dth11*l13*sin(th14) + 2*dth0*dth12*l13*sin(th14) + 2*dth0*dth13*l13*sin(th14) + 2*dth11*dth12*l13*sin(th14) + 2*dth11*dth13*l13*sin(th14) + 2*dth12*dth13*l13*sin(th14) + 2*dth0*dth11*l11*sin(th12 + th13 + th14))]
 
Cb=C(1:3,1);
Cm=C(4:11,1);


J1=zeros(6,2);
  
J2 =[ - l3*sin(th0 + th1 + th2 + th3) - l1*sin(th0 + th1) - lc0*sin(th0) - l4*sin(th0 + th1 + th2 + th3 + th4) - l2*sin(th0 + th1 + th2), - l3*sin(th0 + th1 + th2 + th3) - l1*sin(th0 + th1) - l4*sin(th0 + th1 + th2 + th3 + th4) - l2*sin(th0 + th1 + th2), - l3*sin(th0 + th1 + th2 + th3) - l4*sin(th0 + th1 + th2 + th3 + th4) - l2*sin(th0 + th1 + th2), - l3*sin(th0 + th1 + th2 + th3) - l4*sin(th0 + th1 + th2 + th3 + th4), -l4*sin(th0 + th1 + th2 + th3 + th4)
   l3*cos(th0 + th1 + th2 + th3) + l1*cos(th0 + th1) + lc0*cos(th0) + l4*cos(th0 + th1 + th2 + th3 + th4) + l2*cos(th0 + th1 + th2),   l3*cos(th0 + th1 + th2 + th3) + l1*cos(th0 + th1) + l4*cos(th0 + th1 + th2 + th3 + th4) + l2*cos(th0 + th1 + th2),   l3*cos(th0 + th1 + th2 + th3) + l4*cos(th0 + th1 + th2 + th3 + th4) + l2*cos(th0 + th1 + th2),   l3*cos(th0 + th1 + th2 + th3) + l4*cos(th0 + th1 + th2 + th3 + th4),  l4*cos(th0 + th1 + th2 + th3 + th4)];

J3=[ - l13*sin(th0 + th11 + th12 + th13) - l11*sin(th0 + th11) + lc0*sin(th0) - l14*sin(th0 + th11 + th12 + th13 + th14) - l12*sin(th0 + th11 + th12), - l13*sin(th0 + th11 + th12 + th13) - l11*sin(th0 + th11) - l14*sin(th0 + th11 + th12 + th13 + th14) - l12*sin(th0 + th11 + th12), - l13*sin(th0 + th11 + th12 + th13) - l14*sin(th0 + th11 + th12 + th13 + th14) - l12*sin(th0 + th11 + th12), - l13*sin(th0 + th11 + th12 + th13) - l14*sin(th0 + th11 + th12 + th13 + th14), -l14*sin(th0 + th11 + th12 + th13 + th14)
   l13*cos(th0 + th11 + th12 + th13) + l11*cos(th0 + th11) - lc0*cos(th0) + l14*cos(th0 + th11 + th12 + th13 + th14) + l12*cos(th0 + th11 + th12),   l13*cos(th0 + th11 + th12 + th13) + l11*cos(th0 + th11) + l14*cos(th0 + th11 + th12 + th13 + th14) + l12*cos(th0 + th11 + th12),   l13*cos(th0 + th11 + th12 + th13) + l14*cos(th0 + th11 + th12 + th13 + th14) + l12*cos(th0 + th11 + th12),   l13*cos(th0 + th11 + th12 + th13) + l14*cos(th0 + th11 + th12 + th13 + th14),  l14*cos(th0 + th11 + th12 + th13 + th14)];

J(1:6,1:2)=J1;
J(1,3:7)=ones(1,5);
J(2:3,4:7)=J2(:,2:5);
J(2:3,3)=J2(:,1);
J(1:3,8:11)=zeros(3,4)
J(5:6,8:11)=J3(:,2:5);
J(5:6,3)=J3(:,1);
J(4,8:11)=ones(1,4);
J(4,3)=ones(1,1);

Jbe=J(:,1:3)
Jme=J(:,4:11)

F=[fx0; fy0; tau0; tau1; tau2; tau3; tau4; tau11; tau12; tau13; tau14]

Fb=F(1:3);
Fm=F(4:11);


%GENERALISED MATRICES

Ibinv=inv(Ib);
%Ibinv=simplify(Ibinv);
I=Im-(Ibm.'*Ibinv*Ibm);
%I=simplify(I);                        %GIM
%c=Cm-(Ibm.'*Ibinv*Cb);
%c=simplify(c);                      %GCFM
%F=Fm-(Ibm.'*Ibinv*Fb);
%F=simplify(F);                     %GTM
JT=Jme.'-(Ibm.'*Ibinv*(Jbe.'));
%JT=simplify(JT);                  %GJM

%P=Jt*Jt.'
%Q=Jt.'*Jt
G=I+JT*(pinv(Jt.'))*Mt*(pinv(Jt))*(JT.')

H=(JT*(pinv(Jt.'))*Mt*tti)+(I*thdoti)

thdotf=(inv(G))*H

ttf=pinv(Jt)*(JT.')*thdotf
tbf=-Ibinv*Ibm*thdotf
vef=J*[tbf;thdotf]

Fimp=(pinv(JT))*I*(thdotf-thdoti)

%end