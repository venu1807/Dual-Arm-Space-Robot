%clc;
%clear all;

function dy = rigid(t,y)

x0=y(1); y0=y(2); th0=y(3); th1=y(4); th2=y(5); th3=y(6); th4=y(7); th5=y(8); th6=y(9); th7=y(10);lmdx=y(11);lmdy=y(12)
dx0=y(13); dy0=y(14); dth0=y(15); dth1=y(16); dth2=y(17); dth3=y(18);dth4=y(19); dth5=y(20); dth6=y(21); dth7=y(22);dlmdx=y(23);dlmdy=y(24);

%INPUT DATA

Ti=0;Tf=5;

%[ddq]= accln()

m0=500;m1=1;m2=1;m3=1;m4=1;m5=1;m6=1; m7=1; l0=1;l1=1;l2=1;l3=1;l4=1;l5=1;l6=1; l7=1; lc0=.5*l0;lc1=.5*l1;lc2=.5*l2;lc3=.5*l3; lc4=.5*l4;lc5=.5*l5;lc6=.5*l6; lc7=.5*l7; 
Izz0=83.61; Izz1=1.05; Izz2=1.05; Izz3=1.05;Izz4=1.05; Izz5=1.05; Izz6=1.05; Izz7=1.05;

%syms th1 th2 dth1 dth2 tau1 tau2 tau3

fx0=0; fy0=0; tau0=0;

%thin=[0.3803;   -0.6198;    1.2867;  pi-0.3803;   0.6198;    -1.2867 ; 0];%60

thin=[-pi/4; -pi/4; -pi/4; pi+(pi/4); pi/4; pi/4; pi/4];

thf=[0*pi/180; -90*pi/180; -90*pi/180; pi-(0); pi/2; pi/2; 0];


th1_d=thin(1)+((thf(1)-thin(1))/Tf)*(t-(Tf/(2*pi))*sin((2*pi/Tf)*t));
    dth1_d=((thf(1)-thin(1))/Tf)*(1-cos((2*pi/Tf)*t));
    ddth1_d=(2*pi*(thf(1)-thin(1))/(Tf*Tf))*sin((2*pi/Tf)*t);

th2_d=thin(2)+((thf(2)-thin(2))/Tf)*(t-(Tf/(2*pi))*sin((2*pi/Tf)*t));
    dth2_d=((thf(2)-thin(2))/Tf)*(1-cos((2*pi/Tf)*t));
    ddth2_d=(2*pi*(thf(2)-thin(2))/(Tf*Tf))*sin((2*pi/Tf)*t);

th3_d=thin(3)+((thf(3)-thin(3))/Tf)*(t-(Tf/(2*pi))*sin((2*pi/Tf)*t));
    dth3_d=((thf(3)-thin(3))/Tf)*(1-cos((2*pi/Tf)*t));
    ddth3_d=(2*pi*(thf(3)-thin(3))/(Tf*Tf))*sin((2*pi/Tf)*t);
    
th4_d=thin(4)+((thf(4)-thin(4))/Tf)*(t-(Tf/(2*pi))*sin((2*pi/Tf)*t));
    dth4_d=((thf(4)-thin(4))/Tf)*(1-cos((2*pi/Tf)*t));
    ddth4_d=(2*pi*(thf(4)-thin(4))/(Tf*Tf))*sin((2*pi/Tf)*t);

th5_d=thin(5)+((thf(5)-thin(5))/Tf)*(t-(Tf/(2*pi))*sin((2*pi/Tf)*t));
    dth5_d=((thf(5)-thin(5))/Tf)*(1-cos((2*pi/Tf)*t));
    ddth5_d=(2*pi*(thf(5)-thin(5))/(Tf*Tf))*sin((2*pi/Tf)*t);

th6_d=thin(6)+((thf(6)-thin(6))/Tf)*(t-(Tf/(2*pi))*sin((2*pi/Tf)*t));
    dth6_d=((thf(6)-thin(6))/Tf)*(1-cos((2*pi/Tf)*t));
    ddth6_d=(2*pi*(thf(6)-thin(6))/(Tf*Tf))*sin((2*pi/Tf)*t);

    th7_d=thin(7)+((thf(7)-thin(7))/Tf)*(t-(Tf/(2*pi))*sin((2*pi/Tf)*t));
    dth7_d=((thf(7)-thin(7))/Tf)*(1-cos((2*pi/Tf)*t));
    ddth7_d=(2*pi*(thf(7)-thin(7))/(Tf*Tf))*sin((2*pi/Tf)*t);
    

% %Velocity
% 
% s1=dthf(1)*Tf/(thf(1)-thin(1));
% a1=3*((-4*s1)+10);
% b1=4*((7*s1)-15);
% c1=5*((-3*s1)+6);
% 
%     dth1_d=((thf(1)-thin(1))/Tf)*((a1*((t/Tf)^2))+(b1*((t/Tf)^3))+(c1*((t/Tf)^4)));
%     th1_d=thin(1)+(thf(1)-thin(1))*(((a1/3)*((t/Tf)^3))+((b1/4)*((t/Tf)^4))+((c1/5)*((t/Tf)^5)));
%    %th1_d=thin(1)+((thf(1)-thin(1))/Tf)*(t-(Tf/(2*pi))*sin((2*pi/Tf)*t));
%     
% s2=dthf(2)*Tf/(thf(2)-thin(2));
% a2=3*((-4*s2)+10);
% b2=4*((7*s2)-15);
% c2=5*((-3*s2)+6);
% 
%     dth2_d=((thf(2)-thin(2))/Tf)*((a2*((t/Tf)^2))+(b2*((t/Tf)^3))+(c2*((t/Tf)^4)));
%     th2_d=thin(2)+(thf(2)-thin(2))*(((a2/3)*((t/Tf)^3))+((b2/4)*((t/Tf)^4))+((c2/5)*((t/Tf)^5)));
%     %th2_d=thin(2)+((thf(2)-thin(2))/Tf)*(t-(Tf/(2*pi))*sin((2*pi/Tf)*t));
% 
% s3=dthf(3)*Tf/(thf(3)-thin(3));
% a3=3*((-4*s3)+10);
% b3=4*((7*s3)-15);
% c3=5*((-3*s3)+6);
% 
%     dth3_d=((thf(3)-thin(3))/Tf)*((a3*((t/Tf)^2))+(b3*((t/Tf)^3))+(c3*((t/Tf)^4)));
%     th3_d=thin(3)+(thf(3)-thin(3))*(((a3/3)*((t/Tf)^3))+((b3/4)*((t/Tf)^4))+((c3/5)*((t/Tf)^5)));
%     %th3_d=thin(3)+((thf(3)-thin(3))/Tf)*(t-(Tf/(2*pi))*sin((2*pi/Tf)*t));
% 
%     
% s4=dthf(4)*Tf/(thf(4)-thin(4));
% a4=3*((-4*s4)+10);
% b4=4*((7*s4)-15);
% c4=5*((-3*s4)+6);
% 
%     dth4_d=((thf(4)-thin(4))/Tf)*((a4*((t/Tf)^2))+(b4*((t/Tf)^3))+(c4*((t/Tf)^4)));
%     %th4_d=thin(4)+(thf(4)-thin(4))*(((a4/3)*((t/Tf)^3))+((b4/4)*((t/Tf)^4))+((c4/5)*((t/Tf)^5)));
%     th4_d=thin(4)+((thf(4)-thin(4))/Tf)*(t-(Tf/(2*pi))*sin((2*pi/Tf)*t));
% 
% s5=dthf(5)*Tf/(thf(5)-thin(5));
% a5=3*((-4*s5)+10);
% b5=4*((7*s5)-15);
% c5=5*((-3*s5)+6);
% 
%     dth5_d=((thf(5)-thin(5))/Tf)*((a5*((t/Tf)^2))+(b5*((t/Tf)^3))+(c5*((t/Tf)^4)));
%     %th5_d=thin(5)+(thf(5)-thin(5))*(((a5/3)*((t/Tf)^3))+((b5/4)*((t/Tf)^4))+((c5/5)*((t/Tf)^5)));
%     th5_d=thin(5)+((thf(5)-thin(5))/Tf)*(t-(Tf/(2*pi))*sin((2*pi/Tf)*t));
%   
% s6=dthf(6)*Tf/(thf(6)-thin(6));
% a6=3*((-4*s6)+10);
% b6=4*((7*s6)-15);
% c6=5*((-3*s6)+6);
% 
%     dth6_d=((thf(6)-thin(6))/Tf)*((a6*((t/Tf)^2))+(b6*((t/Tf)^3))+(c6*((t/Tf)^4)));
%     %th6_d=thin(6)+(thf(6)-thin(6))*(((a6/3)*((t/Tf)^3))+((b6/4)*((t/Tf)^4))+((c6/5)*((t/Tf)^5)));
%     th6_d=thin(6)+((thf(6)-thin(6))/Tf)*(t-(Tf/(2*pi))*sin((2*pi/Tf)*t));
% 
% s7=dthf(7)*Tf/(thf(7)-thin(7));
% a7=3*((-4*s7)+10);
% b7=4*((7*s7)-15);
% c7=5*((-3*s7)+6);
% 
%     dth7_d=((thf(7)-thin(7))/Tf)*((a7*((t/Tf)^2))+(b7*((t/Tf)^3))+(c7*((t/Tf)^4)));
%     %th7_d=thin(7)+(thf(7)-thin(7))*(((a7/3)*((t/Tf)^3))+((b7/4)*((t/Tf)^4))+((c7/5)*((t/Tf)^5)));
%     th7_d=thin(7)+((thf(7)-thin(7))/Tf)*(t-(Tf/(2*pi))*sin((2*pi/Tf)*t));
%   
%ddth1_d=0;ddth2_d=0;ddth3_d=0;ddth4_d=0;ddth5_d=0;ddth6_d=0;

    kp=49; kd=14;

tau1=-kp*(th1-th1_d)-kd*(dth1-dth1_d);  
tau2=-kp*(th2-th2_d)-kd*(dth2-dth2_d);
tau3=-kp*(th3-th3_d)-kd*(dth3-dth3_d);
tau4=-kp*(th4-th4_d)-kd*(dth4-dth4_d);  
tau5=-kp*(th5-th5_d)-kd*(dth5-dth5_d);
tau6=-kp*(th6-th6_d)-kd*(dth6-dth6_d);
tau7=0%-kp*(th7-th7_d)-kd*(dth7-dth7_d);

F=[fx0; fy0; tau0; tau1; tau2; tau3; tau4; tau5; tau6; tau7];


I =[                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  m0 + m1 + m2 + m3 + m4 + m5 + m6 + m7,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                lc0*m4*sin(th0) - lc0*m2*sin(th0) - lc0*m3*sin(th0) - lc0*m1*sin(th0) + lc0*m5*sin(th0) + lc0*m6*sin(th0) + lc0*m7*sin(th0) - lc7*m7*sin(th0 + th4 + th5 + th6 + th7) - l2*m3*sin(th0 + th1 + th2) - l5*m6*sin(th0 + th4 + th5) - l5*m7*sin(th0 + th4 + th5) - lc2*m2*sin(th0 + th1 + th2) - lc5*m5*sin(th0 + th4 + th5) - l6*m7*sin(th0 + th4 + th5 + th6) - lc3*m3*sin(th0 + th1 + th2 + th3) - lc6*m6*sin(th0 + th4 + th5 + th6) - l1*m2*sin(th0 + th1) - l1*m3*sin(th0 + th1) - l4*m5*sin(th0 + th4) - l4*m6*sin(th0 + th4) - l4*m7*sin(th0 + th4) - lc1*m1*sin(th0 + th1) - lc4*m4*sin(th0 + th4),                                                                                                                                                           - (m3*(2*lc3*sin(th0 + th1 + th2 + th3) + 2*l1*sin(th0 + th1) + 2*l2*sin(th0 + th1 + th2)))/2 - (m2*(2*l1*sin(th0 + th1) + 2*lc2*sin(th0 + th1 + th2)))/2 - lc1*m1*sin(th0 + th1),                                                                                                                           - (m3*(2*lc3*sin(th0 + th1 + th2 + th3) + 2*l2*sin(th0 + th1 + th2)))/2 - lc2*m2*sin(th0 + th1 + th2),                                                                -lc3*m3*sin(th0 + th1 + th2 + th3),                                                                                                                                                                                                                                                                                                                                                             - (m7*(2*l6*sin(th0 + th4 + th5 + th6) + 2*l4*sin(th0 + th4) + 2*lc7*sin(th0 + th4 + th5 + th6 + th7) + 2*l5*sin(th0 + th4 + th5)))/2 - (m6*(2*lc6*sin(th0 + th4 + th5 + th6) + 2*l4*sin(th0 + th4) + 2*l5*sin(th0 + th4 + th5)))/2 - (m5*(2*l4*sin(th0 + th4) + 2*lc5*sin(th0 + th4 + th5)))/2 - lc4*m4*sin(th0 + th4),                                                                                                                                                                                                                                                                                                              - (m7*(2*l6*sin(th0 + th4 + th5 + th6) + 2*lc7*sin(th0 + th4 + th5 + th6 + th7) + 2*l5*sin(th0 + th4 + th5)))/2 - (m6*(2*lc6*sin(th0 + th4 + th5 + th6) + 2*l5*sin(th0 + th4 + th5)))/2 - lc5*m5*sin(th0 + th4 + th5),                                                                                                                                                                                                                         - m7*(l6*sin(th0 + th4 + th5 + th6) + lc7*sin(th0 + th4 + th5 + th6 + th7)) - lc6*m6*sin(th0 + th4 + th5 + th6),                                                                                                 -lc7*m7*sin(th0 + th4 + th5 + th6 + th7)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  m0 + m1 + m2 + m3 + m4 + m5 + m6 + m7,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                lc0*m1*cos(th0) + lc0*m2*cos(th0) + lc0*m3*cos(th0) - lc0*m4*cos(th0) - lc0*m5*cos(th0) - lc0*m6*cos(th0) - lc0*m7*cos(th0) + lc7*m7*cos(th0 + th4 + th5 + th6 + th7) + l2*m3*cos(th0 + th1 + th2) + l5*m6*cos(th0 + th4 + th5) + l5*m7*cos(th0 + th4 + th5) + lc2*m2*cos(th0 + th1 + th2) + lc5*m5*cos(th0 + th4 + th5) + l6*m7*cos(th0 + th4 + th5 + th6) + lc3*m3*cos(th0 + th1 + th2 + th3) + lc6*m6*cos(th0 + th4 + th5 + th6) + l1*m2*cos(th0 + th1) + l1*m3*cos(th0 + th1) + l4*m5*cos(th0 + th4) + l4*m6*cos(th0 + th4) + l4*m7*cos(th0 + th4) + lc1*m1*cos(th0 + th1) + lc4*m4*cos(th0 + th4),                                                                                                                                                             (m2*(2*l1*cos(th0 + th1) + 2*lc2*cos(th0 + th1 + th2)))/2 + (m3*(2*lc3*cos(th0 + th1 + th2 + th3) + 2*l1*cos(th0 + th1) + 2*l2*cos(th0 + th1 + th2)))/2 + lc1*m1*cos(th0 + th1),                                                                                                                             (m3*(2*lc3*cos(th0 + th1 + th2 + th3) + 2*l2*cos(th0 + th1 + th2)))/2 + lc2*m2*cos(th0 + th1 + th2),                                                                 lc3*m3*cos(th0 + th1 + th2 + th3),                                                                                                                                                                                                                                                                                                                                                               (m5*(2*l4*cos(th0 + th4) + 2*lc5*cos(th0 + th4 + th5)))/2 + (m7*(2*l6*cos(th0 + th4 + th5 + th6) + 2*l4*cos(th0 + th4) + 2*lc7*cos(th0 + th4 + th5 + th6 + th7) + 2*l5*cos(th0 + th4 + th5)))/2 + (m6*(2*lc6*cos(th0 + th4 + th5 + th6) + 2*l4*cos(th0 + th4) + 2*l5*cos(th0 + th4 + th5)))/2 + lc4*m4*cos(th0 + th4),                                                                                                                                                                                                                                                                                                                (m7*(2*l6*cos(th0 + th4 + th5 + th6) + 2*lc7*cos(th0 + th4 + th5 + th6 + th7) + 2*l5*cos(th0 + th4 + th5)))/2 + (m6*(2*lc6*cos(th0 + th4 + th5 + th6) + 2*l5*cos(th0 + th4 + th5)))/2 + lc5*m5*cos(th0 + th4 + th5),                                                                                                                                                                                                                   (m7*(2*l6*cos(th0 + th4 + th5 + th6) + 2*lc7*cos(th0 + th4 + th5 + th6 + th7)))/2 + lc6*m6*cos(th0 + th4 + th5 + th6),                                                                                                  lc7*m7*cos(th0 + th4 + th5 + th6 + th7)
 lc0*m4*sin(th0) - lc0*m2*sin(th0) - lc0*m3*sin(th0) - lc0*m1*sin(th0) + lc0*m5*sin(th0) + lc0*m6*sin(th0) + lc0*m7*sin(th0) - lc7*m7*sin(th0 + th4 + th5 + th6 + th7) - l2*m3*sin(th0 + th1 + th2) - l5*m6*sin(th0 + th4 + th5) - l5*m7*sin(th0 + th4 + th5) - lc2*m2*sin(th0 + th1 + th2) - lc5*m5*sin(th0 + th4 + th5) - l6*m7*sin(th0 + th4 + th5 + th6) - lc3*m3*sin(th0 + th1 + th2 + th3) - lc6*m6*sin(th0 + th4 + th5 + th6) - l1*m2*sin(th0 + th1) - l1*m3*sin(th0 + th1) - l4*m5*sin(th0 + th4) - l4*m6*sin(th0 + th4) - l4*m7*sin(th0 + th4) - lc1*m1*sin(th0 + th1) - lc4*m4*sin(th0 + th4), lc0*m1*cos(th0) + lc0*m2*cos(th0) + lc0*m3*cos(th0) - lc0*m4*cos(th0) - lc0*m5*cos(th0) - lc0*m6*cos(th0) - lc0*m7*cos(th0) + lc7*m7*cos(th0 + th4 + th5 + th6 + th7) + l2*m3*cos(th0 + th1 + th2) + l5*m6*cos(th0 + th4 + th5) + l5*m7*cos(th0 + th4 + th5) + lc2*m2*cos(th0 + th1 + th2) + lc5*m5*cos(th0 + th4 + th5) + l6*m7*cos(th0 + th4 + th5 + th6) + lc3*m3*cos(th0 + th1 + th2 + th3) + lc6*m6*cos(th0 + th4 + th5 + th6) + l1*m2*cos(th0 + th1) + l1*m3*cos(th0 + th1) + l4*m5*cos(th0 + th4) + l4*m6*cos(th0 + th4) + l4*m7*cos(th0 + th4) + lc1*m1*cos(th0 + th1) + lc4*m4*cos(th0 + th4), Izz0 + Izz1 + Izz2 + Izz3 + Izz4 + Izz5 + Izz6 + Izz7 + l1^2*m2 + l1^2*m3 + l2^2*m3 + l4^2*m5 + l4^2*m6 + l4^2*m7 + l5^2*m6 + l5^2*m7 + l6^2*m7 + lc0^2*m1 + lc1^2*m1 + lc0^2*m2 + lc2^2*m2 + lc0^2*m3 + lc3^2*m3 + lc0^2*m4 + lc4^2*m4 + lc0^2*m5 + lc5^2*m5 + lc0^2*m6 + lc6^2*m6 + lc0^2*m7 + lc7^2*m7 - 2*lc0*lc7*m7*cos(th4 + th5 + th6 + th7) + 2*l4*l6*m7*cos(th5 + th6) + 2*l1*lc3*m3*cos(th2 + th3) + 2*l2*lc0*m3*cos(th1 + th2) + 2*l4*lc6*m6*cos(th5 + th6) - 2*l5*lc0*m6*cos(th4 + th5) - 2*l5*lc0*m7*cos(th4 + th5) + 2*l5*lc7*m7*cos(th6 + th7) + 2*lc0*lc2*m2*cos(th1 + th2) - 2*lc0*lc5*m5*cos(th4 + th5) + 2*l1*l2*m3*cos(th2) + 2*l4*l5*m6*cos(th5) + 2*l4*l5*m7*cos(th5) + 2*l5*l6*m7*cos(th6) + 2*l1*lc0*m2*cos(th1) + 2*l1*lc2*m2*cos(th2) + 2*l1*lc0*m3*cos(th1) + 2*l2*lc3*m3*cos(th3) - 2*l4*lc0*m5*cos(th4) + 2*l4*lc5*m5*cos(th5) - 2*l4*lc0*m6*cos(th4) - 2*l4*lc0*m7*cos(th4) + 2*l5*lc6*m6*cos(th6) + 2*l6*lc7*m7*cos(th7) + 2*lc0*lc1*m1*cos(th1) - 2*lc0*lc4*m4*cos(th4) + 2*l4*lc7*m7*cos(th5 + th6 + th7) - 2*l6*lc0*m7*cos(th4 + th5 + th6) + 2*lc0*lc3*m3*cos(th1 + th2 + th3) - 2*lc0*lc6*m6*cos(th4 + th5 + th6), Izz1 + Izz2 + Izz3 + l1^2*m2 + l1^2*m3 + l2^2*m3 + lc1^2*m1 + lc2^2*m2 + lc3^2*m3 + 2*l1*lc3*m3*cos(th2 + th3) + l2*lc0*m3*cos(th1 + th2) + lc0*lc2*m2*cos(th1 + th2) + 2*l1*l2*m3*cos(th2) + l1*lc0*m2*cos(th1) + 2*l1*lc2*m2*cos(th2) + l1*lc0*m3*cos(th1) + 2*l2*lc3*m3*cos(th3) + lc0*lc1*m1*cos(th1) + lc0*lc3*m3*cos(th1 + th2 + th3), Izz2 + Izz3 + l2^2*m3 + lc2^2*m2 + lc3^2*m3 + l1*lc3*m3*cos(th2 + th3) + l2*lc0*m3*cos(th1 + th2) + lc0*lc2*m2*cos(th1 + th2) + l1*l2*m3*cos(th2) + l1*lc2*m2*cos(th2) + 2*l2*lc3*m3*cos(th3) + lc0*lc3*m3*cos(th1 + th2 + th3), Izz3 + lc3^2*m3 + l1*lc3*m3*cos(th2 + th3) + l2*lc3*m3*cos(th3) + lc0*lc3*m3*cos(th1 + th2 + th3), Izz4 + Izz5 + Izz6 + Izz7 + l4^2*m5 + l4^2*m6 + l4^2*m7 + l5^2*m6 + l5^2*m7 + l6^2*m7 + lc4^2*m4 + lc5^2*m5 + lc6^2*m6 + lc7^2*m7 - lc0*lc7*m7*cos(th4 + th5 + th6 + th7) + 2*l4*l6*m7*cos(th5 + th6) + 2*l4*lc6*m6*cos(th5 + th6) - l5*lc0*m6*cos(th4 + th5) - l5*lc0*m7*cos(th4 + th5) + 2*l5*lc7*m7*cos(th6 + th7) - lc0*lc5*m5*cos(th4 + th5) + 2*l4*l5*m6*cos(th5) + 2*l4*l5*m7*cos(th5) + 2*l5*l6*m7*cos(th6) - l4*lc0*m5*cos(th4) + 2*l4*lc5*m5*cos(th5) - l4*lc0*m6*cos(th4) - l4*lc0*m7*cos(th4) + 2*l5*lc6*m6*cos(th6) + 2*l6*lc7*m7*cos(th7) - lc0*lc4*m4*cos(th4) + 2*l4*lc7*m7*cos(th5 + th6 + th7) - l6*lc0*m7*cos(th4 + th5 + th6) - lc0*lc6*m6*cos(th4 + th5 + th6), Izz5 + Izz6 + Izz7 + l5^2*m6 + l5^2*m7 + l6^2*m7 + lc5^2*m5 + lc6^2*m6 + lc7^2*m7 - lc0*lc7*m7*cos(th4 + th5 + th6 + th7) + l4*l6*m7*cos(th5 + th6) + l4*lc6*m6*cos(th5 + th6) - l5*lc0*m6*cos(th4 + th5) - l5*lc0*m7*cos(th4 + th5) + 2*l5*lc7*m7*cos(th6 + th7) - lc0*lc5*m5*cos(th4 + th5) + l4*l5*m6*cos(th5) + l4*l5*m7*cos(th5) + 2*l5*l6*m7*cos(th6) + l4*lc5*m5*cos(th5) + 2*l5*lc6*m6*cos(th6) + 2*l6*lc7*m7*cos(th7) + l4*lc7*m7*cos(th5 + th6 + th7) - l6*lc0*m7*cos(th4 + th5 + th6) - lc0*lc6*m6*cos(th4 + th5 + th6), Izz6 + Izz7 + l6^2*m7 + lc6^2*m6 + lc7^2*m7 - lc0*lc7*m7*cos(th4 + th5 + th6 + th7) + l4*l6*m7*cos(th5 + th6) + l4*lc6*m6*cos(th5 + th6) + l5*lc7*m7*cos(th6 + th7) + l5*l6*m7*cos(th6) + l5*lc6*m6*cos(th6) + 2*l6*lc7*m7*cos(th7) + l4*lc7*m7*cos(th5 + th6 + th7) - l6*lc0*m7*cos(th4 + th5 + th6) - lc0*lc6*m6*cos(th4 + th5 + th6), Izz7 + lc7^2*m7 - lc0*lc7*m7*cos(th4 + th5 + th6 + th7) + l5*lc7*m7*cos(th6 + th7) + l6*lc7*m7*cos(th7) + l4*lc7*m7*cos(th5 + th6 + th7)
                                                                                                                                                                                                                                                                                                                                                                                                                                        - m3*(lc3*sin(th0 + th1 + th2 + th3) + l1*sin(th0 + th1) + l2*sin(th0 + th1 + th2)) - m2*(l1*sin(th0 + th1) + lc2*sin(th0 + th1 + th2)) - lc1*m1*sin(th0 + th1),                                                                                                                                                                                                                                                                                                                                                                                                                                          m2*(l1*cos(th0 + th1) + lc2*cos(th0 + th1 + th2)) + m3*(lc3*cos(th0 + th1 + th2 + th3) + l1*cos(th0 + th1) + l2*cos(th0 + th1 + th2)) + lc1*m1*cos(th0 + th1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           Izz1 + Izz2 + Izz3 + l1^2*m2 + l1^2*m3 + l2^2*m3 + lc1^2*m1 + lc2^2*m2 + lc3^2*m3 + 2*l1*lc3*m3*cos(th2 + th3) + l2*lc0*m3*cos(th1 + th2) + lc0*lc2*m2*cos(th1 + th2) + 2*l1*l2*m3*cos(th2) + l1*lc0*m2*cos(th1) + 2*l1*lc2*m2*cos(th2) + l1*lc0*m3*cos(th1) + 2*l2*lc3*m3*cos(th3) + lc0*lc1*m1*cos(th1) + lc0*lc3*m3*cos(th1 + th2 + th3),                                                                                                                                                          Izz1 + Izz2 + Izz3 + l1^2*m2 + l1^2*m3 + l2^2*m3 + lc1^2*m1 + lc2^2*m2 + lc3^2*m3 + 2*l1*lc3*m3*cos(th2 + th3) + 2*l1*l2*m3*cos(th2) + 2*l1*lc2*m2*cos(th2) + 2*l2*lc3*m3*cos(th3),                                                                                          m3*l2^2 + 2*m3*cos(th3)*l2*lc3 + l1*m3*cos(th2)*l2 + m2*lc2^2 + l1*m2*cos(th2)*lc2 + m3*lc3^2 + l1*m3*cos(th2 + th3)*lc3 + Izz2 + Izz3,                                   Izz3 + lc3^2*m3 + l1*lc3*m3*cos(th2 + th3) + l2*lc3*m3*cos(th3),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                       0,                                                                                                                                        0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          - m3*(lc3*sin(th0 + th1 + th2 + th3) + l2*sin(th0 + th1 + th2)) - lc2*m2*sin(th0 + th1 + th2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            m3*(lc3*cos(th0 + th1 + th2 + th3) + l2*cos(th0 + th1 + th2)) + lc2*m2*cos(th0 + th1 + th2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       Izz2 + Izz3 + l2^2*m3 + lc2^2*m2 + lc3^2*m3 + l1*lc3*m3*cos(th2 + th3) + l2*lc0*m3*cos(th1 + th2) + lc0*lc2*m2*cos(th1 + th2) + l1*l2*m3*cos(th2) + l1*lc2*m2*cos(th2) + 2*l2*lc3*m3*cos(th3) + lc0*lc3*m3*cos(th1 + th2 + th3),                                                                                                                                                                                                      m3*l2^2 + 2*m3*cos(th3)*l2*lc3 + l1*m3*cos(th2)*l2 + m2*lc2^2 + l1*m2*cos(th2)*lc2 + m3*lc3^2 + l1*m3*cos(th2 + th3)*lc3 + Izz2 + Izz3,                                                                                                                                                              m3*l2^2 + 2*m3*cos(th3)*l2*lc3 + m2*lc2^2 + m3*lc3^2 + Izz2 + Izz3,                                                              m3*lc3^2 + l2*m3*cos(th3)*lc3 + Izz3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                       0,                                                                                                                                        0
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     -lc3*m3*sin(th0 + th1 + th2 + th3),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      lc3*m3*cos(th0 + th1 + th2 + th3),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     Izz3 + lc3^2*m3 + l1*lc3*m3*cos(th2 + th3) + l2*lc3*m3*cos(th3) + lc0*lc3*m3*cos(th1 + th2 + th3),                                                                                                                                                                                                                                                                             Izz3 + lc3^2*m3 + l1*lc3*m3*cos(th2 + th3) + l2*lc3*m3*cos(th3),                                                                                                                                                                                            m3*lc3^2 + l2*m3*cos(th3)*lc3 + Izz3,                                                                                   m3*lc3^2 + Izz3,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  0,                                                                                                                                                                                                                                                                                                                                       0,                                                                                                                                        0
                                                                                                                                                                                                                                                                                                              - m7*(l6*sin(th0 + th4 + th5 + th6) + l4*sin(th0 + th4) + lc7*sin(th0 + th4 + th5 + th6 + th7) + l5*sin(th0 + th4 + th5)) - m6*(lc6*sin(th0 + th4 + th5 + th6) + l4*sin(th0 + th4) + l5*sin(th0 + th4 + th5)) - m5*(l4*sin(th0 + th4) + lc5*sin(th0 + th4 + th5)) - lc4*m4*sin(th0 + th4),                                                                                                                                                                                                                                                                                                                m5*(l4*cos(th0 + th4) + lc5*cos(th0 + th4 + th5)) + m7*(l6*cos(th0 + th4 + th5 + th6) + l4*cos(th0 + th4) + lc7*cos(th0 + th4 + th5 + th6 + th7) + l5*cos(th0 + th4 + th5)) + m6*(lc6*cos(th0 + th4 + th5 + th6) + l4*cos(th0 + th4) + l5*cos(th0 + th4 + th5)) + lc4*m4*cos(th0 + th4),                                                                                                                                                                                                                                                                                                                                                                                                                                                                   Izz4 + Izz5 + Izz6 + Izz7 + l4^2*m5 + l4^2*m6 + l4^2*m7 + l5^2*m6 + l5^2*m7 + l6^2*m7 + lc4^2*m4 + lc5^2*m5 + lc6^2*m6 + lc7^2*m7 - lc0*lc7*m7*cos(th4 + th5 + th6 + th7) + 2*l4*l6*m7*cos(th5 + th6) + 2*l4*lc6*m6*cos(th5 + th6) - l5*lc0*m6*cos(th4 + th5) - l5*lc0*m7*cos(th4 + th5) + 2*l5*lc7*m7*cos(th6 + th7) - lc0*lc5*m5*cos(th4 + th5) + 2*l4*l5*m6*cos(th5) + 2*l4*l5*m7*cos(th5) + 2*l5*l6*m7*cos(th6) - l4*lc0*m5*cos(th4) + 2*l4*lc5*m5*cos(th5) - l4*lc0*m6*cos(th4) - l4*lc0*m7*cos(th4) + 2*l5*lc6*m6*cos(th6) + 2*l6*lc7*m7*cos(th7) - lc0*lc4*m4*cos(th4) + 2*l4*lc7*m7*cos(th5 + th6 + th7) - l6*lc0*m7*cos(th4 + th5 + th6) - lc0*lc6*m6*cos(th4 + th5 + th6),                                                                                                                                                                                                                                                                                                                                           0,                                                                                                                                                                                                                               0,                                                                                                 0,                                                                                                                                                                                                                                                                                   Izz4 + Izz5 + Izz6 + Izz7 + l4^2*m5 + l4^2*m6 + l4^2*m7 + l5^2*m6 + l5^2*m7 + l6^2*m7 + lc4^2*m4 + lc5^2*m5 + lc6^2*m6 + lc7^2*m7 + 2*l4*l6*m7*cos(th5 + th6) + 2*l4*lc6*m6*cos(th5 + th6) + 2*l5*lc7*m7*cos(th6 + th7) + 2*l4*l5*m6*cos(th5) + 2*l4*l5*m7*cos(th5) + 2*l5*l6*m7*cos(th6) + 2*l4*lc5*m5*cos(th5) + 2*l5*lc6*m6*cos(th6) + 2*l6*lc7*m7*cos(th7) + 2*l4*lc7*m7*cos(th5 + th6 + th7),                                                                                                                                                                                              Izz5 + Izz6 + Izz7 + l5^2*m6 + l5^2*m7 + l6^2*m7 + lc5^2*m5 + lc6^2*m6 + lc7^2*m7 + l4*l6*m7*cos(th5 + th6) + l4*lc6*m6*cos(th5 + th6) + 2*l5*lc7*m7*cos(th6 + th7) + l4*l5*m6*cos(th5) + l4*l5*m7*cos(th5) + 2*l5*l6*m7*cos(th6) + l4*lc5*m5*cos(th5) + 2*l5*lc6*m6*cos(th6) + 2*l6*lc7*m7*cos(th7) + l4*lc7*m7*cos(th5 + th6 + th7),                                                                                                            Izz6 + Izz7 + l6^2*m7 + lc6^2*m6 + lc7^2*m7 + l4*l6*m7*cos(th5 + th6) + l4*lc6*m6*cos(th5 + th6) + l5*lc7*m7*cos(th6 + th7) + l5*l6*m7*cos(th6) + l5*lc6*m6*cos(th6) + 2*l6*lc7*m7*cos(th7) + l4*lc7*m7*cos(th5 + th6 + th7),                                         Izz7 + lc7^2*m7 + l5*lc7*m7*cos(th6 + th7) + l6*lc7*m7*cos(th7) + l4*lc7*m7*cos(th5 + th6 + th7)
                                                                                                                                                                                                                                                                                                                                                                                                    - m7*(l6*sin(th0 + th4 + th5 + th6) + lc7*sin(th0 + th4 + th5 + th6 + th7) + l5*sin(th0 + th4 + th5)) - m6*(lc6*sin(th0 + th4 + th5 + th6) + l5*sin(th0 + th4 + th5)) - lc5*m5*sin(th0 + th4 + th5),                                                                                                                                                                                                                                                                                                                                                                                                      m7*(l6*cos(th0 + th4 + th5 + th6) + lc7*cos(th0 + th4 + th5 + th6 + th7) + l5*cos(th0 + th4 + th5)) + m6*(lc6*cos(th0 + th4 + th5 + th6) + l5*cos(th0 + th4 + th5)) + lc5*m5*cos(th0 + th4 + th5),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Izz5 + Izz6 + Izz7 + l5^2*m6 + l5^2*m7 + l6^2*m7 + lc5^2*m5 + lc6^2*m6 + lc7^2*m7 - lc0*lc7*m7*cos(th4 + th5 + th6 + th7) + l4*l6*m7*cos(th5 + th6) + l4*lc6*m6*cos(th5 + th6) - l5*lc0*m6*cos(th4 + th5) - l5*lc0*m7*cos(th4 + th5) + 2*l5*lc7*m7*cos(th6 + th7) - lc0*lc5*m5*cos(th4 + th5) + l4*l5*m6*cos(th5) + l4*l5*m7*cos(th5) + 2*l5*l6*m7*cos(th6) + l4*lc5*m5*cos(th5) + 2*l5*lc6*m6*cos(th6) + 2*l6*lc7*m7*cos(th7) + l4*lc7*m7*cos(th5 + th6 + th7) - l6*lc0*m7*cos(th4 + th5 + th6) - lc0*lc6*m6*cos(th4 + th5 + th6),                                                                                                                                                                                                                                                                                                                                           0,                                                                                                                                                                                                                               0,                                                                                                 0,                                                                                                                                                                                                                                                                                                                                               Izz5 + Izz6 + Izz7 + l5^2*m6 + l5^2*m7 + l6^2*m7 + lc5^2*m5 + lc6^2*m6 + lc7^2*m7 + l4*l6*m7*cos(th5 + th6) + l4*lc6*m6*cos(th5 + th6) + 2*l5*lc7*m7*cos(th6 + th7) + l4*l5*m6*cos(th5) + l4*l5*m7*cos(th5) + 2*l5*l6*m7*cos(th6) + l4*lc5*m5*cos(th5) + 2*l5*lc6*m6*cos(th6) + 2*l6*lc7*m7*cos(th7) + l4*lc7*m7*cos(th5 + th6 + th7),                                                                                                                                                                                                                                                                                                                                                 Izz5 + Izz6 + Izz7 + l5^2*m6 + l5^2*m7 + l6^2*m7 + lc5^2*m5 + lc6^2*m6 + lc7^2*m7 + 2*l5*lc7*m7*cos(th6 + th7) + 2*l5*l6*m7*cos(th6) + 2*l5*lc6*m6*cos(th6) + 2*l6*lc7*m7*cos(th7),                                                                                                                                                                                                  m7*l6^2 + 2*m7*cos(th7)*l6*lc7 + l5*m7*cos(th6)*l6 + m6*lc6^2 + l5*m6*cos(th6)*lc6 + m7*lc7^2 + l5*m7*cos(th6 + th7)*lc7 + Izz6 + Izz7,                                                                          Izz7 + lc7^2*m7 + l5*lc7*m7*cos(th6 + th7) + l6*lc7*m7*cos(th7)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        - m7*(l6*sin(th0 + th4 + th5 + th6) + lc7*sin(th0 + th4 + th5 + th6 + th7)) - lc6*m6*sin(th0 + th4 + th5 + th6),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          m7*(l6*cos(th0 + th4 + th5 + th6) + lc7*cos(th0 + th4 + th5 + th6 + th7)) + lc6*m6*cos(th0 + th4 + th5 + th6),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               Izz6 + Izz7 + l6^2*m7 + lc6^2*m6 + lc7^2*m7 - lc0*lc7*m7*cos(th4 + th5 + th6 + th7) + l4*l6*m7*cos(th5 + th6) + l4*lc6*m6*cos(th5 + th6) + l5*lc7*m7*cos(th6 + th7) + l5*l6*m7*cos(th6) + l5*lc6*m6*cos(th6) + 2*l6*lc7*m7*cos(th7) + l4*lc7*m7*cos(th5 + th6 + th7) - l6*lc0*m7*cos(th4 + th5 + th6) - lc0*lc6*m6*cos(th4 + th5 + th6),                                                                                                                                                                                                                                                                                                                                           0,                                                                                                                                                                                                                               0,                                                                                                 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                        Izz6 + Izz7 + l6^2*m7 + lc6^2*m6 + lc7^2*m7 + l4*l6*m7*cos(th5 + th6) + l4*lc6*m6*cos(th5 + th6) + l5*lc7*m7*cos(th6 + th7) + l5*l6*m7*cos(th6) + l5*lc6*m6*cos(th6) + 2*l6*lc7*m7*cos(th7) + l4*lc7*m7*cos(th5 + th6 + th7),                                                                                                                                                                                                                                                                                                                                                                                             m7*l6^2 + 2*m7*cos(th7)*l6*lc7 + l5*m7*cos(th6)*l6 + m6*lc6^2 + l5*m6*cos(th6)*lc6 + m7*lc7^2 + l5*m7*cos(th6 + th7)*lc7 + Izz6 + Izz7,                                                                                                                                                                                                                                                                      m7*l6^2 + 2*m7*cos(th7)*l6*lc7 + m6*lc6^2 + m7*lc7^2 + Izz6 + Izz7,                                                                                                     m7*lc7^2 + l6*m7*cos(th7)*lc7 + Izz7
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               -lc7*m7*sin(th0 + th4 + th5 + th6 + th7),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                lc7*m7*cos(th0 + th4 + th5 + th6 + th7),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              Izz7 + lc7^2*m7 - lc0*lc7*m7*cos(th4 + th5 + th6 + th7) + l5*lc7*m7*cos(th6 + th7) + l6*lc7*m7*cos(th7) + l4*lc7*m7*cos(th5 + th6 + th7),                                                                                                                                                                                                                                                                                                                                           0,                                                                                                                                                                                                                               0,                                                                                                 0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Izz7 + lc7^2*m7 + l5*lc7*m7*cos(th6 + th7) + l6*lc7*m7*cos(th7) + l4*lc7*m7*cos(th5 + th6 + th7),                                                                                                                                                                                                                                                                                                                                                                                                                                                                    Izz7 + lc7^2*m7 + l5*lc7*m7*cos(th6 + th7) + l6*lc7*m7*cos(th7),                                                                                                                                                                                                                                                                                                    m7*lc7^2 + l6*m7*cos(th7)*lc7 + Izz7,                                                                                                                          m7*lc7^2 + Izz7]
 
 
C =[                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             dth0^2*lc0*m4*cos(th0) - dth4^2*lc7*m7*cos(th0 + th4 + th5 + th6 + th7) - dth5^2*lc7*m7*cos(th0 + th4 + th5 + th6 + th7) - dth6^2*lc7*m7*cos(th0 + th4 + th5 + th6 + th7) - dth7^2*lc7*m7*cos(th0 + th4 + th5 + th6 + th7) - dth0^2*l2*m3*cos(th0 + th1 + th2) - dth1^2*l2*m3*cos(th0 + th1 + th2) - dth2^2*l2*m3*cos(th0 + th1 + th2) - dth0^2*l5*m6*cos(th0 + th4 + th5) - dth4^2*l5*m6*cos(th0 + th4 + th5) - dth5^2*l5*m6*cos(th0 + th4 + th5) - dth0^2*l5*m7*cos(th0 + th4 + th5) - dth4^2*l5*m7*cos(th0 + th4 + th5) - dth5^2*l5*m7*cos(th0 + th4 + th5) - dth0^2*lc2*m2*cos(th0 + th1 + th2) - dth1^2*lc2*m2*cos(th0 + th1 + th2) - dth2^2*lc2*m2*cos(th0 + th1 + th2) - dth0^2*lc5*m5*cos(th0 + th4 + th5) - dth4^2*lc5*m5*cos(th0 + th4 + th5) - dth5^2*lc5*m5*cos(th0 + th4 + th5) - dth0^2*l6*m7*cos(th0 + th4 + th5 + th6) - dth4^2*l6*m7*cos(th0 + th4 + th5 + th6) - dth5^2*l6*m7*cos(th0 + th4 + th5 + th6) - dth6^2*l6*m7*cos(th0 + th4 + th5 + th6) - dth0^2*lc3*m3*cos(th0 + th1 + th2 + th3) - dth1^2*lc3*m3*cos(th0 + th1 + th2 + th3) - dth2^2*lc3*m3*cos(th0 + th1 + th2 + th3) - dth3^2*lc3*m3*cos(th0 + th1 + th2 + th3) - dth0^2*lc6*m6*cos(th0 + th4 + th5 + th6) - dth4^2*lc6*m6*cos(th0 + th4 + th5 + th6) - dth5^2*lc6*m6*cos(th0 + th4 + th5 + th6) - dth6^2*lc6*m6*cos(th0 + th4 + th5 + th6) - dth0^2*l1*m2*cos(th0 + th1) - dth1^2*l1*m2*cos(th0 + th1) - dth0^2*l1*m3*cos(th0 + th1) - dth1^2*l1*m3*cos(th0 + th1) - dth0^2*l4*m5*cos(th0 + th4) - dth4^2*l4*m5*cos(th0 + th4) - dth0^2*l4*m6*cos(th0 + th4) - dth4^2*l4*m6*cos(th0 + th4) - dth0^2*l4*m7*cos(th0 + th4) - dth4^2*l4*m7*cos(th0 + th4) - dth0^2*lc1*m1*cos(th0 + th1) - dth1^2*lc1*m1*cos(th0 + th1) - dth0^2*lc4*m4*cos(th0 + th4) - dth4^2*lc4*m4*cos(th0 + th4) - dth0^2*lc0*m1*cos(th0) - dth0^2*lc0*m2*cos(th0) - dth0^2*lc0*m3*cos(th0) - dth0^2*lc7*m7*cos(th0 + th4 + th5 + th6 + th7) + dth0^2*lc0*m5*cos(th0) + dth0^2*lc0*m6*cos(th0) + dth0^2*lc0*m7*cos(th0) - 2*dth0*dth4*lc7*m7*cos(th0 + th4 + th5 + th6 + th7) - 2*dth0*dth5*lc7*m7*cos(th0 + th4 + th5 + th6 + th7) - 2*dth0*dth6*lc7*m7*cos(th0 + th4 + th5 + th6 + th7) - 2*dth0*dth7*lc7*m7*cos(th0 + th4 + th5 + th6 + th7) - 2*dth4*dth5*lc7*m7*cos(th0 + th4 + th5 + th6 + th7) - 2*dth4*dth6*lc7*m7*cos(th0 + th4 + th5 + th6 + th7) - 2*dth4*dth7*lc7*m7*cos(th0 + th4 + th5 + th6 + th7) - 2*dth5*dth6*lc7*m7*cos(th0 + th4 + th5 + th6 + th7) - 2*dth5*dth7*lc7*m7*cos(th0 + th4 + th5 + th6 + th7) - 2*dth6*dth7*lc7*m7*cos(th0 + th4 + th5 + th6 + th7) - 2*dth0*dth1*l2*m3*cos(th0 + th1 + th2) - 2*dth0*dth2*l2*m3*cos(th0 + th1 + th2) - 2*dth1*dth2*l2*m3*cos(th0 + th1 + th2) - 2*dth0*dth4*l5*m6*cos(th0 + th4 + th5) - 2*dth0*dth5*l5*m6*cos(th0 + th4 + th5) - 2*dth4*dth5*l5*m6*cos(th0 + th4 + th5) - 2*dth0*dth4*l5*m7*cos(th0 + th4 + th5) - 2*dth0*dth5*l5*m7*cos(th0 + th4 + th5) - 2*dth4*dth5*l5*m7*cos(th0 + th4 + th5) - 2*dth0*dth1*lc2*m2*cos(th0 + th1 + th2) - 2*dth0*dth2*lc2*m2*cos(th0 + th1 + th2) - 2*dth1*dth2*lc2*m2*cos(th0 + th1 + th2) - 2*dth0*dth4*lc5*m5*cos(th0 + th4 + th5) - 2*dth0*dth5*lc5*m5*cos(th0 + th4 + th5) - 2*dth4*dth5*lc5*m5*cos(th0 + th4 + th5) - 2*dth0*dth4*l6*m7*cos(th0 + th4 + th5 + th6) - 2*dth0*dth5*l6*m7*cos(th0 + th4 + th5 + th6) - 2*dth0*dth6*l6*m7*cos(th0 + th4 + th5 + th6) - 2*dth4*dth5*l6*m7*cos(th0 + th4 + th5 + th6) - 2*dth4*dth6*l6*m7*cos(th0 + th4 + th5 + th6) - 2*dth5*dth6*l6*m7*cos(th0 + th4 + th5 + th6) - 2*dth0*dth1*lc3*m3*cos(th0 + th1 + th2 + th3) - 2*dth0*dth2*lc3*m3*cos(th0 + th1 + th2 + th3) - 2*dth0*dth3*lc3*m3*cos(th0 + th1 + th2 + th3) - 2*dth1*dth2*lc3*m3*cos(th0 + th1 + th2 + th3) - 2*dth1*dth3*lc3*m3*cos(th0 + th1 + th2 + th3) - 2*dth2*dth3*lc3*m3*cos(th0 + th1 + th2 + th3) - 2*dth0*dth4*lc6*m6*cos(th0 + th4 + th5 + th6) - 2*dth0*dth5*lc6*m6*cos(th0 + th4 + th5 + th6) - 2*dth0*dth6*lc6*m6*cos(th0 + th4 + th5 + th6) - 2*dth4*dth5*lc6*m6*cos(th0 + th4 + th5 + th6) - 2*dth4*dth6*lc6*m6*cos(th0 + th4 + th5 + th6) - 2*dth5*dth6*lc6*m6*cos(th0 + th4 + th5 + th6) - 2*dth0*dth1*l1*m2*cos(th0 + th1) - 2*dth0*dth1*l1*m3*cos(th0 + th1) - 2*dth0*dth4*l4*m5*cos(th0 + th4) - 2*dth0*dth4*l4*m6*cos(th0 + th4) - 2*dth0*dth4*l4*m7*cos(th0 + th4) - 2*dth0*dth1*lc1*m1*cos(th0 + th1) - 2*dth0*dth4*lc4*m4*cos(th0 + th4)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             dth0^2*lc0*m4*sin(th0) - dth4^2*lc7*m7*sin(th0 + th4 + th5 + th6 + th7) - dth5^2*lc7*m7*sin(th0 + th4 + th5 + th6 + th7) - dth6^2*lc7*m7*sin(th0 + th4 + th5 + th6 + th7) - dth7^2*lc7*m7*sin(th0 + th4 + th5 + th6 + th7) - dth0^2*l2*m3*sin(th0 + th1 + th2) - dth1^2*l2*m3*sin(th0 + th1 + th2) - dth2^2*l2*m3*sin(th0 + th1 + th2) - dth0^2*l5*m6*sin(th0 + th4 + th5) - dth4^2*l5*m6*sin(th0 + th4 + th5) - dth5^2*l5*m6*sin(th0 + th4 + th5) - dth0^2*l5*m7*sin(th0 + th4 + th5) - dth4^2*l5*m7*sin(th0 + th4 + th5) - dth5^2*l5*m7*sin(th0 + th4 + th5) - dth0^2*lc2*m2*sin(th0 + th1 + th2) - dth1^2*lc2*m2*sin(th0 + th1 + th2) - dth2^2*lc2*m2*sin(th0 + th1 + th2) - dth0^2*lc5*m5*sin(th0 + th4 + th5) - dth4^2*lc5*m5*sin(th0 + th4 + th5) - dth5^2*lc5*m5*sin(th0 + th4 + th5) - dth0^2*l6*m7*sin(th0 + th4 + th5 + th6) - dth4^2*l6*m7*sin(th0 + th4 + th5 + th6) - dth5^2*l6*m7*sin(th0 + th4 + th5 + th6) - dth6^2*l6*m7*sin(th0 + th4 + th5 + th6) - dth0^2*lc3*m3*sin(th0 + th1 + th2 + th3) - dth1^2*lc3*m3*sin(th0 + th1 + th2 + th3) - dth2^2*lc3*m3*sin(th0 + th1 + th2 + th3) - dth3^2*lc3*m3*sin(th0 + th1 + th2 + th3) - dth0^2*lc6*m6*sin(th0 + th4 + th5 + th6) - dth4^2*lc6*m6*sin(th0 + th4 + th5 + th6) - dth5^2*lc6*m6*sin(th0 + th4 + th5 + th6) - dth6^2*lc6*m6*sin(th0 + th4 + th5 + th6) - dth0^2*l1*m2*sin(th0 + th1) - dth1^2*l1*m2*sin(th0 + th1) - dth0^2*l1*m3*sin(th0 + th1) - dth1^2*l1*m3*sin(th0 + th1) - dth0^2*l4*m5*sin(th0 + th4) - dth4^2*l4*m5*sin(th0 + th4) - dth0^2*l4*m6*sin(th0 + th4) - dth4^2*l4*m6*sin(th0 + th4) - dth0^2*l4*m7*sin(th0 + th4) - dth4^2*l4*m7*sin(th0 + th4) - dth0^2*lc1*m1*sin(th0 + th1) - dth1^2*lc1*m1*sin(th0 + th1) - dth0^2*lc4*m4*sin(th0 + th4) - dth4^2*lc4*m4*sin(th0 + th4) - dth0^2*lc0*m1*sin(th0) - dth0^2*lc0*m2*sin(th0) - dth0^2*lc0*m3*sin(th0) - dth0^2*lc7*m7*sin(th0 + th4 + th5 + th6 + th7) + dth0^2*lc0*m5*sin(th0) + dth0^2*lc0*m6*sin(th0) + dth0^2*lc0*m7*sin(th0) - 2*dth0*dth4*lc7*m7*sin(th0 + th4 + th5 + th6 + th7) - 2*dth0*dth5*lc7*m7*sin(th0 + th4 + th5 + th6 + th7) - 2*dth0*dth6*lc7*m7*sin(th0 + th4 + th5 + th6 + th7) - 2*dth0*dth7*lc7*m7*sin(th0 + th4 + th5 + th6 + th7) - 2*dth4*dth5*lc7*m7*sin(th0 + th4 + th5 + th6 + th7) - 2*dth4*dth6*lc7*m7*sin(th0 + th4 + th5 + th6 + th7) - 2*dth4*dth7*lc7*m7*sin(th0 + th4 + th5 + th6 + th7) - 2*dth5*dth6*lc7*m7*sin(th0 + th4 + th5 + th6 + th7) - 2*dth5*dth7*lc7*m7*sin(th0 + th4 + th5 + th6 + th7) - 2*dth6*dth7*lc7*m7*sin(th0 + th4 + th5 + th6 + th7) - 2*dth0*dth1*l2*m3*sin(th0 + th1 + th2) - 2*dth0*dth2*l2*m3*sin(th0 + th1 + th2) - 2*dth1*dth2*l2*m3*sin(th0 + th1 + th2) - 2*dth0*dth4*l5*m6*sin(th0 + th4 + th5) - 2*dth0*dth5*l5*m6*sin(th0 + th4 + th5) - 2*dth4*dth5*l5*m6*sin(th0 + th4 + th5) - 2*dth0*dth4*l5*m7*sin(th0 + th4 + th5) - 2*dth0*dth5*l5*m7*sin(th0 + th4 + th5) - 2*dth4*dth5*l5*m7*sin(th0 + th4 + th5) - 2*dth0*dth1*lc2*m2*sin(th0 + th1 + th2) - 2*dth0*dth2*lc2*m2*sin(th0 + th1 + th2) - 2*dth1*dth2*lc2*m2*sin(th0 + th1 + th2) - 2*dth0*dth4*lc5*m5*sin(th0 + th4 + th5) - 2*dth0*dth5*lc5*m5*sin(th0 + th4 + th5) - 2*dth4*dth5*lc5*m5*sin(th0 + th4 + th5) - 2*dth0*dth4*l6*m7*sin(th0 + th4 + th5 + th6) - 2*dth0*dth5*l6*m7*sin(th0 + th4 + th5 + th6) - 2*dth0*dth6*l6*m7*sin(th0 + th4 + th5 + th6) - 2*dth4*dth5*l6*m7*sin(th0 + th4 + th5 + th6) - 2*dth4*dth6*l6*m7*sin(th0 + th4 + th5 + th6) - 2*dth5*dth6*l6*m7*sin(th0 + th4 + th5 + th6) - 2*dth0*dth1*lc3*m3*sin(th0 + th1 + th2 + th3) - 2*dth0*dth2*lc3*m3*sin(th0 + th1 + th2 + th3) - 2*dth0*dth3*lc3*m3*sin(th0 + th1 + th2 + th3) - 2*dth1*dth2*lc3*m3*sin(th0 + th1 + th2 + th3) - 2*dth1*dth3*lc3*m3*sin(th0 + th1 + th2 + th3) - 2*dth2*dth3*lc3*m3*sin(th0 + th1 + th2 + th3) - 2*dth0*dth4*lc6*m6*sin(th0 + th4 + th5 + th6) - 2*dth0*dth5*lc6*m6*sin(th0 + th4 + th5 + th6) - 2*dth0*dth6*lc6*m6*sin(th0 + th4 + th5 + th6) - 2*dth4*dth5*lc6*m6*sin(th0 + th4 + th5 + th6) - 2*dth4*dth6*lc6*m6*sin(th0 + th4 + th5 + th6) - 2*dth5*dth6*lc6*m6*sin(th0 + th4 + th5 + th6) - 2*dth0*dth1*l1*m2*sin(th0 + th1) - 2*dth0*dth1*l1*m3*sin(th0 + th1) - 2*dth0*dth4*l4*m5*sin(th0 + th4) - 2*dth0*dth4*l4*m6*sin(th0 + th4) - 2*dth0*dth4*l4*m7*sin(th0 + th4) - 2*dth0*dth1*lc1*m1*sin(th0 + th1) - 2*dth0*dth4*lc4*m4*sin(th0 + th4)
 dth4^2*lc0*lc7*m7*sin(th4 + th5 + th6 + th7) + dth5^2*lc0*lc7*m7*sin(th4 + th5 + th6 + th7) + dth6^2*lc0*lc7*m7*sin(th4 + th5 + th6 + th7) + dth7^2*lc0*lc7*m7*sin(th4 + th5 + th6 + th7) - dth5^2*l4*l6*m7*sin(th5 + th6) - dth6^2*l4*l6*m7*sin(th5 + th6) - dth2^2*l1*lc3*m3*sin(th2 + th3) - dth3^2*l1*lc3*m3*sin(th2 + th3) - dth1^2*l2*lc0*m3*sin(th1 + th2) - dth2^2*l2*lc0*m3*sin(th1 + th2) - dth5^2*l4*lc6*m6*sin(th5 + th6) - dth6^2*l4*lc6*m6*sin(th5 + th6) + dth4^2*l5*lc0*m6*sin(th4 + th5) + dth5^2*l5*lc0*m6*sin(th4 + th5) + dth4^2*l5*lc0*m7*sin(th4 + th5) + dth5^2*l5*lc0*m7*sin(th4 + th5) - dth6^2*l5*lc7*m7*sin(th6 + th7) - dth7^2*l5*lc7*m7*sin(th6 + th7) - dth1^2*lc0*lc2*m2*sin(th1 + th2) - dth2^2*lc0*lc2*m2*sin(th1 + th2) + dth4^2*lc0*lc5*m5*sin(th4 + th5) + dth5^2*lc0*lc5*m5*sin(th4 + th5) - dth2^2*l1*l2*m3*sin(th2) - dth5^2*l4*l5*m6*sin(th5) - dth5^2*l4*l5*m7*sin(th5) - dth6^2*l5*l6*m7*sin(th6) - dth1^2*l1*lc0*m2*sin(th1) - dth2^2*l1*lc2*m2*sin(th2) - dth1^2*l1*lc0*m3*sin(th1) - dth3^2*l2*lc3*m3*sin(th3) + dth4^2*l4*lc0*m5*sin(th4) - dth5^2*l4*lc5*m5*sin(th5) + dth4^2*l4*lc0*m6*sin(th4) + dth4^2*l4*lc0*m7*sin(th4) - dth6^2*l5*lc6*m6*sin(th6) - dth7^2*l6*lc7*m7*sin(th7) - dth1^2*lc0*lc1*m1*sin(th1) + dth4^2*lc0*lc4*m4*sin(th4) - dth5^2*l4*lc7*m7*sin(th5 + th6 + th7) - dth6^2*l4*lc7*m7*sin(th5 + th6 + th7) - dth7^2*l4*lc7*m7*sin(th5 + th6 + th7) + dth4^2*l6*lc0*m7*sin(th4 + th5 + th6) + dth5^2*l6*lc0*m7*sin(th4 + th5 + th6) + dth6^2*l6*lc0*m7*sin(th4 + th5 + th6) - dth1^2*lc0*lc3*m3*sin(th1 + th2 + th3) - dth2^2*lc0*lc3*m3*sin(th1 + th2 + th3) - dth3^2*lc0*lc3*m3*sin(th1 + th2 + th3) + dth4^2*lc0*lc6*m6*sin(th4 + th5 + th6) + dth5^2*lc0*lc6*m6*sin(th4 + th5 + th6) + dth6^2*lc0*lc6*m6*sin(th4 + th5 + th6) + 2*dth0*dth4*lc0*lc7*m7*sin(th4 + th5 + th6 + th7) + 2*dth0*dth5*lc0*lc7*m7*sin(th4 + th5 + th6 + th7) + 2*dth0*dth6*lc0*lc7*m7*sin(th4 + th5 + th6 + th7) + 2*dth0*dth7*lc0*lc7*m7*sin(th4 + th5 + th6 + th7) + 2*dth4*dth5*lc0*lc7*m7*sin(th4 + th5 + th6 + th7) + 2*dth4*dth6*lc0*lc7*m7*sin(th4 + th5 + th6 + th7) + 2*dth4*dth7*lc0*lc7*m7*sin(th4 + th5 + th6 + th7) + 2*dth5*dth6*lc0*lc7*m7*sin(th4 + th5 + th6 + th7) + 2*dth5*dth7*lc0*lc7*m7*sin(th4 + th5 + th6 + th7) + 2*dth6*dth7*lc0*lc7*m7*sin(th4 + th5 + th6 + th7) - 2*dth0*dth5*l4*l6*m7*sin(th5 + th6) - 2*dth0*dth6*l4*l6*m7*sin(th5 + th6) - 2*dth4*dth5*l4*l6*m7*sin(th5 + th6) - 2*dth4*dth6*l4*l6*m7*sin(th5 + th6) - 2*dth5*dth6*l4*l6*m7*sin(th5 + th6) - 2*dth0*dth2*l1*lc3*m3*sin(th2 + th3) - 2*dth0*dth3*l1*lc3*m3*sin(th2 + th3) - 2*dth1*dth2*l1*lc3*m3*sin(th2 + th3) - 2*dth1*dth3*l1*lc3*m3*sin(th2 + th3) - 2*dth2*dth3*l1*lc3*m3*sin(th2 + th3) - 2*dth0*dth1*l2*lc0*m3*sin(th1 + th2) - 2*dth0*dth2*l2*lc0*m3*sin(th1 + th2) - 2*dth1*dth2*l2*lc0*m3*sin(th1 + th2) - 2*dth0*dth5*l4*lc6*m6*sin(th5 + th6) - 2*dth0*dth6*l4*lc6*m6*sin(th5 + th6) - 2*dth4*dth5*l4*lc6*m6*sin(th5 + th6) - 2*dth4*dth6*l4*lc6*m6*sin(th5 + th6) - 2*dth5*dth6*l4*lc6*m6*sin(th5 + th6) + 2*dth0*dth4*l5*lc0*m6*sin(th4 + th5) + 2*dth0*dth5*l5*lc0*m6*sin(th4 + th5) + 2*dth4*dth5*l5*lc0*m6*sin(th4 + th5) + 2*dth0*dth4*l5*lc0*m7*sin(th4 + th5) + 2*dth0*dth5*l5*lc0*m7*sin(th4 + th5) + 2*dth4*dth5*l5*lc0*m7*sin(th4 + th5) - 2*dth0*dth6*l5*lc7*m7*sin(th6 + th7) - 2*dth0*dth7*l5*lc7*m7*sin(th6 + th7) - 2*dth4*dth6*l5*lc7*m7*sin(th6 + th7) - 2*dth4*dth7*l5*lc7*m7*sin(th6 + th7) - 2*dth5*dth6*l5*lc7*m7*sin(th6 + th7) - 2*dth5*dth7*l5*lc7*m7*sin(th6 + th7) - 2*dth6*dth7*l5*lc7*m7*sin(th6 + th7) - 2*dth0*dth1*lc0*lc2*m2*sin(th1 + th2) - 2*dth0*dth2*lc0*lc2*m2*sin(th1 + th2) - 2*dth1*dth2*lc0*lc2*m2*sin(th1 + th2) + 2*dth0*dth4*lc0*lc5*m5*sin(th4 + th5) + 2*dth0*dth5*lc0*lc5*m5*sin(th4 + th5) + 2*dth4*dth5*lc0*lc5*m5*sin(th4 + th5) - 2*dth0*dth2*l1*l2*m3*sin(th2) - 2*dth1*dth2*l1*l2*m3*sin(th2) - 2*dth0*dth5*l4*l5*m6*sin(th5) - 2*dth4*dth5*l4*l5*m6*sin(th5) - 2*dth0*dth5*l4*l5*m7*sin(th5) - 2*dth4*dth5*l4*l5*m7*sin(th5) - 2*dth0*dth6*l5*l6*m7*sin(th6) - 2*dth4*dth6*l5*l6*m7*sin(th6) - 2*dth5*dth6*l5*l6*m7*sin(th6) - 2*dth0*dth1*l1*lc0*m2*sin(th1) - 2*dth0*dth2*l1*lc2*m2*sin(th2) - 2*dth1*dth2*l1*lc2*m2*sin(th2) - 2*dth0*dth1*l1*lc0*m3*sin(th1) - 2*dth0*dth3*l2*lc3*m3*sin(th3) - 2*dth1*dth3*l2*lc3*m3*sin(th3) - 2*dth2*dth3*l2*lc3*m3*sin(th3) + 2*dth0*dth4*l4*lc0*m5*sin(th4) - 2*dth0*dth5*l4*lc5*m5*sin(th5) - 2*dth4*dth5*l4*lc5*m5*sin(th5) + 2*dth0*dth4*l4*lc0*m6*sin(th4) + 2*dth0*dth4*l4*lc0*m7*sin(th4) - 2*dth0*dth6*l5*lc6*m6*sin(th6) - 2*dth4*dth6*l5*lc6*m6*sin(th6) - 2*dth5*dth6*l5*lc6*m6*sin(th6) - 2*dth0*dth7*l6*lc7*m7*sin(th7) - 2*dth4*dth7*l6*lc7*m7*sin(th7) - 2*dth5*dth7*l6*lc7*m7*sin(th7) - 2*dth6*dth7*l6*lc7*m7*sin(th7) - 2*dth0*dth1*lc0*lc1*m1*sin(th1) + 2*dth0*dth4*lc0*lc4*m4*sin(th4) - 2*dth0*dth5*l4*lc7*m7*sin(th5 + th6 + th7) - 2*dth0*dth6*l4*lc7*m7*sin(th5 + th6 + th7) - 2*dth0*dth7*l4*lc7*m7*sin(th5 + th6 + th7) - 2*dth4*dth5*l4*lc7*m7*sin(th5 + th6 + th7) - 2*dth4*dth6*l4*lc7*m7*sin(th5 + th6 + th7) - 2*dth4*dth7*l4*lc7*m7*sin(th5 + th6 + th7) - 2*dth5*dth6*l4*lc7*m7*sin(th5 + th6 + th7) - 2*dth5*dth7*l4*lc7*m7*sin(th5 + th6 + th7) - 2*dth6*dth7*l4*lc7*m7*sin(th5 + th6 + th7) + 2*dth0*dth4*l6*lc0*m7*sin(th4 + th5 + th6) + 2*dth0*dth5*l6*lc0*m7*sin(th4 + th5 + th6) + 2*dth0*dth6*l6*lc0*m7*sin(th4 + th5 + th6) + 2*dth4*dth5*l6*lc0*m7*sin(th4 + th5 + th6) + 2*dth4*dth6*l6*lc0*m7*sin(th4 + th5 + th6) + 2*dth5*dth6*l6*lc0*m7*sin(th4 + th5 + th6) - 2*dth0*dth1*lc0*lc3*m3*sin(th1 + th2 + th3) - 2*dth0*dth2*lc0*lc3*m3*sin(th1 + th2 + th3) - 2*dth0*dth3*lc0*lc3*m3*sin(th1 + th2 + th3) - 2*dth1*dth2*lc0*lc3*m3*sin(th1 + th2 + th3) - 2*dth1*dth3*lc0*lc3*m3*sin(th1 + th2 + th3) - 2*dth2*dth3*lc0*lc3*m3*sin(th1 + th2 + th3) + 2*dth0*dth4*lc0*lc6*m6*sin(th4 + th5 + th6) + 2*dth0*dth5*lc0*lc6*m6*sin(th4 + th5 + th6) + 2*dth0*dth6*lc0*lc6*m6*sin(th4 + th5 + th6) + 2*dth4*dth5*lc0*lc6*m6*sin(th4 + th5 + th6) + 2*dth4*dth6*lc0*lc6*m6*sin(th4 + th5 + th6) + 2*dth5*dth6*lc0*lc6*m6*sin(th4 + th5 + th6)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   dth0^2*l2*lc0*m3*sin(th1 + th2) - dth3^2*l1*lc3*m3*sin(th2 + th3) - dth2^2*l1*lc3*m3*sin(th2 + th3) + dth0^2*lc0*lc2*m2*sin(th1 + th2) - dth2^2*l1*l2*m3*sin(th2) + dth0^2*l1*lc0*m2*sin(th1) - dth2^2*l1*lc2*m2*sin(th2) + dth0^2*l1*lc0*m3*sin(th1) - dth3^2*l2*lc3*m3*sin(th3) + dth0^2*lc0*lc1*m1*sin(th1) + dth0^2*lc0*lc3*m3*sin(th1 + th2 + th3) - 2*dth0*dth2*l1*lc3*m3*sin(th2 + th3) - 2*dth0*dth3*l1*lc3*m3*sin(th2 + th3) - 2*dth1*dth2*l1*lc3*m3*sin(th2 + th3) - 2*dth1*dth3*l1*lc3*m3*sin(th2 + th3) - 2*dth2*dth3*l1*lc3*m3*sin(th2 + th3) - 2*dth0*dth2*l1*l2*m3*sin(th2) - 2*dth1*dth2*l1*l2*m3*sin(th2) - 2*dth0*dth2*l1*lc2*m2*sin(th2) - 2*dth1*dth2*l1*lc2*m2*sin(th2) - 2*dth0*dth3*l2*lc3*m3*sin(th3) - 2*dth1*dth3*l2*lc3*m3*sin(th3) - 2*dth2*dth3*l2*lc3*m3*sin(th3)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              dth0^2*l1*lc3*m3*sin(th2 + th3) + dth1^2*l1*lc3*m3*sin(th2 + th3) + dth0^2*l2*lc0*m3*sin(th1 + th2) + dth0^2*lc0*lc2*m2*sin(th1 + th2) + dth0^2*l1*l2*m3*sin(th2) + dth1^2*l1*l2*m3*sin(th2) + dth0^2*l1*lc2*m2*sin(th2) + dth1^2*l1*lc2*m2*sin(th2) - dth3^2*l2*lc3*m3*sin(th3) + dth0^2*lc0*lc3*m3*sin(th1 + th2 + th3) + 2*dth0*dth1*l1*lc3*m3*sin(th2 + th3) + 2*dth0*dth1*l1*l2*m3*sin(th2) + 2*dth0*dth1*l1*lc2*m2*sin(th2) - 2*dth0*dth3*l2*lc3*m3*sin(th3) - 2*dth1*dth3*l2*lc3*m3*sin(th3) - 2*dth2*dth3*l2*lc3*m3*sin(th3)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       lc3*m3*(dth0^2*l1*sin(th2 + th3) + dth1^2*l1*sin(th2 + th3) + dth0^2*l2*sin(th3) + dth1^2*l2*sin(th3) + dth2^2*l2*sin(th3) + dth0^2*lc0*sin(th1 + th2 + th3) + 2*dth0*dth1*l1*sin(th2 + th3) + 2*dth0*dth1*l2*sin(th3) + 2*dth0*dth2*l2*sin(th3) + 2*dth1*dth2*l2*sin(th3))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    - dth0^2*lc0*lc7*m7*sin(th4 + th5 + th6 + th7) - dth5^2*l4*l6*m7*sin(th5 + th6) - dth6^2*l4*l6*m7*sin(th5 + th6) - dth5^2*l4*lc6*m6*sin(th5 + th6) - dth6^2*l4*lc6*m6*sin(th5 + th6) - dth0^2*l5*lc0*m6*sin(th4 + th5) - dth0^2*l5*lc0*m7*sin(th4 + th5) - dth6^2*l5*lc7*m7*sin(th6 + th7) - dth7^2*l5*lc7*m7*sin(th6 + th7) - dth0^2*lc0*lc5*m5*sin(th4 + th5) - dth5^2*l4*l5*m6*sin(th5) - dth5^2*l4*l5*m7*sin(th5) - dth6^2*l5*l6*m7*sin(th6) - dth0^2*l4*lc0*m5*sin(th4) - dth5^2*l4*lc5*m5*sin(th5) - dth0^2*l4*lc0*m6*sin(th4) - dth0^2*l4*lc0*m7*sin(th4) - dth6^2*l5*lc6*m6*sin(th6) - dth7^2*l6*lc7*m7*sin(th7) - dth0^2*lc0*lc4*m4*sin(th4) - dth5^2*l4*lc7*m7*sin(th5 + th6 + th7) - dth6^2*l4*lc7*m7*sin(th5 + th6 + th7) - dth7^2*l4*lc7*m7*sin(th5 + th6 + th7) - dth0^2*l6*lc0*m7*sin(th4 + th5 + th6) - dth0^2*lc0*lc6*m6*sin(th4 + th5 + th6) - 2*dth0*dth5*l4*l6*m7*sin(th5 + th6) - 2*dth0*dth6*l4*l6*m7*sin(th5 + th6) - 2*dth4*dth5*l4*l6*m7*sin(th5 + th6) - 2*dth4*dth6*l4*l6*m7*sin(th5 + th6) - 2*dth5*dth6*l4*l6*m7*sin(th5 + th6) - 2*dth0*dth5*l4*lc6*m6*sin(th5 + th6) - 2*dth0*dth6*l4*lc6*m6*sin(th5 + th6) - 2*dth4*dth5*l4*lc6*m6*sin(th5 + th6) - 2*dth4*dth6*l4*lc6*m6*sin(th5 + th6) - 2*dth5*dth6*l4*lc6*m6*sin(th5 + th6) - 2*dth0*dth6*l5*lc7*m7*sin(th6 + th7) - 2*dth0*dth7*l5*lc7*m7*sin(th6 + th7) - 2*dth4*dth6*l5*lc7*m7*sin(th6 + th7) - 2*dth4*dth7*l5*lc7*m7*sin(th6 + th7) - 2*dth5*dth6*l5*lc7*m7*sin(th6 + th7) - 2*dth5*dth7*l5*lc7*m7*sin(th6 + th7) - 2*dth6*dth7*l5*lc7*m7*sin(th6 + th7) - 2*dth0*dth5*l4*l5*m6*sin(th5) - 2*dth4*dth5*l4*l5*m6*sin(th5) - 2*dth0*dth5*l4*l5*m7*sin(th5) - 2*dth4*dth5*l4*l5*m7*sin(th5) - 2*dth0*dth6*l5*l6*m7*sin(th6) - 2*dth4*dth6*l5*l6*m7*sin(th6) - 2*dth5*dth6*l5*l6*m7*sin(th6) - 2*dth0*dth5*l4*lc5*m5*sin(th5) - 2*dth4*dth5*l4*lc5*m5*sin(th5) - 2*dth0*dth6*l5*lc6*m6*sin(th6) - 2*dth4*dth6*l5*lc6*m6*sin(th6) - 2*dth5*dth6*l5*lc6*m6*sin(th6) - 2*dth0*dth7*l6*lc7*m7*sin(th7) - 2*dth4*dth7*l6*lc7*m7*sin(th7) - 2*dth5*dth7*l6*lc7*m7*sin(th7) - 2*dth6*dth7*l6*lc7*m7*sin(th7) - 2*dth0*dth5*l4*lc7*m7*sin(th5 + th6 + th7) - 2*dth0*dth6*l4*lc7*m7*sin(th5 + th6 + th7) - 2*dth0*dth7*l4*lc7*m7*sin(th5 + th6 + th7) - 2*dth4*dth5*l4*lc7*m7*sin(th5 + th6 + th7) - 2*dth4*dth6*l4*lc7*m7*sin(th5 + th6 + th7) - 2*dth4*dth7*l4*lc7*m7*sin(th5 + th6 + th7) - 2*dth5*dth6*l4*lc7*m7*sin(th5 + th6 + th7) - 2*dth5*dth7*l4*lc7*m7*sin(th5 + th6 + th7) - 2*dth6*dth7*l4*lc7*m7*sin(th5 + th6 + th7)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          dth0^2*l4*l6*m7*sin(th5 + th6) - dth0^2*lc0*lc7*m7*sin(th4 + th5 + th6 + th7) + dth4^2*l4*l6*m7*sin(th5 + th6) + dth0^2*l4*lc6*m6*sin(th5 + th6) + dth4^2*l4*lc6*m6*sin(th5 + th6) - dth0^2*l5*lc0*m6*sin(th4 + th5) - dth0^2*l5*lc0*m7*sin(th4 + th5) - dth6^2*l5*lc7*m7*sin(th6 + th7) - dth7^2*l5*lc7*m7*sin(th6 + th7) - dth0^2*lc0*lc5*m5*sin(th4 + th5) + dth0^2*l4*l5*m6*sin(th5) + dth4^2*l4*l5*m6*sin(th5) + dth0^2*l4*l5*m7*sin(th5) + dth4^2*l4*l5*m7*sin(th5) - dth6^2*l5*l6*m7*sin(th6) + dth0^2*l4*lc5*m5*sin(th5) + dth4^2*l4*lc5*m5*sin(th5) - dth6^2*l5*lc6*m6*sin(th6) - dth7^2*l6*lc7*m7*sin(th7) + dth0^2*l4*lc7*m7*sin(th5 + th6 + th7) + dth4^2*l4*lc7*m7*sin(th5 + th6 + th7) - dth0^2*l6*lc0*m7*sin(th4 + th5 + th6) - dth0^2*lc0*lc6*m6*sin(th4 + th5 + th6) + 2*dth0*dth4*l4*l6*m7*sin(th5 + th6) + 2*dth0*dth4*l4*lc6*m6*sin(th5 + th6) - 2*dth0*dth6*l5*lc7*m7*sin(th6 + th7) - 2*dth0*dth7*l5*lc7*m7*sin(th6 + th7) - 2*dth4*dth6*l5*lc7*m7*sin(th6 + th7) - 2*dth4*dth7*l5*lc7*m7*sin(th6 + th7) - 2*dth5*dth6*l5*lc7*m7*sin(th6 + th7) - 2*dth5*dth7*l5*lc7*m7*sin(th6 + th7) - 2*dth6*dth7*l5*lc7*m7*sin(th6 + th7) + 2*dth0*dth4*l4*l5*m6*sin(th5) + 2*dth0*dth4*l4*l5*m7*sin(th5) - 2*dth0*dth6*l5*l6*m7*sin(th6) - 2*dth4*dth6*l5*l6*m7*sin(th6) - 2*dth5*dth6*l5*l6*m7*sin(th6) + 2*dth0*dth4*l4*lc5*m5*sin(th5) - 2*dth0*dth6*l5*lc6*m6*sin(th6) - 2*dth4*dth6*l5*lc6*m6*sin(th6) - 2*dth5*dth6*l5*lc6*m6*sin(th6) - 2*dth0*dth7*l6*lc7*m7*sin(th7) - 2*dth4*dth7*l6*lc7*m7*sin(th7) - 2*dth5*dth7*l6*lc7*m7*sin(th7) - 2*dth6*dth7*l6*lc7*m7*sin(th7) + 2*dth0*dth4*l4*lc7*m7*sin(th5 + th6 + th7)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  dth0^2*l4*l6*m7*sin(th5 + th6) - dth0^2*lc0*lc7*m7*sin(th4 + th5 + th6 + th7) + dth4^2*l4*l6*m7*sin(th5 + th6) + dth0^2*l4*lc6*m6*sin(th5 + th6) + dth4^2*l4*lc6*m6*sin(th5 + th6) + dth0^2*l5*lc7*m7*sin(th6 + th7) + dth4^2*l5*lc7*m7*sin(th6 + th7) + dth5^2*l5*lc7*m7*sin(th6 + th7) + dth0^2*l5*l6*m7*sin(th6) + dth4^2*l5*l6*m7*sin(th6) + dth5^2*l5*l6*m7*sin(th6) + dth0^2*l5*lc6*m6*sin(th6) + dth4^2*l5*lc6*m6*sin(th6) + dth5^2*l5*lc6*m6*sin(th6) - dth7^2*l6*lc7*m7*sin(th7) + dth0^2*l4*lc7*m7*sin(th5 + th6 + th7) + dth4^2*l4*lc7*m7*sin(th5 + th6 + th7) - dth0^2*l6*lc0*m7*sin(th4 + th5 + th6) - dth0^2*lc0*lc6*m6*sin(th4 + th5 + th6) + 2*dth0*dth4*l4*l6*m7*sin(th5 + th6) + 2*dth0*dth4*l4*lc6*m6*sin(th5 + th6) + 2*dth0*dth4*l5*lc7*m7*sin(th6 + th7) + 2*dth0*dth5*l5*lc7*m7*sin(th6 + th7) + 2*dth4*dth5*l5*lc7*m7*sin(th6 + th7) + 2*dth0*dth4*l5*l6*m7*sin(th6) + 2*dth0*dth5*l5*l6*m7*sin(th6) + 2*dth4*dth5*l5*l6*m7*sin(th6) + 2*dth0*dth4*l5*lc6*m6*sin(th6) + 2*dth0*dth5*l5*lc6*m6*sin(th6) + 2*dth4*dth5*l5*lc6*m6*sin(th6) - 2*dth0*dth7*l6*lc7*m7*sin(th7) - 2*dth4*dth7*l6*lc7*m7*sin(th7) - 2*dth5*dth7*l6*lc7*m7*sin(th7) - 2*dth6*dth7*l6*lc7*m7*sin(th7) + 2*dth0*dth4*l4*lc7*m7*sin(th5 + th6 + th7)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           lc7*m7*(dth0^2*l5*sin(th6 + th7) - dth0^2*lc0*sin(th4 + th5 + th6 + th7) + dth4^2*l5*sin(th6 + th7) + dth5^2*l5*sin(th6 + th7) + dth0^2*l6*sin(th7) + dth4^2*l6*sin(th7) + dth5^2*l6*sin(th7) + dth6^2*l6*sin(th7) + dth0^2*l4*sin(th5 + th6 + th7) + dth4^2*l4*sin(th5 + th6 + th7) + 2*dth0*dth4*l5*sin(th6 + th7) + 2*dth0*dth5*l5*sin(th6 + th7) + 2*dth4*dth5*l5*sin(th6 + th7) + 2*dth0*dth4*l6*sin(th7) + 2*dth0*dth5*l6*sin(th7) + 2*dth0*dth6*l6*sin(th7) + 2*dth4*dth5*l6*sin(th7) + 2*dth4*dth6*l6*sin(th7) + 2*dth5*dth6*l6*sin(th7) + 2*dth0*dth4*l4*sin(th5 + th6 + th7))]
 J =[ 0, 0, l3*sin(th0 + th1 + th2 + th3) - l6*sin(th0 + th4 + th5 + th6) + l1*sin(th0 + th1) - l4*sin(th0 + th4) + 2*lc0*sin(th0) - l7*sin(th0 + th4 + th5 + th6 + th7) + l2*sin(th0 + th1 + th2) - l5*sin(th0 + th4 + th5),   l3*sin(th0 + th1 + th2 + th3) + l1*sin(th0 + th1) + l2*sin(th0 + th1 + th2),   l3*sin(th0 + th1 + th2 + th3) + l2*sin(th0 + th1 + th2),  l3*sin(th0 + th1 + th2 + th3), - l6*sin(th0 + th4 + th5 + th6) - l4*sin(th0 + th4) - l7*sin(th0 + th4 + th5 + th6 + th7) - l5*sin(th0 + th4 + th5), - l6*sin(th0 + th4 + th5 + th6) - l7*sin(th0 + th4 + th5 + th6 + th7) - l5*sin(th0 + th4 + th5), - l6*sin(th0 + th4 + th5 + th6) - l7*sin(th0 + th4 + th5 + th6 + th7), -l7*sin(th0 + th4 + th5 + th6 + th7)
 0, 0, l6*cos(th0 + th4 + th5 + th6) - l3*cos(th0 + th1 + th2 + th3) - l1*cos(th0 + th1) + l4*cos(th0 + th4) - 2*lc0*cos(th0) + l7*cos(th0 + th4 + th5 + th6 + th7) - l2*cos(th0 + th1 + th2) + l5*cos(th0 + th4 + th5), - l3*cos(th0 + th1 + th2 + th3) - l1*cos(th0 + th1) - l2*cos(th0 + th1 + th2), - l3*cos(th0 + th1 + th2 + th3) - l2*cos(th0 + th1 + th2), -l3*cos(th0 + th1 + th2 + th3),   l6*cos(th0 + th4 + th5 + th6) + l4*cos(th0 + th4) + l7*cos(th0 + th4 + th5 + th6 + th7) + l5*cos(th0 + th4 + th5),   l6*cos(th0 + th4 + th5 + th6) + l7*cos(th0 + th4 + th5 + th6 + th7) + l5*cos(th0 + th4 + th5),   l6*cos(th0 + th4 + th5 + th6) + l7*cos(th0 + th4 + th5 + th6 + th7),  l7*cos(th0 + th4 + th5 + th6 + th7)]
 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             

Jdtdq =[ dth0^2*l3*cos(th0 + th1 + th2 + th3) + dth1^2*l3*cos(th0 + th1 + th2 + th3) + dth2^2*l3*cos(th0 + th1 + th2 + th3) + dth3^2*l3*cos(th0 + th1 + th2 + th3) - dth0^2*l6*cos(th0 + th4 + th5 + th6) - dth4^2*l6*cos(th0 + th4 + th5 + th6) - dth5^2*l6*cos(th0 + th4 + th5 + th6) - dth6^2*l6*cos(th0 + th4 + th5 + th6) + dth0^2*l1*cos(th0 + th1) + dth1^2*l1*cos(th0 + th1) - dth0^2*l4*cos(th0 + th4) - dth4^2*l4*cos(th0 + th4) + 2*dth0^2*lc0*cos(th0) - dth0^2*l7*cos(th0 + th4 + th5 + th6 + th7) - dth4^2*l7*cos(th0 + th4 + th5 + th6 + th7) - dth5^2*l7*cos(th0 + th4 + th5 + th6 + th7) - dth6^2*l7*cos(th0 + th4 + th5 + th6 + th7) - dth7^2*l7*cos(th0 + th4 + th5 + th6 + th7) + dth0^2*l2*cos(th0 + th1 + th2) + dth1^2*l2*cos(th0 + th1 + th2) + dth2^2*l2*cos(th0 + th1 + th2) - dth0^2*l5*cos(th0 + th4 + th5) - dth4^2*l5*cos(th0 + th4 + th5) - dth5^2*l5*cos(th0 + th4 + th5) + 2*dth0*dth1*l3*cos(th0 + th1 + th2 + th3) + 2*dth0*dth2*l3*cos(th0 + th1 + th2 + th3) + 2*dth0*dth3*l3*cos(th0 + th1 + th2 + th3) + 2*dth1*dth2*l3*cos(th0 + th1 + th2 + th3) + 2*dth1*dth3*l3*cos(th0 + th1 + th2 + th3) + 2*dth2*dth3*l3*cos(th0 + th1 + th2 + th3) - 2*dth0*dth4*l6*cos(th0 + th4 + th5 + th6) - 2*dth0*dth5*l6*cos(th0 + th4 + th5 + th6) - 2*dth0*dth6*l6*cos(th0 + th4 + th5 + th6) - 2*dth4*dth5*l6*cos(th0 + th4 + th5 + th6) - 2*dth4*dth6*l6*cos(th0 + th4 + th5 + th6) - 2*dth5*dth6*l6*cos(th0 + th4 + th5 + th6) + 2*dth0*dth1*l1*cos(th0 + th1) - 2*dth0*dth4*l4*cos(th0 + th4) - 2*dth0*dth4*l7*cos(th0 + th4 + th5 + th6 + th7) - 2*dth0*dth5*l7*cos(th0 + th4 + th5 + th6 + th7) - 2*dth0*dth6*l7*cos(th0 + th4 + th5 + th6 + th7) - 2*dth0*dth7*l7*cos(th0 + th4 + th5 + th6 + th7) - 2*dth4*dth5*l7*cos(th0 + th4 + th5 + th6 + th7) - 2*dth4*dth6*l7*cos(th0 + th4 + th5 + th6 + th7) - 2*dth4*dth7*l7*cos(th0 + th4 + th5 + th6 + th7) - 2*dth5*dth6*l7*cos(th0 + th4 + th5 + th6 + th7) - 2*dth5*dth7*l7*cos(th0 + th4 + th5 + th6 + th7) - 2*dth6*dth7*l7*cos(th0 + th4 + th5 + th6 + th7) + 2*dth0*dth1*l2*cos(th0 + th1 + th2) + 2*dth0*dth2*l2*cos(th0 + th1 + th2) + 2*dth1*dth2*l2*cos(th0 + th1 + th2) - 2*dth0*dth4*l5*cos(th0 + th4 + th5) - 2*dth0*dth5*l5*cos(th0 + th4 + th5) - 2*dth4*dth5*l5*cos(th0 + th4 + th5)
 dth0^2*l3*sin(th0 + th1 + th2 + th3) + dth1^2*l3*sin(th0 + th1 + th2 + th3) + dth2^2*l3*sin(th0 + th1 + th2 + th3) + dth3^2*l3*sin(th0 + th1 + th2 + th3) - dth0^2*l6*sin(th0 + th4 + th5 + th6) - dth4^2*l6*sin(th0 + th4 + th5 + th6) - dth5^2*l6*sin(th0 + th4 + th5 + th6) - dth6^2*l6*sin(th0 + th4 + th5 + th6) + dth0^2*l1*sin(th0 + th1) + dth1^2*l1*sin(th0 + th1) - dth0^2*l4*sin(th0 + th4) - dth4^2*l4*sin(th0 + th4) + 2*dth0^2*lc0*sin(th0) - dth0^2*l7*sin(th0 + th4 + th5 + th6 + th7) - dth4^2*l7*sin(th0 + th4 + th5 + th6 + th7) - dth5^2*l7*sin(th0 + th4 + th5 + th6 + th7) - dth6^2*l7*sin(th0 + th4 + th5 + th6 + th7) - dth7^2*l7*sin(th0 + th4 + th5 + th6 + th7) + dth0^2*l2*sin(th0 + th1 + th2) + dth1^2*l2*sin(th0 + th1 + th2) + dth2^2*l2*sin(th0 + th1 + th2) - dth0^2*l5*sin(th0 + th4 + th5) - dth4^2*l5*sin(th0 + th4 + th5) - dth5^2*l5*sin(th0 + th4 + th5) + 2*dth0*dth1*l3*sin(th0 + th1 + th2 + th3) + 2*dth0*dth2*l3*sin(th0 + th1 + th2 + th3) + 2*dth0*dth3*l3*sin(th0 + th1 + th2 + th3) + 2*dth1*dth2*l3*sin(th0 + th1 + th2 + th3) + 2*dth1*dth3*l3*sin(th0 + th1 + th2 + th3) + 2*dth2*dth3*l3*sin(th0 + th1 + th2 + th3) - 2*dth0*dth4*l6*sin(th0 + th4 + th5 + th6) - 2*dth0*dth5*l6*sin(th0 + th4 + th5 + th6) - 2*dth0*dth6*l6*sin(th0 + th4 + th5 + th6) - 2*dth4*dth5*l6*sin(th0 + th4 + th5 + th6) - 2*dth4*dth6*l6*sin(th0 + th4 + th5 + th6) - 2*dth5*dth6*l6*sin(th0 + th4 + th5 + th6) + 2*dth0*dth1*l1*sin(th0 + th1) - 2*dth0*dth4*l4*sin(th0 + th4) - 2*dth0*dth4*l7*sin(th0 + th4 + th5 + th6 + th7) - 2*dth0*dth5*l7*sin(th0 + th4 + th5 + th6 + th7) - 2*dth0*dth6*l7*sin(th0 + th4 + th5 + th6 + th7) - 2*dth0*dth7*l7*sin(th0 + th4 + th5 + th6 + th7) - 2*dth4*dth5*l7*sin(th0 + th4 + th5 + th6 + th7) - 2*dth4*dth6*l7*sin(th0 + th4 + th5 + th6 + th7) - 2*dth4*dth7*l7*sin(th0 + th4 + th5 + th6 + th7) - 2*dth5*dth6*l7*sin(th0 + th4 + th5 + th6 + th7) - 2*dth5*dth7*l7*sin(th0 + th4 + th5 + th6 + th7) - 2*dth6*dth7*l7*sin(th0 + th4 + th5 + th6 + th7) + 2*dth0*dth1*l2*sin(th0 + th1 + th2) + 2*dth0*dth2*l2*sin(th0 + th1 + th2) + 2*dth1*dth2*l2*sin(th0 + th1 + th2) - 2*dth0*dth4*l5*sin(th0 + th4 + th5) - 2*dth0*dth5*l5*sin(th0 + th4 + th5) - 2*dth4*dth5*l5*sin(th0 + th4 + th5)]
 


 M(1:10,1:10)=I
 M(1:10,11:12)=J.'
 M(11:12,1:10)=J
 
 Minv=inv(M)
 
 F1=[F;0;0]-[C;0;0]
 F2=(J.'*[lmdx;lmdy])
 F3=[0;0;0;0;0;0;0;0;0;0;-Jdtdq]
 Ff=F1+[F2;0;0]+F3

 ddq=Minv*Ff
 
ddx0=ddq(1);ddy0=ddq(2);ddth0=ddq(3);ddth1=ddq(4); ddth2=ddq(5);ddth3=ddq(6); ddth4=ddq(7); ddth5=ddq(8);ddth6=ddq(9);ddth7=ddq(10); lmdx=-ddq(11);lmdy=-ddq(12);
dy = zeros(24,1);
dy(1)=dx0; dy(2)=dy0; dy(3)=dth0; dy(4)=dth1; dy(5)=dth2;dy(6)=dth3;dy(7)=dth4; dy(8)=dth5; dy(9)=dth6; dy(10)=dth7;dy(11)=ddx0; dy(12)=ddy0; dy(15)=ddth0; dy(16)=ddth1; dy(17)=ddth2;dy(18)=ddth3;dy(19)=ddth4; dy(20)=ddth5;dy(21)=ddth6;dy(22)=ddth7;
