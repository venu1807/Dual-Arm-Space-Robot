% This function evaluates the regressor matrix of a free floating robot
% according to the formulation in the paper. Please note that the second
% section has to be updated as per the robot's kinematic structure
% q, th_d, dq, dth_d - position and velocity of base and joints
% lk_no - index of link which is attached to the base

function [kl] = regMat_loop()
% Start of the actual program - ok

St=load('statevar.dat');
t=load('timevar.dat');
m=load('mtvar.dat');

% [n alp a b bt dx dy dz al alt m g  Icxx Icyy Iczz Icxy Icyz Iczx]=inputs();
% [a0; a1],[d1x  d2x],[m0; m1; m2],[I0z; I1z; I2z]]=inputs();
[a0 a1 d1x d2x m0 m1 m2 I0z I1z I2z I0y I1y I2y I0x I1x I2x]=inputs();
k=length(t);

kl=zeros(k,6);

 for t1=1:k
    
    r0c = St(t1,1:3); %CM position of the base
    th0 = St(t1,4:6); %Angular position of the base
    q=[r0c th0]';
    
    x0=St(t1,1);
    y0=St(t1,2);
    ph0=St(t1,4);
%     th=[0 St(t1,7:8)]';

    th1=St(t1,7);
    th2=St(t1,8);
    

    vb = St(t1,9:11); %CM linear velocity of the base
    phib = St(t1,12); %Angular velocity of the base
    
    wb=[0 0 phib];
    
    dq=[vb wb]';
    
    dth=[St(t1,15:16)]';
    
%     Hb=[
%   m0 + m1 + m2, 0, 0, 0, 0, - a1*m2*sin(conj(th1)) - d1x*m1*sin(conj(th1)) - d2x*m2*sin(conj(th1) + conj(th2));
% 
%   0, m0 + m1 + m2, 0, 0, 0, (a0*(m1 + m2))/2 + a1*m2*cos(conj(th1)) + d1x*m1*cos(conj(th1)) + d2x*m2*cos(conj(th1) + conj(th2)); 
% 
%   0, 0, m0 + m1 + m2, a1*m2*sin(conj(th1)) + d1x*m1*sin(conj(th1)) + d2x*m2*sin(conj(th1) + conj(th2)), - (a0*(m1 + m2))/2 - a1*m2*cos(conj(th1)) - d1x*m1*cos(conj(th1)) - d2x*m2*cos(conj(th1) + conj(th2)), 0;
% 
%   0, 0, a1*m2*sin(conj(th1)) + d1x*m1*sin(conj(th1)) + d2x*m2*sin(conj(th1) + conj(th2)), I0x + I1x/2 + I2x/2 + I1y/2 + I2y/2 + (I1x*cos(2*conj(th1)))/2 - (I1y*cos(2*conj(th1)))/2 + (a1^2*m2)/2 + (d1x^2*m1)/2 + (d2x^2*m2)/2 + (I2x*cos(2*conj(th1) + 2*conj(th2)))/2 - (I2y*cos(2*conj(th1) + 2*conj(th2)))/2 - (a1^2*m2*cos(2*conj(th1)))/2 - (d1x^2*m1*cos(2*conj(th1)))/2 - (d2x^2*m2*cos(2*conj(th1) + 2*conj(th2)))/2 - a1*d2x*m2*cos(2*conj(th1) + conj(th2)) + a1*d2x*m2*cos(conj(th2)), (I1x*sin(2*conj(th1)))/2 - (I1y*sin(2*conj(th1)))/2 + (I2x*sin(2*conj(th1) + 2*conj(th2)))/2 - (I2y*sin(2*conj(th1) + 2*conj(th2)))/2 - (a1^2*m2*sin(2*conj(th1)))/2 - (d1x^2*m1*sin(2*conj(th1)))/2 - (d2x^2*m2*sin(2*conj(th1) + 2*conj(th2)))/2 - (a0*d2x*m2*sin(conj(th1) + conj(th2)))/2 - a1*d2x*m2*sin(2*conj(th1) + conj(th2)) - (a0*a1*m2*sin(conj(th1)))/2 - (a0*d1x*m1*sin(conj(th1)))/2, 0;
% 
%   0, 0, - (a0*(m1 + m2))/2 - a1*m2*cos(conj(th1)) - d1x*m1*cos(conj(th1)) - d2x*m2*cos(conj(th1) + conj(th2)), (I1x*sin(2*conj(th1)))/2 - (I1y*sin(2*conj(th1)))/2 + (I2x*sin(2*conj(th1) + 2*conj(th2)))/2 - (I2y*sin(2*conj(th1) + 2*conj(th2)))/2 - (a1^2*m2*sin(2*conj(th1)))/2 - (d1x^2*m1*sin(2*conj(th1)))/2 - (d2x^2*m2*sin(2*conj(th1) + 2*conj(th2)))/2 - (a0*d2x*m2*sin(conj(th1) + conj(th2)))/2 - a1*d2x*m2*sin(2*conj(th1) + conj(th2)) - (a0*a1*m2*sin(conj(th1)))/2 - (a0*d1x*m1*sin(conj(th1)))/2, I1x/2 + I2x/2 + I0y + I1y/2 + I2y/2 - (I1x*cos(2*conj(th1)))/2 + (I1y*cos(2*conj(th1)))/2 + (a0^2*m1)/4 + (a0^2*m2)/4 + (a1^2*m2)/2 + (d1x^2*m1)/2 + (d2x^2*m2)/2 - (I2x*cos(2*conj(th1) + 2*conj(th2)))/2 + (I2y*cos(2*conj(th1) + 2*conj(th2)))/2 + (a1^2*m2*cos(2*conj(th1)))/2 + (d1x^2*m1*cos(2*conj(th1)))/2 + (d2x^2*m2*cos(2*conj(th1) + 2*conj(th2)))/2 + a0*d2x*m2*cos(conj(th1) + conj(th2)) + a1*d2x*m2*cos(2*conj(th1) + conj(th2)) + a0*a1*m2*cos(conj(th1)) + a0*d1x*m1*cos(conj(th1)) + a1*d2x*m2*cos(conj(th2)), 0;
% 
%   - a1*m2*sin(conj(th1)) - d1x*m1*sin(conj(th1)) - d2x*m2*sin(conj(th1) + conj(th2)), (a0*(m1 + m2))/2 + a1*m2*cos(conj(th1)) + d1x*m1*cos(conj(th1)) + d2x*m2*cos(conj(th1) + conj(th2)), 0, 0, 0, I0z + I1z + I2z + (a0^2*m1)/4 + (a0^2*m2)/4 + a1^2*m2 + d1x^2*m1 + d2x^2*m2 + a0*d2x*m2*cos(conj(th1) + conj(th2)) + a0*a1*m2*cos(conj(th1)) + a0*d1x*m1*cos(conj(th1)) + 2*a1*d2x*m2*cos(conj(th2))];
  

Hb=[
    
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               (m0 + m1 + m2)*cos(ph0)^2 + (m0 + m1 + m2)*sin(ph0)^2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       sin(ph0)*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + d1x*m1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) + (a0*cos(ph0)*(m1 + m2))/2) - cos(ph0)*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d1x*m1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))) + (a0*sin(ph0)*(m1 + m2))/2);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               (m0 + m1 + m2)*cos(ph0)^2 + (m0 + m1 + m2)*sin(ph0)^2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       cos(ph0)*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + d1x*m1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) + (a0*cos(ph0)*(m1 + m2))/2) + sin(ph0)*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d1x*m1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))) + (a0*sin(ph0)*(m1 + m2))/2);
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          m0 + m1 + m2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           cos(ph0)*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d1x*m1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))) + (a0*sin(ph0)*(m1 + m2))/2) - sin(ph0)*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + d1x*m1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) + (a0*cos(ph0)*(m1 + m2))/2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       - cos(ph0)*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + d1x*m1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) + (a0*cos(ph0)*(m1 + m2))/2) - sin(ph0)*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d1x*m1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))) + (a0*sin(ph0)*(m1 + m2))/2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,   cos(ph0)*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d1x*m1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))) + (a0*sin(ph0)*(m1 + m2))/2) - sin(ph0)*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + d1x*m1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) + (a0*cos(ph0)*(m1 + m2))/2), - sin(ph0)*(cos(ph0)*((m1*d1x^2 + I1y)*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - (m2*d2x^2 + I2y)*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) - I0x*cos(ph0)*sin(ph0) + I0y*cos(ph0)*sin(ph0) - I1x*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + I2x*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) + (a0*cos(ph0)*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d1x*m1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))) + (a0*sin(ph0)*(m1 + m2))/2))/2 + a1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))) + (a0*sin(ph0)*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + d1x*m1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))))/2 - a1*d2x*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))) - sin(ph0)*((m1*d1x^2 + I1y)*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))^2 + (m2*d2x^2 + I2y)*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))^2 + I1x*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))^2 + I2x*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))^2 + I0y*cos(ph0)^2 + I0x*sin(ph0)^2 + (a0*cos(ph0)*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + d1x*m1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) + (a0*cos(ph0)*(m1 + m2))/2))/2 + a1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))) + (a0*cos(ph0)*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + d1x*m1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))))/2 - a1*d2x*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))))) - cos(ph0)*(sin(ph0)*((m1*d1x^2 + I1y)*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - (m2*d2x^2 + I2y)*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) - I0x*cos(ph0)*sin(ph0) + I0y*cos(ph0)*sin(ph0) - I1x*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + I2x*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) + (a0*sin(ph0)*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + d1x*m1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) + (a0*cos(ph0)*(m1 + m2))/2))/2 + a1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))) + (a0*cos(ph0)*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d1x*m1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))))/2 + a1*d2x*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))) - cos(ph0)*((m1*d1x^2 + I1y)*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))^2 + (m2*d2x^2 + I2y)*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))^2 + I1x*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))^2 + I2x*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))^2 + I0x*cos(ph0)^2 + I0y*sin(ph0)^2 + (a0*sin(ph0)*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d1x*m1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))) + (a0*sin(ph0)*(m1 + m2))/2))/2 + a1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))) + (a0*sin(ph0)*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d1x*m1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))))/2 + a1*d2x*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))))), sin(ph0)*(sin(ph0)*((m1*d1x^2 + I1y)*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - (m2*d2x^2 + I2y)*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) - I0x*cos(ph0)*sin(ph0) + I0y*cos(ph0)*sin(ph0) - I1x*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + I2x*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) + (a0*sin(ph0)*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + d1x*m1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) + (a0*cos(ph0)*(m1 + m2))/2))/2 + a1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))) + (a0*cos(ph0)*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d1x*m1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))))/2 + a1*d2x*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))) - cos(ph0)*((m1*d1x^2 + I1y)*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))^2 + (m2*d2x^2 + I2y)*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))^2 + I1x*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))^2 + I2x*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))^2 + I0x*cos(ph0)^2 + I0y*sin(ph0)^2 + (a0*sin(ph0)*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d1x*m1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))) + (a0*sin(ph0)*(m1 + m2))/2))/2 + a1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))) + (a0*sin(ph0)*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d1x*m1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))))/2 + a1*d2x*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))))) - cos(ph0)*(cos(ph0)*((m1*d1x^2 + I1y)*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - (m2*d2x^2 + I2y)*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) - I0x*cos(ph0)*sin(ph0) + I0y*cos(ph0)*sin(ph0) - I1x*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + I2x*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) + (a0*cos(ph0)*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d1x*m1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))) + (a0*sin(ph0)*(m1 + m2))/2))/2 + a1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))) + (a0*sin(ph0)*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + d1x*m1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))))/2 - a1*d2x*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))) - sin(ph0)*((m1*d1x^2 + I1y)*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))^2 + (m2*d2x^2 + I2y)*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))^2 + I1x*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))^2 + I2x*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))^2 + I0y*cos(ph0)^2 + I0x*sin(ph0)^2 + (a0*cos(ph0)*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + d1x*m1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) + (a0*cos(ph0)*(m1 + m2))/2))/2 + a1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))) + (a0*cos(ph0)*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + d1x*m1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))))/2 - a1*d2x*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0, - cos(ph0)*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + d1x*m1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) + (a0*cos(ph0)*(m1 + m2))/2) - sin(ph0)*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d1x*m1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))) + (a0*sin(ph0)*(m1 + m2))/2),   sin(ph0)*(cos(ph0)*((m1*d1x^2 + I1y)*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))^2 + (m2*d2x^2 + I2y)*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))^2 + I1x*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))^2 + I2x*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))^2 + I0y*cos(ph0)^2 + I0x*sin(ph0)^2 + (a0*cos(ph0)*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + d1x*m1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) + (a0*cos(ph0)*(m1 + m2))/2))/2 + a1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))) + (a0*cos(ph0)*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + d1x*m1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))))/2 - a1*d2x*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))) + sin(ph0)*((m1*d1x^2 + I1y)*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - (m2*d2x^2 + I2y)*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) - I0x*cos(ph0)*sin(ph0) + I0y*cos(ph0)*sin(ph0) - I1x*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + I2x*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) + (a0*cos(ph0)*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d1x*m1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))) + (a0*sin(ph0)*(m1 + m2))/2))/2 + a1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))) + (a0*sin(ph0)*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + d1x*m1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))))/2 - a1*d2x*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))))) - cos(ph0)*(cos(ph0)*((m1*d1x^2 + I1y)*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - (m2*d2x^2 + I2y)*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) - I0x*cos(ph0)*sin(ph0) + I0y*cos(ph0)*sin(ph0) - I1x*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + I2x*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) + (a0*sin(ph0)*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + d1x*m1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) + (a0*cos(ph0)*(m1 + m2))/2))/2 + a1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))) + (a0*cos(ph0)*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d1x*m1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))))/2 + a1*d2x*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))) + sin(ph0)*((m1*d1x^2 + I1y)*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))^2 + (m2*d2x^2 + I2y)*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))^2 + I1x*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))^2 + I2x*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))^2 + I0x*cos(ph0)^2 + I0y*sin(ph0)^2 + (a0*sin(ph0)*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d1x*m1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))) + (a0*sin(ph0)*(m1 + m2))/2))/2 + a1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))) + (a0*sin(ph0)*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d1x*m1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))))/2 + a1*d2x*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))))), cos(ph0)*(cos(ph0)*((m1*d1x^2 + I1y)*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))^2 + (m2*d2x^2 + I2y)*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))^2 + I1x*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))^2 + I2x*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))^2 + I0y*cos(ph0)^2 + I0x*sin(ph0)^2 + (a0*cos(ph0)*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + d1x*m1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) + (a0*cos(ph0)*(m1 + m2))/2))/2 + a1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))) + (a0*cos(ph0)*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + d1x*m1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))))/2 - a1*d2x*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))) + sin(ph0)*((m1*d1x^2 + I1y)*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - (m2*d2x^2 + I2y)*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) - I0x*cos(ph0)*sin(ph0) + I0y*cos(ph0)*sin(ph0) - I1x*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + I2x*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) + (a0*cos(ph0)*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d1x*m1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))) + (a0*sin(ph0)*(m1 + m2))/2))/2 + a1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))) + (a0*sin(ph0)*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + d1x*m1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))))/2 - a1*d2x*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))))) + sin(ph0)*(cos(ph0)*((m1*d1x^2 + I1y)*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - (m2*d2x^2 + I2y)*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) - I0x*cos(ph0)*sin(ph0) + I0y*cos(ph0)*sin(ph0) - I1x*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + I2x*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) + (a0*sin(ph0)*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + d1x*m1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) + (a0*cos(ph0)*(m1 + m2))/2))/2 + a1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))) + (a0*cos(ph0)*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d1x*m1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))))/2 + a1*d2x*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))) + sin(ph0)*((m1*d1x^2 + I1y)*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))^2 + (m2*d2x^2 + I2y)*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))^2 + I1x*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))^2 + I2x*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))^2 + I0x*cos(ph0)^2 + I0y*sin(ph0)^2 + (a0*sin(ph0)*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d1x*m1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))) + (a0*sin(ph0)*(m1 + m2))/2))/2 + a1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))) + (a0*sin(ph0)*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d1x*m1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))))/2 + a1*d2x*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))))),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         0;
 sin(ph0)*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + d1x*m1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) + (a0*cos(ph0)*(m1 + m2))/2) - cos(ph0)*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d1x*m1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))) + (a0*sin(ph0)*(m1 + m2))/2), cos(ph0)*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + d1x*m1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) + (a0*cos(ph0)*(m1 + m2))/2) + sin(ph0)*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d1x*m1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))) + (a0*sin(ph0)*(m1 + m2))/2),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           0, I0z + I1z + I2z + d1x^2*m1 + d2x^2*m2 + (a0*cos(ph0)*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + d1x*m1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) + (a0*cos(ph0)*(m1 + m2))/2))/2 + (a0*sin(ph0)*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d1x*m1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))) + (a0*sin(ph0)*(m1 + m2))/2))/2 + a1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))) + a1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))) + (a0*cos(ph0)*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + d1x*m1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))))/2 + (a0*sin(ph0)*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d1x*m1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))))/2 + a1*d2x*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))) - a1*d2x*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))];
    

Hbm=[
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      sin(ph0)*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + d1x*m1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))) - cos(ph0)*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d1x*m1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))),                                                                                                                                                                                                                                                                                                                                                                                                                                                  - d2x*m2*cos(ph0)*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))) - d2x*m2*sin(ph0)*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     cos(ph0)*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + d1x*m1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))) + sin(ph0)*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d1x*m1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))),                                                                                                                                                                                                                                                                                                                                                                                                                                                    d2x*m2*sin(ph0)*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))) - d2x*m2*cos(ph0)*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)));
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               0,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        0;
 I1z + I2z + d1x^2*m1 + d2x^2*m2 + a1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))) + a1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))) + (a0*cos(ph0)*(a1*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + d1x*m1*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) - d2x*m2*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)))))/2 + (a0*sin(ph0)*(a1*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d1x*m1*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) + d2x*m2*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)))))/2 + a1*d2x*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))) - a1*d2x*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))), I2z + d2x^2*m2 + a1*d2x*m2*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))) - a1*d2x*m2*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))) - (a0*d2x*m2*cos(ph0)*(sin(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0)) - cos(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0))))/2 + (a0*d2x*m2*sin(ph0)*(sin(conj(th2))*(cos(conj(th1))*cos(ph0) - sin(conj(th1))*sin(ph0)) + cos(conj(th2))*(cos(conj(th1))*sin(ph0) + sin(conj(th1))*cos(ph0))))/2];
   





%    Hbm=[
%        
%    - a1*m2*sin(conj(th1)) - d1x*m1*sin(conj(th1)) - d2x*m2*sin(conj(th1) + conj(th2)), -d2x*m2*sin(conj(th1) + conj(th2));
% 
%      a1*m2*cos(conj(th1)) + d1x*m1*cos(conj(th1)) + d2x*m2*cos(conj(th1) + conj(th2)), d2x*m2*cos(conj(th1) + conj(th2));
% 
%      0, 0;
% 
%      0, 0;
% 
%      0, 0;
% 
%      I1z + I2z + a1^2*m2 + d1x^2*m1 + d2x^2*m2 + (a0*d2x*m2*cos(conj(th1) + conj(th2)))/2 + (a0*a1*m2*cos(conj(th1)))/2 + (a0*d1x*m1*cos(conj(th1)))/2 + 2*a1*d2x*m2*cos(conj(th2)), I2z + d2x^2*m2 + (a0*d2x*m2*cos(conj(th1) + conj(th2)))/2 + a1*d2x*m2*cos(conj(th2))];
%   
 
  JJ=Hb*dq+Hbm*dth;
  kl(t1,:)=JJ;
  
 end
 
kl;

kl(:,1);

plot(t,kl(:,6));

end
